import{y as k,r as C,j as n,e as p,f as y,w as e,x as D,o as S,J as T,K as B}from"./index-DybU9lv3.js";import{S as b}from"./SheCard-JWlyTss7.js";import{S as w}from"./SheDatePicker-ByjOO6gI.js";import{S as I}from"./SheTextarea-B6lhLebe.js";import{u as L,I as g}from"./useAppTranslation-NlALFuCP.js";import{m as K}from"./SheContextSidebar-BKksk-en.js";import{P as _}from"./plus-Dv0aUE5j.js";import{C as R}from"./trash-CFfYG3xN.js";const E="_supplierCard_noepp_1",M="_supplierCardContent_noepp_1",F="_purchaseBlock_noepp_7",W="_noSelectedSupplier_noepp_12",$="_noSelectedSupplierText_noepp_16",z="_selectedSupplier_noepp_19",U="_selectedSupplierDetails_noepp_24",G="_supplierPhoto_noepp_30",J="_supplierDesc_noepp_42",q="_supplierNameTooltip_noepp_48",H="_supplierName_noepp_48",O="_deletedSupplier_noepp_57",Q="_twoLineEllipsis_noepp_60",V="_deletedSupplierBlock_noepp_69",X="_deletedSupplierText_noepp_75",Y="_purchaseButtonBlock_noepp_78",t={supplierCard:E,supplierCardContent:M,purchaseBlock:F,noSelectedSupplier:W,noSelectedSupplierText:$,selectedSupplier:z,selectedSupplierDetails:U,supplierPhoto:G,supplierDesc:J,supplierNameTooltip:q,supplierName:H,deletedSupplier:O,twoLineEllipsis:Q,deletedSupplierBlock:V,deletedSupplierText:X,purchaseButtonBlock:Y};function ra({isLoading:r,selectedPurchase:a,selectedSupplier:o,showCloseButton:l,onAction:i}){var u,j,N;const{purchaseId:s}=k(),[m,h]=C.useState(s?a==null?void 0:a.date:null),[c,v]=C.useState(null),{translate:x}=L(),f=!!!(m||a!=null&&a.date)||!o;return C.useEffect(()=>{a!=null&&a.date&&h(a.date)},[a]),n.jsx(b,{className:t.supplierCard,title:a!=null&&a.purchaseId?"Manage Purchase":"Create Purchase",showCloseButton:l,isLoading:r,showNotificationCard:!!s,notificationCardProps:{title:"Delete Purchase",titleTransKey:"CardTitles.DeletePurchase",text:"The purchase will be deleted, but the changes in stock will remain intact.",textTransKey:"ConfirmationMessages.DeletePurchase",onClick:()=>i("deletePurchase",a)},onSecondaryButtonClick:()=>i("closeSupplierCard"),children:n.jsx("div",{className:t.supplierCardContent,children:n.jsxs("div",{className:t.purchaseBlock,children:[n.jsxs("div",{className:t.noSelectedSupplier,children:[n.jsx("span",{className:`${t.noSelectedSupplierText} she-text`,children:x("PurchaseForm.Labels.SupplierSelection")}),n.jsx(p,{icon:o?K:_,value:o?"Replace Supplier":"Select Supplier",valueTransKey:o?"SupplierActions.ReplaceSupplier":"SupplierActions.SelectSupplier",variant:"secondary",maxWidth:"160px",minWidth:"160px",onClick:()=>{i(o?"detachSupplier":"openSelectEntityCard")}})]}),o&&n.jsxs("div",{className:t.selectedSupplier,children:[n.jsxs("div",{className:t.selectedSupplierDetails,children:[n.jsx("div",{className:t.supplierPhoto,children:o.thumbnailUrl?n.jsx("img",{src:o==null?void 0:o.thumbnailUrl,alt:o==null?void 0:o.companyName}):n.jsx(y,{icon:g})}),n.jsxs("div",{className:t.supplierDesc,children:[n.jsx(e,{delayDuration:200,text:o==null?void 0:o.companyName,className:t.supplierNameTooltip,children:n.jsx("span",{className:`${o.isDeleted?t.deletedSupplier:""} ${t.supplierName} she-text`,children:o==null?void 0:o.companyName})}),((o==null?void 0:o.address)||((u=a==null?void 0:a.location)==null?void 0:u.address))&&n.jsx(e,{delayDuration:200,text:(o==null?void 0:o.address)||((j=a==null?void 0:a.location)==null?void 0:j.address),className:"max-w-[150px]",children:n.jsx("span",{className:`
                        ${o.isDeleted?t.deletedSupplier:""}
                        ${t.twoLineEllipsis} she-text`,children:(o==null?void 0:o.address)||((N=a==null?void 0:a.location)==null?void 0:N.address)})})]}),n.jsx(p,{icon:o.isDeleted?_:D,value:o.isDeleted?"Restore":"Manage",valueTransKey:o.isDeleted?"CommonButtons.Restore":"CommonButtons.Manage",variant:"secondary",onClick:()=>{o.isDeleted?i("restoreCompany",o):i("manageCompany",o)}})]}),o.isDeleted&&n.jsx("div",{className:t.deletedSupplierBlock,children:n.jsx("span",{className:`${t.deletedSupplierText} she-text`,children:x("MarginMessages.SupplierIsDeleted")})})]}),n.jsx(S,{}),n.jsx("span",{className:"she-title",children:x("PurchaseForm.Labels.PurchaseDateTitle")}),n.jsx(w,{date:a==null?void 0:a.date,label:"Purchase Date",labelTransKey:"PurchaseForm.Labels.PurchaseDate",icon:R,fullWidth:!0,onSelectDate:d=>h(d)}),n.jsx(I,{value:(a==null?void 0:a.documentNotes)||null,label:"Purchase notes",labelTransKey:"PurchaseForm.Labels.PurchaseNotes",placeholder:"Type your notes here...",placeholderTransKey:"PurchaseForm.Placeholders.PurchaseNotes",fullWidth:!0,onDelay:d=>v(d)}),n.jsxs("div",{className:t.purchaseButtonBlock,children:[n.jsx(p,{value:"Cancel",valueTransKey:"CommonButtons.Cancel",variant:"secondary",minWidth:"100px",onClick:()=>i("closeSupplierCard")}),n.jsx(p,{value:a!=null&&a.purchaseId?"Save":"Create Purchase",valueTransKey:a!=null&&a.purchaseId?"CommonButtons.Save":"CommonButtons.CreatePurchase",icon:!(a!=null&&a.purchaseId)&&_,txtColor:!(a!=null&&a.purchaseId)&&"#fff",bgColor:!(a!=null&&a.purchaseId)&&"#007AFF",disabled:f,minWidth:"100px",onClick:()=>s?i("updatePurchase",{purchaseId:s,selectedDate:m,selectedSupplier:o,purchaseNotes:c}):i("createPurchase",{selectedDate:m,selectedSupplier:o,purchaseNotes:c})})]})]})})})}const Z="_iconCheck_1wa1s_1",A={iconCheck:Z};function ea({onAction:r}){return[{id:"select",header:"Select",minSize:58,maxSize:58,cell:({row:a,table:o})=>{const l=o.options.meta,i=s=>{s.stopPropagation(),s.preventDefault(),r("selectCompany",a.original)};return n.jsx("div",{onClick:s=>s.stopPropagation(),children:n.jsx(p,{className:a.original.isSelected===!0?A.iconCheck:"",icon:a.original.isSelected===!0?T:B,variant:"ghost",onClick:i,disabled:l==null?void 0:l.isRowLoading(a.id)})})}},{id:"companyName",header:"Company",cell:({row:a})=>{const o=a.original.thumbnailUrl,l=a.original.companyName,i=a.original.address;return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",width:"100%"},children:[n.jsx("div",{style:{width:"100%",maxWidth:"40px"},children:o?n.jsx("img",{src:o,alt:l||"Supplier",className:"object-cover rounded-md w-full h-full",style:{width:"100%"}}):n.jsx(y,{icon:g})}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx(e,{delayDuration:200,text:l,className:"max-w-[120px] overflow-hidden text-ellipsis whitespace-nowrap",children:n.jsx("span",{className:"she-text",children:l})}),i&&n.jsx(e,{delayDuration:200,text:i,className:"max-w-[120px] overflow-hidden text-ellipsis whitespace-nowrap",children:n.jsx("span",{className:"she-subtext",children:i})})]})]})}},{id:"manage",header:"Actions",minSize:120,maxSize:120,cell:({row:a,table:o})=>{const l=o.options.meta,i=s=>{s.stopPropagation(),s.preventDefault(),r("manageCompany",a.original)};return n.jsx("div",{onClick:s=>s.stopPropagation(),children:n.jsx(p,{icon:D,value:"Manage",variant:"secondary",onClick:i,disabled:l==null?void 0:l.isRowLoading(a.id)})})}}]}export{ea as C,ra as S};
