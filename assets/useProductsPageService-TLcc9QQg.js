import{b as pr,a as G,S as M,c as gr,G as yr,H as Tr,P as o,V as h,bw as y,U as D,q as P,A as v,W as Hr,Z as a,$ as I,a0 as T,N as s,l as Cr,a4 as Vr,a3 as Lr,bx as R}from"./index-CqLEDb0h.js";import{u as Or}from"./useToast-BWT7QgMZ.js";function Sr(){const w=pr(),H=G(M.APP),u=G(M.PRODUCTS),n=gr(),l=yr(),{addToast:d}=Or(),{openConfirmationDialog:p}=Tr(),[z]=o.useGetTheProductsForGridMutation(),[U]=o.useGetVariantsForGridMutation(),[k]=h.useGetListOfPurchasesForGridMutation(),[N]=o.useLazyGetBrandsForProductsFilterQuery(),[Q]=o.useLazyGetCategoriesForProductsFilterQuery(),[B]=y.useLazyGetListOfSuppliersQuery(),[b]=o.useLazyGetCountersForProductsQuery(),[$]=o.useLazyGetProductDetailQuery(),[x]=o.useDeleteProductMutation(),[E]=o.useToggleProductActivationMutation(),[q]=D.useUpdateUserPreferencesMutation(),[_]=D.useResetUserPreferencesMutation(),[W]=o.useLazyGetProductPhotosQuery(),[K]=o.useLazyGetProductVariantsQuery(),[Y]=P.useLazyGetTaxesListQuery(),[Z]=P.useLazyGetCurrenciesListQuery(),[j]=o.useLazyGetVariantDetailsQuery(),[J]=h.useLazyGetPurchaseDetailsQuery(),[X]=P.useLazyGetCountryCodeQuery(),[tt]=v.useUploadPhotoMutation(),[et]=h.useLazyGetPurchaseCountersQuery(),[rt]=o.useLazyGetTraitsForFilterQuery(),[nt]=o.useLazyGenerateProductCodeQuery(),[at]=o.useLazyGetSimpleListOfAllBrandsQuery(),[ot]=o.useLazyGetAllCategoriesByOrganizationQuery(),[it]=o.useCheckProductCodeMutation(),[ut]=o.useCheckBrandNameMutation(),[st]=o.useCheckCategoryNameMutation(),[ct]=o.useCreateNewProductMutation(),[dt]=o.useUpdateProductMutation(),[lt]=o.useCreateNewCategoryMutation(),[ht]=o.useCreateBrandMutation(),[ft]=o.usePutPhotoInNewPositionMutation(),[Pt]=v.useDeletePhotoMutation(),[pt]=o.useLazyGetListOfAllTraitsQuery(),[gt]=o.useAttachProductPhotoToVariantMutation(),[yt]=o.useDetachVariantPhotoMutation(),[Tt]=o.useLazyGetTraitQuery(),[Ht]=P.useLazyGetListOfTypesOfTraitsQuery();o.useLazyGetProductVariantsQuery();const[Ct]=o.useLazyGetListOfTraitsWithOptionsForProductQuery(),[Vt]=o.useSetProductTraitsMutation(),[Lt]=o.useDeleteTraitMutation(),[Ar]=o.useLazyGetListOfTraitsForProductQuery(),[Ot]=o.useCreateNewTraitMutation(),[At]=o.useLazyGetOptionsForTraitQuery(),[mt]=o.useCreateNewOptionForTraitMutation(),[Ft]=o.useUpdateOptionOfTraitMutation(),[St]=o.useDeleteOptionOfTraitMutation(),[Gt]=o.useUpdateTraitMutation(),[Mt]=o.useChangePositionOfTraitOptionMutation(),[Dt]=o.useCreateVariantMutation(),[vt]=o.useCheckVariantCombinationMutation(),[It]=h.useLazyGetPurchaseProductVariantsQuery(),[Rt]=o.useLazyGetVariantStockHistoryQuery(),[wt]=o.useLazyGetProductPhotosForVariantQuery(),[zt]=o.useUpdateVariantDetailsMutation(),[Ut]=o.useUpdateVariantTraitOptionsMutation(),[kt]=o.useIncreaseStockAmountForVariantMutation(),[Nt]=o.useDisposeVariantFromStockMutation(),[Qt]=o.useChangePhotoPositionForVariantMutation(),[Bt]=o.useDeleteVariantMutation(),[bt]=y.useDeleteSupplierMutation(),[$t]=y.useRestoreSupplierMutation(),[xt]=h.useDeletePurchaseMutation(),[Et]=o.useToggleVariantIsActiveMutation(),[qt]=Hr.useLazyGetCompaniesListQuery();function C(t,e){return u.products!==null&&!e?null:(n(a.setIsLoading(!0)),z(t).then(r=>{if(n(a.setIsLoading(!1)),!r.error)return n(a.refreshProductsGridRequestModel(r.data)),n(a.refreshProducts(r.data.items)),r.data}))}function V(t){return n(a.setIsLoading(!0)),k(t).then(e=>{if(n(a.setIsLoading(!1)),!e.error)return n(a.refreshPurchasesGridRequestModel(e.data)),n(a.refreshPurchases(e.data.items)),e.data})}function _t(){return N(null).then(t=>(n(a.refreshBrands(t.data)),t.data))}function L(t){return n(a.setIsLoading(!0)),U(t).then(e=>{if(n(a.setIsLoading(!1)),!e.error)return n(a.refreshVariantsGridRequestModel(e.data)),n(a.refreshVariants(e.data.items)),e.data})}function Wt(){return Q(null).then(t=>(n(a.refreshCategories(t.data)),t.data))}function Kt(){return B(null).then(t=>(n(a.refreshSuppliers(t.data)),t.data))}function Yt(t){return b(t).then(e=>(n(a.refreshProductCounter(e.data)),e.data))}function Zt(t){return $(t).then(e=>(n(a.refreshProduct(e.data)),e.data))}function jt(t){return x(t).then(e=>e)}function Jt(t){return E(t).then(e=>e)}function O(t){return n(a.setIsLoading(!0)),q(t).then(()=>{n(a.setIsLoading(!1))})}function A(t){return n(a.setIsLoading(!0)),_(t).then(()=>{w.getUserPreferencesHandler(),n(a.setIsLoading(!1))})}function Xt(t){return n(a.setIsProductPhotosLoading(!0)),W(t).then(e=>(n(a.setIsProductPhotosLoading(!1)),n(a.refreshProductPhotos(e.data)),e.data))}function te(t){return n(a.setIsProductVariantsLoading(!0)),K(t).then(e=>(n(a.setIsProductVariantsLoading(!1)),{...e,data:I(e.data,"color",[{field:"showAlert",value:!0,color:T.ERROR}])}.data))}function ee(){return Y(void 0).then(t=>(n(a.refreshTaxesList(t.data)),t.data))}function re(){return Z(void 0).then(t=>(n(a.refreshCurrenciesList(t.data)),t.data))}function m(t){return j(t).then(e=>({...e.data,traitOptions:I(e.data.traitOptions,"color",[{field:"isRemoved",value:!0,color:T.ERROR},{field:"isMissing",value:!0,color:T.ERROR}])}))}function ne(t){return J(t).then(e=>(n(a.refreshSelectedPurchase(e.data)),e.data))}function ae(){return X(null).then(t=>(t.data&&n(a.refreshCountryCodeList(t.data)),t))}function oe(t){return tt(t).then(e=>e)}function ie(t){return et(t).then(e=>(n(a.refreshPurchaseCounters(e.data)),e.data))}function ue(){return rt(void 0).then(t=>(n(a.refreshSizesForFilter(t.data.filter(e=>e.traitTypeId===1).flatMap(e=>e.traitOptions))),n(a.refreshColorsForFilter(t.data.filter(e=>e.traitTypeId===2).flatMap(e=>e.traitOptions))),t.data))}function se(){return nt(null).then(t=>t.data)}function ce(){return at(null).then(t=>(n(a.refreshBrands(t.data)),t.data))}function de(){return ot(null).then(t=>(n(a.refreshCategories(t.data)),t.data))}function le(t){return it(t).then(e=>e.data)}function he(t){return ut(t).then(e=>e)}function fe(t){return st(t).then(e=>e)}function Pe(t){return ct(t).then(e=>e)}function pe(t,e){return dt({productId:t,model:e}).then(r=>r)}function ge(t){return lt(t).then(e=>e)}function ye(t){return ht(t).then(e=>e)}function Te(t,e,r){return ft({productId:t,photoId:e,index:r}).then(i=>i.data)}function He(t){return Pt(t).then(e=>e.data)}function Ce(){return pt(void 0).then(t=>(n(a.refreshTraits(t.data)),t.data))}function Ve(t,e){return gt({variantId:t,photoId:e}).then(r=>r)}function Le(t,e){return yt({id:t,photoId:e}).then(r=>r)}function Oe(t){return Tt(t).then(e=>e.data)}function Ae(){return Ht(void 0).then(t=>(n(a.refreshTypesOfTraits(t.data)),t.data))}function me(t){return Ct(t).then(e=>(n(a.refreshListOfTraitsWithOptionsForProduct(e.data)),e.data))}function Fe(t,e){return Vt({id:t,model:e}).then(r=>r)}function Se(t){return Lt(t).then(e=>e)}function Ge(t){return Ot(t).then(e=>e.data)}function Me(t,e){return Gt({id:t,model:e}).then(r=>r.data)}function De(t){return At(t).then(e=>e.data)}function ve(t,e){return mt({id:t,model:e}).then(r=>r.data)}function Ie(t,e){return Ft({id:t,model:e}).then(r=>r.data)}function Re(t){return St(t).then(e=>e)}function we(t,e,r){return Mt({traitId:t,optionId:e,index:r}).then(i=>i)}function ze(t,e){return Dt({id:t,model:e}).then(r=>r.data)}function Ue(t,e){return vt({id:t,model:e}).then(r=>r.data)}function ke(t,e){return It({purchaseId:t,productId:e}).then(r=>r.data)}function Ne(t){return Rt(t).then(e=>e.data)}function Qe(t,e){return wt({productId:t,variantId:e}).then(r=>r.data)}function Be(t,e){return zt({id:t,model:e}).then(r=>r.data)}function be(t,e){return Ut({id:t,model:e}).then(r=>r)}function $e(t,e){return kt({id:t,model:e}).then(r=>r.data)}function xe(t,e){return Nt({id:t,model:e}).then(r=>r.data)}function Ee(t,e,r){return Qt({id:t,photoId:e,index:r}).then(i=>i.data)}function F(t){return Bt(t).then(e=>e)}function qe(t){return bt(t).then(e=>e)}function _e(t){return $t(t).then(e=>e)}function S(t){return xt(t).then(e=>e)}function We(t){Jt(t.productId).then(e=>{e.error?d({text:e.error.data.detail,type:"error"}):(n(a.refreshProductsGridRequestModel({...u.productsGridRequestModel,items:u.productsGridRequestModel.items.map(r=>r.productId===t.productId?{...r,isActive:!t.isActive}:r)})),d({text:"Product successfully activated",type:"success"}))})}async function Ke(t){var r;await p({headerTitle:"Delete Product",text:`You are about to delete product "${t.row.original.productName}".`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&((r=t.table.options.meta)==null||r.hideRow(t.row.original.id),await jt(t.row.original.productId).then(i=>{var c;i.error?((c=t.table.options.meta)==null||c.unhideRow(t.row.original.id),d({text:i.error.data.detail,type:"error"})):d({text:"Product deleted successfully",type:"success"})}))}async function Ye(t){var r;await p({headerTitle:"Delete Variant",text:`You are about to delete variant "${t.row.original.variantName}".`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&((r=t.table.options.meta)==null||r.hideRow(t.row.original.id),await F(t.row.original.variantId).then(i=>{var c;i.error?((c=t.table.options.meta)==null||c.unhideRow(t.row.original.id),d({text:i.error.data.detail,type:"error"})):d({text:"Variant deleted successfully",type:"success"})}))}async function Ze(t){var r;await p({headerTitle:"Delete Purchase",text:`You are about to delete purchase "${t.row.original.purchaseId}".`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&((r=t.table.options.meta)==null||r.hideRow(t.row.original.id),await S(t.row.original.purchaseId).then(i=>{var c;i.error?((c=t.table.options.meta)==null||c.unhideRow(t.row.original.id),d({text:i.error.data.detail,type:"error"})):d({text:"Purchase deleted successfully",type:"success"})}))}function je(t){n(a.resetProduct()),l(`${s.PRODUCTS}${s.PRODUCT_BASIC_DATA}/${t}`)}function Je(t,e){n(a.refreshSelectedVariant({variantId:t})),l(`${s.PRODUCTS}${s.MANAGE_VARIANTS}/${e}`)}function Xe(t){l(`${s.PRODUCTS}${s.SUPPLIER}/${t}`)}function tr(){l(`${s.PRODUCTS}${s.PRODUCT_BASIC_DATA}`)}function er(){n(a.resetSelectedPurchase()),n(a.resetSelectedSupplier()),l(`${s.PRODUCTS}${s.SUPPLIER}/`)}function rr(t){u.activeTab==="products"?C(t,!0):u.activeTab==="variants"?L(t):u.activeTab==="purchases"&&V(t)}function nr(t){const e=Cr.merge({},H.preferences,t);n(Vr.refreshPreferences(e)),O(e)}function ar(){A(u.activeTab)}function or(t){t!==u.activeTab&&n(a.refreshActiveTab(t))}function ir(t){Et(t.variantId).then(e=>{e.error?d({text:"Variant not activated",description:e.error.message,type:"error"}):(n(a.refreshVariantsGridRequestModel({...u.variantsGridRequestModel,items:u.variantsGridRequestModel.items.map(r=>r.variantId===t.variantId?{...r,isActive:!t.isActive}:r)})),d({text:"Variant activated successfully",type:"success"}))})}function ur(){u.companies||qt().then(t=>{n(a.refreshCompanies(t.data))})}function sr(t,e){const{idKey:r,nameKey:i,imageKeyPath:c,type:dr}=e;return t==null?void 0:t.map(f=>{const lr=f[r],hr=f[i],fr=c?c.split(".").reduce((g,Pr)=>g==null?void 0:g[Pr],f):void 0;return{id:lr,name:hr,imageUrl:fr,originalItem:f,type:dr}})}function cr({item:t,type:e}){switch(e){case"product":n(a.resetProductCounter()),n(a.refreshProductPhotos([])),n(a.resetProduct()),n(a.refreshProductVariants([])),n(a.resetSelectedVariant()),l(`${R.PRODUCTS}${R.PRODUCT_BASIC_DATA}/${t.productId}`);break;case"variant":m(t.variantId).then(r=>{n(a.refreshSelectedVariant(r)),n(a.refreshVariantPhotos(r.photos)),l(`${s.PRODUCTS}${s.MANAGE_VARIANTS}/${t==null?void 0:t.productId}`),n(a.refreshProductVariants(Lr(t.variantId,u.productVariants,"variantId")))});break}}return{state:u,appState:H,dispatch:n,getTheProductsForGridHandler:C,getVariantsForGridHandler:L,getListOfPurchasesForGridHandler:V,getBrandsForFilterHandler:_t,getCategoriesForFilterHandler:Wt,getListOfSuppliersHandler:Kt,getCountersForProductsHandler:Yt,getProductDetailsHandler:Zt,updateUserPreferencesHandler:O,resetUserPreferencesHandler:A,getProductPhotosHandler:Xt,getProductVariantsHandler:te,getTaxesListHandler:ee,getCurrenciesListHandler:re,getVariantDetailsHandler:m,getPurchaseDetailsHandler:ne,getCountryCodeHandler:ae,uploadPhotoHandler:oe,getPurchaseCountersHandler:ie,getTraitsForFilterHandler:ue,itemsCardItemsConvertor:sr,itemCardHandler:cr,generateProductCodeHandler:se,getSimpleListOfAllBrandsHandler:ce,getAllCategoriesByOrganizationHandler:de,checkProductCodeHandler:le,checkBrandNameHandler:he,checkCategoryNameHandler:fe,createNewProductHandler:Pe,updateProductHandler:pe,createNewCategoryHandler:ge,createBrandHandler:ye,putPhotoInNewPositionHandler:Te,deletePhotoHandler:He,getListOfAllTraitsHandler:Ce,attachProductPhotoToVariantHandler:Ve,detachVariantPhotoHandler:Le,getTraitHandler:Oe,getListOfTypesOfTraitsHandler:Ae,getListOfTraitsWithOptionsForProductHandler:me,setProductTraitsHandler:Fe,deleteTraitHandler:Se,createNewTraitHandler:Ge,updateTraitHandler:Me,getOptionsForTraitHandler:De,createNewOptionForTraitHandler:ve,updateOptionsForTraitHandler:Ie,deleteOptionsForTraitHandler:Re,changePositionOfTraitOptionHandler:we,createVariantHandler:ze,checkVariantCombinationHandler:Ue,getPurchaseProductVariantsHandler:ke,getVariantStockHistoryHandler:Ne,getProductPhotosForVariantHandler:Qe,updateVariantDetailsHandler:Be,updateVariantTraitOptionsHandler:be,increaseStockAmountForVariantHandler:$e,disposeVariantFromStockHandler:xe,changePhotoPositionForVariantHandler:Ee,deleteVariantHandler:F,deleteSupplierHandler:qe,restoreSupplierHandler:_e,deletePurchaseHandler:S,activateProductHandler:We,deleteProductActionHandler:Ke,deleteVariantActionHandler:Ye,deletePurchaseActionHandler:Ze,manageProductActionHandler:je,manageVariantActionHandler:Je,managePurchaseActionHandler:Xe,addProductActionHandler:tr,reportPurchaseActionHandler:er,gridRequestChangeHandler:rr,applyColumnsActionHandler:nr,resetColumnsActionHandler:ar,tabChangeActionHandler:or,activateVariantActionHandler:ir,getCompaniesListHandler:ur}}export{Sr as u};
