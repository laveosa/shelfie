import{a as pr,d as M,S as D,k as gr,p as yr,q as Tr,G as a,H as h,bu as y,U as v,c as P,A as R,I as Hr,K as o,L as I,Q as T,N as s,Z as Cr,$ as Vr,Y as Lr,bv as w}from"./index-B43MI0p9.js";import{u as Or}from"./useToast-Ef6ZLDEZ.js";function Sr(){const H=pr(),C=M(D.APP),u=M(D.PRODUCTS),n=gr(),l=yr(),{addToast:d}=Or(),{openConfirmationDialog:p}=Tr(),[U]=a.useGetTheProductsForGridMutation(),[z]=a.useGetVariantsForGridMutation(),[k]=h.useGetListOfPurchasesForGridMutation(),[N]=a.useLazyGetBrandsForProductsFilterQuery(),[Q]=a.useLazyGetCategoriesForProductsFilterQuery(),[B]=y.useLazyGetListOfSuppliersQuery(),[b]=a.useLazyGetCountersForProductsQuery(),[$]=a.useLazyGetProductDetailQuery(),[x]=a.useDeleteProductMutation(),[E]=a.useToggleProductActivationMutation(),[q]=v.useUpdateUserPreferencesMutation(),[_]=v.useResetUserPreferencesMutation(),[K]=a.useLazyGetProductPhotosQuery(),[W]=a.useLazyGetProductVariantsQuery(),[Y]=P.useLazyGetTaxesListQuery(),[Z]=P.useLazyGetCurrenciesListQuery(),[j]=a.useLazyGetVariantDetailsQuery(),[J]=h.useLazyGetPurchaseDetailsQuery(),[X]=P.useLazyGetCountryCodeQuery(),[tt]=R.useUploadPhotoMutation(),[et]=h.useLazyGetPurchaseCountersQuery(),[rt]=a.useLazyGetTraitsForFilterQuery(),[nt]=a.useLazyGenerateProductCodeQuery(),[at]=a.useLazyGetSimpleListOfAllBrandsQuery(),[ot]=a.useLazyGetAllCategoriesByOrganizationQuery(),[it]=a.useCheckProductCodeMutation(),[ut]=a.useCheckBrandNameMutation(),[st]=a.useCheckCategoryNameMutation(),[ct]=a.useCreateNewProductMutation(),[dt]=a.useUpdateProductMutation(),[lt]=a.useCreateNewCategoryMutation(),[ht]=a.useCreateBrandMutation(),[ft]=a.usePutPhotoInNewPositionMutation(),[Pt]=R.useDeletePhotoMutation(),[pt]=a.useLazyGetListOfAllTraitsQuery(),[gt]=a.useAttachProductPhotoToVariantMutation(),[yt]=a.useDetachVariantPhotoMutation(),[Tt]=a.useLazyGetTraitQuery(),[Ht]=P.useLazyGetListOfTypesOfTraitsQuery();a.useLazyGetProductVariantsQuery();const[Ct]=a.useLazyGetListOfTraitsWithOptionsForProductQuery(),[Vt]=a.useSetProductTraitsMutation(),[Lt]=a.useDeleteTraitMutation(),[Ar]=a.useLazyGetListOfTraitsForProductQuery(),[Ot]=a.useCreateNewTraitMutation(),[At]=a.useLazyGetOptionsForTraitQuery(),[mt]=a.useCreateNewOptionForTraitMutation(),[Ft]=a.useUpdateOptionOfTraitMutation(),[St]=a.useDeleteOptionOfTraitMutation(),[Gt]=a.useUpdateTraitMutation(),[Mt]=a.useChangePositionOfTraitOptionMutation(),[Dt]=a.useCreateVariantMutation(),[vt]=a.useCheckVariantCombinationMutation(),[Rt]=h.useLazyGetPurchaseProductVariantsQuery(),[It]=a.useLazyGetVariantStockHistoryQuery(),[wt]=a.useLazyGetProductPhotosForVariantQuery(),[Ut]=a.useUpdateVariantDetailsMutation(),[zt]=a.useUpdateVariantTraitOptionsMutation(),[kt]=a.useIncreaseStockAmountForVariantMutation(),[Nt]=a.useDisposeVariantFromStockMutation(),[Qt]=a.useChangePhotoPositionForVariantMutation(),[Bt]=a.useDeleteVariantMutation(),[bt]=y.useDeleteSupplierMutation(),[$t]=y.useRestoreSupplierMutation(),[xt]=h.useDeletePurchaseMutation(),[Et]=a.useToggleVariantIsActiveMutation(),[qt]=Hr.useLazyGetCompaniesListQuery();function V(t,e){return u.products!==null&&!e?null:(n(o.setIsLoading(!0)),U(t).then(r=>{if(n(o.setIsLoading(!1)),!r.error)return n(o.refreshProductsGridRequestModel(r.data)),n(o.refreshProducts(r.data.items)),r.data}))}function L(t){return n(o.setIsLoading(!0)),k(t).then(e=>{if(n(o.setIsLoading(!1)),!e.error)return n(o.refreshPurchasesGridRequestModel(e.data)),n(o.refreshPurchases(e.data.items)),e.data})}function _t(){return N(null).then(t=>(n(o.refreshBrands(t.data)),t.data))}function O(t){return n(o.setIsLoading(!0)),z(t).then(e=>{if(n(o.setIsLoading(!1)),!e.error)return n(o.refreshVariantsGridRequestModel(e.data)),n(o.refreshVariants(e.data.items)),e.data})}function Kt(){return Q(null).then(t=>(n(o.refreshCategories(t.data)),t.data))}function Wt(){return B(null).then(t=>(n(o.refreshSuppliers(t.data)),t.data))}function Yt(t){return b(t).then(e=>(n(o.refreshProductCounter(e.data)),e.data))}function Zt(t){return $(t).then(e=>(n(o.refreshProduct(e.data)),e.data))}function jt(t){return x(t).then(e=>e)}function Jt(t){return E(t).then(e=>e)}function A(t){return q(t).then(()=>{H.getUserPreferencesHandler()})}function m(t){return _(t).then(()=>{H.getUserPreferencesHandler()})}function Xt(t){return n(o.setIsProductPhotosLoading(!0)),K(t).then(e=>(n(o.setIsProductPhotosLoading(!1)),n(o.refreshProductPhotos(e.data)),e.data))}function te(t){return n(o.setIsProductVariantsLoading(!0)),W(t).then(e=>(n(o.setIsProductVariantsLoading(!1)),{...e,data:I(e.data,"color",[{field:"showAlert",value:!0,color:T.ERROR}])}.data))}function ee(){return Y(void 0).then(t=>(n(o.refreshTaxesList(t.data)),t.data))}function re(){return Z(void 0).then(t=>(n(o.refreshCurrenciesList(t.data)),t.data))}function F(t){return j(t).then(e=>({...e.data,traitOptions:I(e.data.traitOptions,"color",[{field:"isRemoved",value:!0,color:T.ERROR},{field:"isMissing",value:!0,color:T.ERROR}])}))}function ne(t){return J(t).then(e=>(n(o.refreshSelectedPurchase(e.data)),e.data))}function ae(){return X(null).then(t=>(t.data&&n(o.refreshCountryCodeList(t.data)),t))}function oe(t){return tt(t).then(e=>e)}function ie(t){return et(t).then(e=>(n(o.refreshPurchaseCounters(e.data)),e.data))}function ue(){return rt(void 0).then(t=>(n(o.refreshSizesForFilter(t.data.filter(e=>e.traitTypeId===1).flatMap(e=>e.traitOptions))),n(o.refreshColorsForFilter(t.data.filter(e=>e.traitTypeId===2).flatMap(e=>e.traitOptions))),t.data))}function se(){return nt(null).then(t=>t.data)}function ce(){return at(null).then(t=>(n(o.refreshBrands(t.data)),t.data))}function de(){return ot(null).then(t=>(n(o.refreshCategories(t.data)),t.data))}function le(t){return it(t).then(e=>e.data)}function he(t){return ut(t).then(e=>e)}function fe(t){return st(t).then(e=>e)}function Pe(t){return ct(t).then(e=>e)}function pe(t,e){return dt({productId:t,model:e}).then(r=>r)}function ge(t){return lt(t).then(e=>e)}function ye(t){return ht(t).then(e=>e)}function Te(t,e,r){return ft({productId:t,photoId:e,index:r}).then(i=>i.data)}function He(t){return Pt(t).then(e=>e.data)}function Ce(){return pt(void 0).then(t=>(n(o.refreshTraits(t.data)),t.data))}function Ve(t,e){return gt({variantId:t,photoId:e}).then(r=>r)}function Le(t,e){return yt({id:t,photoId:e}).then(r=>r)}function Oe(t){return Tt(t).then(e=>e.data)}function Ae(){return Ht(void 0).then(t=>(n(o.refreshTypesOfTraits(t.data)),t.data))}function me(t){return Ct(t).then(e=>(n(o.refreshListOfTraitsWithOptionsForProduct(e.data)),e.data))}function Fe(t,e){return Vt({id:t,model:e}).then(r=>r)}function Se(t){return Lt(t).then(e=>e)}function Ge(t){return Ot(t).then(e=>e.data)}function Me(t,e){return Gt({id:t,model:e}).then(r=>r.data)}function De(t){return At(t).then(e=>e.data)}function ve(t,e){return mt({id:t,model:e}).then(r=>r.data)}function Re(t,e){return Ft({id:t,model:e}).then(r=>r.data)}function Ie(t){return St(t).then(e=>e)}function we(t,e,r){return Mt({traitId:t,optionId:e,index:r}).then(i=>i)}function Ue(t,e){return Dt({id:t,model:e}).then(r=>r.data)}function ze(t,e){return vt({id:t,model:e}).then(r=>r.data)}function ke(t,e){return Rt({purchaseId:t,productId:e}).then(r=>r.data)}function Ne(t){return It(t).then(e=>e.data)}function Qe(t,e){return wt({productId:t,variantId:e}).then(r=>r.data)}function Be(t,e){return Ut({id:t,model:e}).then(r=>r.data)}function be(t,e){return zt({id:t,model:e}).then(r=>r)}function $e(t,e){return kt({id:t,model:e}).then(r=>r.data)}function xe(t,e){return Nt({id:t,model:e}).then(r=>r.data)}function Ee(t,e,r){return Qt({id:t,photoId:e,index:r}).then(i=>i.data)}function S(t){return Bt(t).then(e=>e)}function qe(t){return bt(t).then(e=>e)}function _e(t){return $t(t).then(e=>e)}function G(t){return xt(t).then(e=>e)}function Ke(t){Jt(t.productId).then(e=>{e.error?d({text:e.error.data.detail,type:"error"}):(n(o.refreshProductsGridRequestModel({...u.productsGridRequestModel,items:u.productsGridRequestModel.items.map(r=>r.productId===t.productId?{...r,isActive:!t.isActive}:r)})),d({text:"Product successfully activated",type:"success"}))})}async function We(t){var r;await p({headerTitle:"Delete Product",text:`You are about to delete product "${t.row.original.productName}".`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&((r=t.table.options.meta)==null||r.hideRow(t.row.original.id),await jt(t.row.original.productId).then(i=>{var c;i.error?((c=t.table.options.meta)==null||c.unhideRow(t.row.original.id),d({text:i.error.data.detail,type:"error"})):d({text:"Product deleted successfully",type:"success"})}))}async function Ye(t){var r;await p({headerTitle:"Delete Variant",text:`You are about to delete variant "${t.row.original.variantName}".`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&((r=t.table.options.meta)==null||r.hideRow(t.row.original.id),await S(t.row.original.variantId).then(i=>{var c;i.error?((c=t.table.options.meta)==null||c.unhideRow(t.row.original.id),d({text:i.error.data.detail,type:"error"})):d({text:"Variant deleted successfully",type:"success"})}))}async function Ze(t){var r;await p({headerTitle:"Delete Purchase",text:`You are about to delete purchase "${t.row.original.purchaseId}".`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&((r=t.table.options.meta)==null||r.hideRow(t.row.original.id),await G(t.row.original.purchaseId).then(i=>{var c;i.error?((c=t.table.options.meta)==null||c.unhideRow(t.row.original.id),d({text:i.error.data.detail,type:"error"})):d({text:"Purchase deleted successfully",type:"success"})}))}function je(t){n(o.resetProduct()),l(`${s.PRODUCTS}${s.PRODUCT_BASIC_DATA}/${t}`)}function Je(t,e){n(o.refreshSelectedVariant({variantId:t})),l(`${s.PRODUCTS}${s.MANAGE_VARIANTS}/${e}`)}function Xe(t){l(`${s.PRODUCTS}${s.SUPPLIER}/${t}`)}function tr(){l(`${s.PRODUCTS}${s.PRODUCT_BASIC_DATA}`)}function er(){n(o.resetSelectedPurchase()),n(o.resetSelectedSupplier()),l(`${s.PRODUCTS}${s.SUPPLIER}/`)}function rr(t){u.activeTab==="products"?V(t,!0):u.activeTab==="variants"?O(t):u.activeTab==="purchases"&&L(t)}function nr(t){const e=Cr.merge({},C.preferences,t);n(Vr.refreshPreferences(e)),A(e)}function ar(){m(u.activeTab)}function or(t){t!==u.activeTab&&n(o.refreshActiveTab(t))}function ir(t){Et(t.variantId).then(e=>{e.error?d({text:"Variant not activated",description:e.error.message,type:"error"}):(n(o.refreshVariantsGridRequestModel({...u.variantsGridRequestModel,items:u.variantsGridRequestModel.items.map(r=>r.variantId===t.variantId?{...r,isActive:!t.isActive}:r)})),d({text:"Variant activated successfully",type:"success"}))})}function ur(){u.companies||qt().then(t=>{n(o.refreshCompanies(t.data))})}function sr(t,e){const{idKey:r,nameKey:i,imageKeyPath:c,type:dr}=e;return t==null?void 0:t.map(f=>{const lr=f[r],hr=f[i],fr=c?c.split(".").reduce((g,Pr)=>g==null?void 0:g[Pr],f):void 0;return{id:lr,name:hr,imageUrl:fr,originalItem:f,type:dr}})}function cr({item:t,type:e}){switch(e){case"product":n(o.resetProductCounter()),n(o.refreshProductPhotos([])),n(o.resetProduct()),n(o.refreshProductVariants([])),n(o.resetSelectedVariant()),l(`${w.PRODUCTS}${w.PRODUCT_BASIC_DATA}/${t.productId}`);break;case"variant":F(t.variantId).then(r=>{n(o.refreshSelectedVariant(r)),n(o.refreshVariantPhotos(r.photos)),l(`${s.PRODUCTS}${s.MANAGE_VARIANTS}/${t==null?void 0:t.productId}`),n(o.refreshProductVariants(Lr(t.variantId,u.productVariants,"variantId")))});break}}return{state:u,appState:C,dispatch:n,getTheProductsForGridHandler:V,getVariantsForGridHandler:O,getListOfPurchasesForGridHandler:L,getBrandsForFilterHandler:_t,getCategoriesForFilterHandler:Kt,getListOfSuppliersHandler:Wt,getCountersForProductsHandler:Yt,getProductDetailsHandler:Zt,updateUserPreferencesHandler:A,resetUserPreferencesHandler:m,getProductPhotosHandler:Xt,getProductVariantsHandler:te,getTaxesListHandler:ee,getCurrenciesListHandler:re,getVariantDetailsHandler:F,getPurchaseDetailsHandler:ne,getCountryCodeHandler:ae,uploadPhotoHandler:oe,getPurchaseCountersHandler:ie,getTraitsForFilterHandler:ue,itemsCardItemsConvertor:sr,itemCardHandler:cr,generateProductCodeHandler:se,getSimpleListOfAllBrandsHandler:ce,getAllCategoriesByOrganizationHandler:de,checkProductCodeHandler:le,checkBrandNameHandler:he,checkCategoryNameHandler:fe,createNewProductHandler:Pe,updateProductHandler:pe,createNewCategoryHandler:ge,createBrandHandler:ye,putPhotoInNewPositionHandler:Te,deletePhotoHandler:He,getListOfAllTraitsHandler:Ce,attachProductPhotoToVariantHandler:Ve,detachVariantPhotoHandler:Le,getTraitHandler:Oe,getListOfTypesOfTraitsHandler:Ae,getListOfTraitsWithOptionsForProductHandler:me,setProductTraitsHandler:Fe,deleteTraitHandler:Se,createNewTraitHandler:Ge,updateTraitHandler:Me,getOptionsForTraitHandler:De,createNewOptionForTraitHandler:ve,updateOptionsForTraitHandler:Re,deleteOptionsForTraitHandler:Ie,changePositionOfTraitOptionHandler:we,createVariantHandler:Ue,checkVariantCombinationHandler:ze,getPurchaseProductVariantsHandler:ke,getVariantStockHistoryHandler:Ne,getProductPhotosForVariantHandler:Qe,updateVariantDetailsHandler:Be,updateVariantTraitOptionsHandler:be,increaseStockAmountForVariantHandler:$e,disposeVariantFromStockHandler:xe,changePhotoPositionForVariantHandler:Ee,deleteVariantHandler:S,deleteSupplierHandler:qe,restoreSupplierHandler:_e,deletePurchaseHandler:G,activateProductHandler:Ke,deleteProductActionHandler:We,deleteVariantActionHandler:Ye,deletePurchaseActionHandler:Ze,manageProductActionHandler:je,manageVariantActionHandler:Je,managePurchaseActionHandler:Xe,addProductActionHandler:tr,reportPurchaseActionHandler:er,gridRequestChangeHandler:rr,applyColumnsActionHandler:nr,resetColumnsActionHandler:ar,tabChangeActionHandler:or,activateVariantActionHandler:ir,getCompaniesListHandler:ur}}export{Sr as u};
