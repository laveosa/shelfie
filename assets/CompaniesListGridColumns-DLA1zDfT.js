import{o as k,r as C,j as o,i as p,m as y,n as e,C as g,e as S,w as T,x as B}from"./index-B43MI0p9.js";import{S as b}from"./SheCard-BEJVnwk7.js";import{S as w}from"./SheDatePicker-B4IkWzjg.js";import{S as I}from"./SheTextarea-BZQjs0WY.js";import{u as L,I as D}from"./useAppTranslation-DzTOekUh.js";import{m as K}from"./SheContextSidebar-wP16Oj66.js";import{P as c}from"./settings-2-Cyizket8.js";import{C as R}from"./trash-PifBxtw9.js";const E="_supplierCard_noepp_1",F="_supplierCardContent_noepp_1",M="_purchaseBlock_noepp_7",$="_noSelectedSupplier_noepp_12",W="_noSelectedSupplierText_noepp_16",z="_selectedSupplier_noepp_19",U="_selectedSupplierDetails_noepp_24",G="_supplierPhoto_noepp_30",q="_supplierDesc_noepp_42",H="_supplierNameTooltip_noepp_48",J="_supplierName_noepp_48",O="_deletedSupplier_noepp_57",Q="_twoLineEllipsis_noepp_60",V="_deletedSupplierBlock_noepp_69",X="_deletedSupplierText_noepp_75",Y="_purchaseButtonBlock_noepp_78",t={supplierCard:E,supplierCardContent:F,purchaseBlock:M,noSelectedSupplier:$,noSelectedSupplierText:W,selectedSupplier:z,selectedSupplierDetails:U,supplierPhoto:G,supplierDesc:q,supplierNameTooltip:H,supplierName:J,deletedSupplier:O,twoLineEllipsis:Q,deletedSupplierBlock:V,deletedSupplierText:X,purchaseButtonBlock:Y};function ra({isLoading:r,selectedPurchase:a,selectedSupplier:n,showCloseButton:l,onAction:i}){var _,j,N;const{purchaseId:s}=k(),[m,h]=C.useState(s?a==null?void 0:a.date:null),[u,v]=C.useState(null),{translate:x}=L(),f=!!!(m||a!=null&&a.date)||!n;return C.useEffect(()=>{a!=null&&a.date&&h(a.date)},[a]),o.jsx(b,{className:t.supplierCard,title:"Create Purchase",titleTransKey:"SectionTitles.CreatePurchase",showCloseButton:l,isLoading:r,showNotificationCard:!!s,notificationCardProps:{title:"Delete Purchase",titleTransKey:"CardTitles.DeletePurchase",text:"The purchase will be deleted, but the changes in stock will remain intact.",textTransKey:"ConfirmationMessages.DeletePurchase",onClick:()=>i("deletePurchase",a)},onSecondaryButtonClick:()=>i("closeSupplierCard"),children:o.jsx("div",{className:t.supplierCardContent,children:o.jsxs("div",{className:t.purchaseBlock,children:[o.jsxs("div",{className:t.noSelectedSupplier,children:[o.jsx("span",{className:`${t.noSelectedSupplierText} she-text`,children:x("PurchaseForm.Labels.SupplierSelection")}),o.jsx(p,{icon:n?K:c,value:n?"Replace Supplier":"Select Supplier",valueTransKey:n?"SupplierActions.ReplaceSupplier":"SupplierActions.SelectSupplier",variant:"secondary",maxWidth:"160px",minWidth:"160px",onClick:()=>{i(n?"detachSupplier":"openSelectEntityCard")}})]}),n&&o.jsxs("div",{className:t.selectedSupplier,children:[o.jsxs("div",{className:t.selectedSupplierDetails,children:[o.jsx("div",{className:t.supplierPhoto,children:n.thumbnailUrl?o.jsx("img",{src:n==null?void 0:n.thumbnailUrl,alt:n==null?void 0:n.companyName}):o.jsx(y,{icon:D})}),o.jsxs("div",{className:t.supplierDesc,children:[o.jsx(e,{delayDuration:200,text:n==null?void 0:n.companyName,className:t.supplierNameTooltip,children:o.jsx("span",{className:`${n.isDeleted?t.deletedSupplier:""} ${t.supplierName} she-text`,children:n==null?void 0:n.companyName})}),((n==null?void 0:n.address)||((_=a==null?void 0:a.location)==null?void 0:_.address))&&o.jsx(e,{delayDuration:200,text:(n==null?void 0:n.address)||((j=a==null?void 0:a.location)==null?void 0:j.address),className:"max-w-[150px]",children:o.jsx("span",{className:`
                        ${n.isDeleted?t.deletedSupplier:""}
                        ${t.twoLineEllipsis} she-text`,children:(n==null?void 0:n.address)||((N=a==null?void 0:a.location)==null?void 0:N.address)})})]}),o.jsx(p,{icon:n.isDeleted?c:g,value:n.isDeleted?"Restore":"Manage",valueTransKey:n.isDeleted?"CommonButtons.Restore":"CommonButtons.Manage",variant:"secondary",onClick:()=>{n.isDeleted?i("restoreCompany",n):i("manageCompany",n)}})]}),n.isDeleted&&o.jsx("div",{className:t.deletedSupplierBlock,children:o.jsx("span",{className:`${t.deletedSupplierText} she-text`,children:x("MarginMessages.SupplierIsDeleted")})})]}),o.jsx(S,{}),o.jsx("span",{className:"she-title",children:x("PurchaseForm.Labels.PurchaseDateTitle")}),o.jsx(w,{date:a==null?void 0:a.date,label:"Purchase Date",labelTransKey:"PurchaseForm.Labels.PurchaseDate",icon:R,fullWidth:!0,onSelectDate:d=>h(d)}),o.jsx(I,{value:(a==null?void 0:a.documentNotes)||null,label:"Purchase notes",labelTransKey:"PurchaseForm.Labels.PurchaseNotes",placeholder:"Type your notes here...",placeholderTransKey:"PurchaseForm.Placeholders.PurchaseNotes",fullWidth:!0,onDelay:d=>v(d)}),o.jsxs("div",{className:t.purchaseButtonBlock,children:[o.jsx(p,{value:"Cancel",valueTransKey:"CommonButtons.Cancel",variant:"secondary",onClick:()=>i("closeSupplierCard")}),o.jsx(p,{value:a!=null&&a.purchaseId?"Save":"Create Purchase",valueTransKey:a!=null&&a.purchaseId?"CommonButtons.Save":"CommonButtons.CreatePurchase",icon:!(a!=null&&a.purchaseId)&&c,txtColor:!(a!=null&&a.purchaseId)&&"#fff",bgColor:!(a!=null&&a.purchaseId)&&"#007AFF",disabled:f,onClick:()=>s?i("updatePurchase",{purchaseId:s,selectedDate:m,selectedSupplier:n,purchaseNotes:u}):i("createPurchase",{selectedDate:m,selectedSupplier:n,purchaseNotes:u})})]})]})})})}const Z="_iconCheck_1wa1s_1",A={iconCheck:Z};function ea({onAction:r}){return[{id:"select",header:"Select",minSize:70,maxSize:70,cell:({row:a,table:n})=>{const l=n.options.meta,i=s=>{s.stopPropagation(),s.preventDefault(),r("selectCompany",a.original)};return o.jsx("div",{onClick:s=>s.stopPropagation(),children:o.jsx(p,{className:a.original.isSelected===!0?A.iconCheck:"",icon:a.original.isSelected===!0?T:B,variant:"ghost",onClick:i,disabled:l==null?void 0:l.isRowLoading(a.id)})})}},{id:"companyName",header:"Company",cell:({row:a})=>{const n=a.original.thumbnailUrl,l=a.original.companyName,i=a.original.address;return o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginLeft:"-8px"},children:[o.jsx("div",{children:n?o.jsx("img",{src:n,alt:l||"Supplier",className:"object-cover rounded-md w-full h-full",style:{minWidth:"48px",height:"48px"}}):o.jsx("div",{style:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center"},children:o.jsx(y,{icon:D,maxWidth:"30px"})})}),o.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[o.jsx(e,{delayDuration:200,text:l,className:"max-w-[120px] overflow-hidden text-ellipsis whitespace-nowrap",children:o.jsx("span",{className:"she-text",children:l})}),i&&o.jsx(e,{delayDuration:200,text:i,className:"max-w-[120px] overflow-hidden text-ellipsis whitespace-nowrap",children:o.jsx("span",{className:"she-subtext",children:i})})]})]})}},{id:"manage",header:"Actions",minSize:120,maxSize:120,cell:({row:a,table:n})=>{const l=n.options.meta,i=s=>{s.stopPropagation(),s.preventDefault(),r("manageCompany",a.original)};return o.jsx("div",{onClick:s=>s.stopPropagation(),children:o.jsx(p,{icon:g,value:"Manage",variant:"secondary",onClick:i,disabled:l==null?void 0:l.isRowLoading(a.id)})})}}]}export{ea as C,ra as S};
