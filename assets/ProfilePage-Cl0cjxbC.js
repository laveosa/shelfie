import{r as S,_ as G,j as e,D as I,u as z,S as j,a as O,b as V,c as b,U as N,A as q,P,d as _,e as h}from"./index-DE8FC31Q.js";import{S as B}from"./SheSelect-Bnp5wosR.js";import{C as F,S as Y,T as Q}from"./SheCardNotification-DUlrNDfI.js";import{o as L,s as d,n as Z,u as M,S as U,a as u}from"./types-BpsGP7tN.js";import{R as T,S as f}from"./SheInput-DJYrlJak.js";import{S as K}from"./SheFileUploader-eGz_2cay.js";import{c as w}from"./she-select-convertors-CdG-Ygpu.js";import{u as J}from"./useToast-DMA-XTAl.js";import{u as X}from"./useIsMobile-CoIf1vaq.js";import"./select-Dspx3aJl.js";import"./chevron-up-BEoR0LiH.js";import"./useAppTranslation-AHltnnYV.js";import"./form-BtYdrlWt.js";import"./ComponentViewEnum-Ba6F4129.js";const ee="_profilePage_19btc_1",ae="_profilePageContent_19btc_4",oe="_profilePageTitle_19btc_8",se="_profilePageBlock_19btc_11",te="_profilePageTextBlock_19btc_17",re="_passwordBlock_19btc_25",ne="_passwordRulesList_19btc_25",le="_profilePageContentBlock_19btc_29",ie="_fileUploader_19btc_63",ce="_cardNotificationWrapper_19btc_66",de="_cardNotification_19btc_66",ue="_cardSubtitle_19btc_74",me="_isMobile_19btc_79",a={profilePage:ee,profilePageContent:ae,profilePageTitle:oe,profilePageBlock:se,profilePageTextBlock:te,passwordBlock:re,passwordRulesList:ne,profilePageContentBlock:le,fileUploader:ie,cardNotificationWrapper:ce,cardNotification:de,cardSubtitle:ue,isMobile:me},pe="_contactInformationForm_13vu1_1",fe="_phoneNumberBlock_13vu1_9",he="_countryCode_13vu1_15",ge="_phoneNumber_13vu1_9",xe="_formFooter_13vu1_21",g={contactInformationForm:pe,phoneNumberBlock:fe,countryCode:he,phoneNumber:ge,formFooter:xe},v="field is required",Pe=L({firstName:d().nonempty(v).min(2,"Min value length 2").max(50,"Max value length 50"),lastName:d().nonempty(v).min(2,"Min value length 2").max(50,"Max value length 50"),email:d().nonempty(v).email("Invalid email format").max(100,"Max value length 100"),countryPhoneCode:d(),countryId:Z(),phoneNumber:d().nonempty(v).min(5,"Min phone number length 5").max(12,"Max phone number length 12")}),ve={firstName:void 0,lastName:void 0,email:void 0,phoneNumber:void 0,countryCode:void 0,countryPhoneCode:void 0,countryId:null,localeCode:void 0,organization:void 0,shortName:void 0,thumbnail:void 0,userId:null};function Ne({data:t,countryCodes:o,onSubmit:s}){const{form:m,setValue:r}=M({values:t,defaultValues:ve,scheme:Pe,mode:T.CHANGE});return S.useEffect(()=>{t&&G.isNil(t.countryId)&&o&&o.length>0&&r("countryId",o[0].value)},[t,o]),e.jsxs(U,{form:m,className:g.contactInformationForm,footerClassName:g.formFooter,footerPosition:I.RIGHT,primaryBtnProps:{value:"Save Changes",valueTransKey:"CommonButtons.SaveChanges",icon:F},hideSecondaryBtn:!0,onSubmit:s,children:[e.jsx(u,{name:"firstName",render:({field:n})=>e.jsx(f,{value:n.value,label:"First Name",placeholder:"enter your first name...",fullWidth:!0})}),e.jsx(u,{name:"lastName",render:({field:n})=>e.jsx(f,{value:n.value,label:"Last Name",placeholder:"enter your last name...",fullWidth:!0})}),e.jsx(u,{name:"email",render:({field:n})=>e.jsx(f,{value:n.value,label:"Email",placeholder:"enter your email...",fullWidth:!0})}),e.jsxs("div",{className:g.phoneNumberBlock,children:[e.jsx("div",{className:g.countryCode,children:e.jsx(u,{name:"countryId",render:({field:n})=>e.jsx(B,{items:o,selected:n.value,label:"Phone",hideFirstOption:!0})})}),e.jsx(u,{name:"phoneNumber",render:({field:n})=>e.jsx(f,{value:n.value,className:g.phoneNumber,placeholder:"enter your phone number...",type:"number",fullWidth:!0})})]})]})}const ye="_changePasswordForm_vk26y_1",je="_formFooter_vk26y_9",C={changePasswordForm:ye,formFooter:je},y="field is required",k=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z\d]).{9,}$/,be=L({password:d().nonempty(y).regex(k,"Password must contain at least one lowercase, one uppercase, one digit, one special character and be at least 9 characters long").max(50,"Max value length 50"),newPassword:d().nonempty(y).regex(k,"Password must contain at least one lowercase, one uppercase, one digit, one special character and be at least 9 characters long").max(50,"Max value length 50"),confirmPassword:d().nonempty(y).max(50,"Max value length 50")}).refine(t=>t.confirmPassword===t.newPassword,{message:"Passwords do not match",path:["confirmPassword"]}),_e={password:void 0,newPassword:void 0,confirmPassword:void 0};function we({data:t,onSubmit:o}){const{form:s}=M({values:t,defaultValues:_e,scheme:be,mode:T.CHANGE});function m(r){o==null||o(r),s.reset({},{keepErrors:!1,keepDirty:!1}),setTimeout(()=>s.clearErrors(),0)}return e.jsxs(U,{form:s,className:C.changePasswordForm,footerClassName:C.formFooter,footerPosition:I.RIGHT,hideSecondaryBtn:!0,primaryBtnTitle:"Save Changes",primaryBtnProps:{icon:F},onSubmit:m,children:[e.jsx(u,{name:"password",render:({field:r})=>e.jsx(f,{value:r.value,label:"Password",placeholder:"enter your first name...",type:"password",fullWidth:!0})}),e.jsx(u,{name:"newPassword",render:({field:r})=>e.jsx(f,{value:r.value,label:"New Password",placeholder:"enter new password...",type:"password",fullWidth:!0})}),e.jsx(u,{name:"confirmPassword",render:({field:r})=>e.jsx(f,{value:r.value,label:"Confirm Password",placeholder:"enter new password...",type:"password",fullWidth:!0})})]})}function Ce(){z(l=>l[j.PROFILE]);const t=O(),o=V(),{addToast:s}=J(),[m]=b.useLazyGetCountryCodeQuery(),[r]=N.useUpdateUserContactInformationMutation(),[n]=q.useUploadPhotoMutation(),[x]=N.useUpdateUserPasswordMutation(),[p]=b.useLazyGetLanguagesListQuery(),[H]=N.useChangeLanguageMutation();function A(){m().then(l=>{o(P.refreshCountryCodes(l.data))})}function E(l){r(l).then(i=>{i.error||t.getUserDetailsHandler()})}function D(l){return o(P.setIsImageUploaderLoading(!0)),n(l).then(i=>{var c;o(P.setIsImageUploaderLoading(!1)),i.error?s({text:((c=i.error.data)==null?void 0:c.detail)||"Upload failed",type:"error"}):(t.getUserDetailsHandler(),s({text:"Photos added successfully",type:"success"}))})}function R(l){return x(l).then(i=>{var c;i.error?s({text:(c=i.error.data)==null?void 0:c.detail,type:"error"}):s({text:"Password updated successfully",type:"success"})})}function W(){p().then(l=>{o(P.refreshLanguagesList(l.data))})}function $(l){H({languageCode:l}).then(i=>{var c;i.error||(t.getUserDetailsHandler(),s({text:"Language updated successfully",type:"success"})),s({text:(c=i.error.data)==null?void 0:c.detail,type:"error"})})}return{getCountryCodesHandler:A,updateUserContactInformationHandler:E,uploadPhotoHandler:D,updateUserPasswordHandler:R,getLanguagesListHandler:W,changeLanguageHandler:$}}function We(){var r,n,x;const t=_(j.PROFILE),o=_(j.APP),s=Ce(),m=X();return S.useEffect(()=>{s.getCountryCodesHandler(),s.getLanguagesListHandler()},[]),e.jsx("div",{className:`${a.profilePage} ${m?a.isMobile:""}`,children:e.jsxs("div",{className:a.profilePageContent,children:[e.jsx("div",{className:a.profilePageTitle,children:e.jsx("span",{className:"she-title",children:"Account"})}),e.jsx(h,{}),e.jsxs("div",{className:a.profilePageBlock,children:[e.jsxs("div",{className:a.profilePageTextBlock,children:[e.jsx("span",{className:a.cardSubtitle,children:"Avatar"}),e.jsx("span",{className:"she-text",children:"Your personal image"})]}),e.jsx("div",{className:a.profilePageContentBlock,children:e.jsx(K,{className:a.fileUploader,isLoading:t.isImageUploaderLoading,user:o.user,avatarImage:(r=o.user)==null?void 0:r.thumbnail,uploadAreaText:"Upload avatar",uploadAreaSubtext:"Click here or drag and drop image",contextName:"user",maxFiles:1,contextId:(n=o.user)==null?void 0:n.userId,onUpload:p=>s.uploadPhotoHandler(p)})})]}),e.jsx(h,{}),e.jsxs("div",{className:a.profilePageBlock,children:[e.jsxs("div",{className:a.profilePageTextBlock,children:[e.jsx("span",{className:a.cardSubtitle,children:"Contact Information"}),e.jsx("span",{className:"she-text",children:"Credentials you will use to authenticate in the system"})]}),e.jsx("div",{className:a.profilePageContentBlock,children:e.jsx(Ne,{countryCodes:w(t.countryCodes,{text:"countryName",value:"countryId",icon:"flagIcon"}),data:o.user,onSubmit:p=>s.updateUserContactInformationHandler(p)})})]}),e.jsx(h,{}),e.jsxs("div",{className:a.profilePageBlock,children:[e.jsxs("div",{className:a.profilePageTextBlock,children:[e.jsx("span",{className:a.cardSubtitle,children:"Password"}),e.jsxs("div",{className:a.passwordBlock,children:[e.jsx("span",{className:"she-text",children:"Password requirements :"}),e.jsxs("ul",{className:a.passwordRulesList,children:[e.jsx("li",{children:"At least 8 characters long"}),e.jsx("li",{children:"At least one uppercase character"}),e.jsx("li",{children:"Password must include a special character"})]})]})]}),e.jsx("div",{className:a.profilePageContentBlock,children:e.jsx(we,{onSubmit:p=>s.updateUserPasswordHandler(p)})})]}),e.jsx(h,{}),e.jsxs("div",{className:a.profilePageBlock,children:[e.jsxs("div",{className:a.profilePageTextBlock,children:[e.jsx("span",{className:a.cardSubtitle,children:"Language"}),e.jsx("span",{className:"she-text",children:"Your language of choice for system text"})]}),e.jsx("div",{className:a.profilePageContentBlock,children:e.jsx(B,{items:w(t.languagesList,{text:"name",value:"localeCode",icon:"flagIcon"}),selected:(x=o.user)==null?void 0:x.localeCode,hideFirstOption:!0,label:"Language",fullWidth:!0,onSelect:s.changeLanguageHandler})})]}),e.jsx(h,{}),e.jsx("div",{className:a.cardNotificationWrapper,children:e.jsx(Y,{className:a.cardNotification,title:"Delete Account",text:"Your account will be removed and you will loose access to the system.",buttonColor:"#FF0000",buttonIcon:Q,buttonText:"Delete",buttonVariant:"outline"})})]})})}export{We as ProfilePage};
