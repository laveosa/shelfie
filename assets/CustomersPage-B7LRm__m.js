import{j as s,m as E,I as D,z as p,ai as C,k as j,a as f,S as g,p as G,G as H,ae as O,U as x,aj as t,N as u,l as S,a4 as N,ak as T,r as _}from"./index-CqLEDb0h.js";import{S as w}from"./SheGrid-Fci2HgNW.js";import{u as A,I as z}from"./useAppTranslation-CsMEigHw.js";import{G as I,a as k}from"./GridSortingEnum-Qa64oiYF.js";import{P as V}from"./plus-Cg_Vlo1I.js";import"./SheSelect-C_zn2LY0.js";import"./select-DL5f33uf.js";import"./chevron-up-DLJ1s3UP.js";import"./SheInput-DbpOA7IC.js";import"./settings-2-BKZv0M77.js";const b="_CustomersPage_1hy8j_1",F="_pageHeader_1hy8j_1",L="_customersPageContent_1hy8j_9",h={CustomersPage:b,pageHeader:F,customersPageContent:L};function q(o){const{translate:a}=A();return[{accessorKey:"customerId",header:"ID",minSize:40,maxSize:40,cell:({row:e})=>s.jsx("span",{className:"she-text",children:e.getValue("customerId")})},{id:"customerName",accessorFn:e=>e.customerName,header:"Customer",minSize:150,cell:({row:e})=>{const r=e.original.thumbnailUrl;return s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(E,{icon:r||z,className:"m-auto",style:{...!r&&{padding:"10px"}},minWidth:"40px",maxWidth:"40px",color:"#64748b",iconView:D.BUTTON}),s.jsx(p,{delayDuration:200,text:e.getValue("customerName"),className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:s.jsx("span",{className:"she-text",children:e.getValue("customerName")})})]})}},{accessorKey:"email",header:"Email",minSize:100,cell:({row:e})=>s.jsx(p,{delayDuration:200,text:e.original.email,className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:s.jsx("span",{className:"she-text",children:e.original.email})})},{accessorKey:"phoneNumber",header:"Phone",minSize:100,cell:({row:e})=>s.jsx(p,{delayDuration:200,text:e.getValue("phoneNumber"),className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:s.jsx("span",{className:"she-text",children:e.getValue("phoneNumber")})})},{accessorKey:"rank",header:"Rank",minSize:100,cell:({row:e})=>s.jsx("span",{className:"she-text",children:e.getValue("rank")})},{accessorKey:"createdAt",header:"Created At",minSize:150,maxSize:150,cell:({row:e})=>{const r=e.getValue("createdAt"),i=C(r,"dd-mm-yyyy hh:mm","No Date");return s.jsx("span",{className:"she-text",children:i})}},{accessorKey:"lastOrderDate",header:"Last Order Date",minSize:150,maxSize:150,cell:({row:e})=>{const r=e.getValue("lastOrderDate"),i=C(r,"dd-mm-yyyy hh:mm","No Orders");return s.jsx("span",{className:"she-text",children:i})}},{id:"manage",header:"",minSize:100,maxSize:100,cell:({row:e})=>s.jsx(j,{value:a("CommonButtons.Manage"),onClick:()=>o("manageCustomer",e.original)})}]}const K={addressesAmount:void 0,openCartsAmount:void 0,ordersAmount:void 0};function P(o){return{...K,...o}}function $(){const o=f(g.CUSTOMERS),a=f(g.APP),e=G(),r=H(),[i]=O.useGetCustomersForGridMutation(),[l]=x.useUpdateUserPreferencesMutation(),[m]=x.useResetUserPreferencesMutation();function d(n){return e(t.setIsCustomersLoading(!0)),i(n).then(c=>{e(t.setIsCustomersLoading(!1)),c.error||(e(t.refreshCustomersGridRequestModel(c.data)),e(t.refreshCustomers(c.data.items)))})}function v(n){e(t.refreshSelectedCustomer(n)),e(t.refreshCustomerCounter(P())),e(t.refreshCustomerAddresses(null)),e(t.refreshCustomerAddressesGridRequestModel({})),r(`${u.CUSTOMERS}${u.CUSTOMER_BASIC_DATA}/${n.id}`)}function y(){e(t.refreshCustomerCounter(P())),e(t.resetSelectedCustomer()),r(`${u.CUSTOMERS}${u.CUSTOMER_BASIC_DATA}`)}function U(n){const c=S.merge({},a.preferences,n);return e(N.refreshPreferences(c)),l(n)}function R(n){const c=S.merge({},a.preferences,{viewsReferences:{customerReferences:T.viewsReferences.customerReferences}});return e(N.refreshPreferences(c)),m(n).catch(M=>{console.error("Failed to reset preferences on server:",M)})}return{state:o,appState:a,getCustomersForGridHandler:d,onManageCustomerHandler:v,onCreateCustomerHandler:y,updateUserPreferencesHandler:U,resetUserPreferencesHandler:R}}function te(){const{translate:o}=A(),{state:a,appState:e,...r}=$(),i=Object.values(I).map(m=>({value:m,description:k[m]}));_.useEffect(()=>{r.getCustomersForGridHandler(a.customersGridRequestModel)},[]);function l(m,d){switch(m){case"manageCustomer":r.onManageCustomerHandler(d);break}}return s.jsxs("div",{className:h.CustomersPage,children:[s.jsxs("div",{className:h.pageHeader,children:[s.jsx("span",{className:"she-title",children:o("PageTitles.Customers")}),s.jsx("div",{children:s.jsx(j,{value:o("CustomerActions.CreateCustomer"),icon:V,variant:"info",onClick:r.onCreateCustomerHandler})})]}),s.jsx("div",{className:h.customersPageContent,children:s.jsx(w,{gridRequestModel:a.customersGridRequestModel,columns:q(l),sortingItems:i,columnsPreferences:e.preferences,preferenceContext:"customerReferences",isLoading:a.isCustomersLoading,skeletonQuantity:10,onApplyColumns:r.updateUserPreferencesHandler,onDefaultColumns:()=>r.resetUserPreferencesHandler("Customers"),onGridRequestChange:r.getCustomersForGridHandler})})]})}export{te as CustomersPage};
