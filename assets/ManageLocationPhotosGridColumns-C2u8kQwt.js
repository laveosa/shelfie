import{j as e,D as X,r as b,aq as Y,e as v,f as P,w as B,x as Z,_ as ee}from"./index-DybU9lv3.js";import{S as z}from"./SheFileUploader-BAVOSjtG.js";import{a as ae}from"./AddressForm-JvxW60Zk.js";import{S as F}from"./SheCard-JWlyTss7.js";import{c as S}from"./she-select-convertors-CdG-Ygpu.js";import{P as T}from"./plus-Dv0aUE5j.js";import{S as E}from"./SheSelect-DkAtzaWK.js";import{o as $,n as w,s as C,u as W,S as K,a as p}from"./types-Cs0d5Ub-.js";import{S as g}from"./SheInput-CKzfybja.js";import{S as A}from"./SheGrid-DvAOS33I.js";import{I as M,u as oe}from"./useAppTranslation-NlALFuCP.js";import{I as V}from"./SheContextSidebar-BKksk-en.js";import{T as R}from"./SheCardNotification-Yx-BMvzf.js";const te="_createCompanyCard_3cw4c_1",se="_createCompanyCardContent_3cw4c_1",ne="_createCompanyCardButtonBlock_3cw4c_6",L={createCompanyCard:te,createCompanyCardContent:se,createCompanyCardButtonBlock:ne},re="_createSupplierForm_1g0f1_1",le="_createSupplierFormItem_1g0f1_7",y={createSupplierForm:re,createSupplierFormItem:le},ie="field is required",ce=$({companyName:C().nonempty(ie).min(2,"min value length 2").max(16,"max value length 16"),nip:C().optional(),customerCareEmail:C().email().optional(),countryId:w().optional()}),de={id:void 0,title:void 0,description:void 0,isActive:void 0,image:void 0,companyId:void 0,appId:void 0,companyName:void 0,isDeleted:void 0,locationId:void 0,thumbnailUrl:void 0,address:void 0,isSelected:void 0,nip:void 0,customerCareEmail:void 0,photos:void 0,locations:void 0,countryId:void 0};function q({data:i,countryCodes:a,onChange:s}){const{form:o}=W({values:i,defaultValues:de,scheme:ce});function l(n,d){s==null||s({companyName:n.companyName||"",nip:n.nip||"",customerCareEmail:n.customerCareEmail||"",countryId:n.countryId||null},d)}return e.jsxs(K,{className:y.createSupplierForm,form:o,formPosition:X.CENTER,fullWidth:!0,hideFooter:!0,onChange:l,children:[e.jsx(p,{className:y.createSupplierFormItem,name:"companyName",render:({field:n})=>e.jsx(g,{value:n.value,minLength:2,maxLength:16,className:y.formItem,label:"Company Name",placeholder:"enter company name...",required:!0,fullWidth:!0})}),e.jsx(p,{className:y.createSupplierFormItem,name:"nip",render:({field:n})=>e.jsx(g,{value:n.value,className:y.formItem,label:"NIP",placeholder:"enter NIP...",fullWidth:!0})}),e.jsx(p,{className:y.createSupplierFormItem,name:"customerCareEmail",render:({field:n})=>e.jsx(g,{value:n.value,className:y.formItem,label:"Customer Care Email",placeholder:"enter customer car email...",fullWidth:!0})}),e.jsx(p,{className:y.createSupplierFormItem,name:"countryId",render:({field:n})=>e.jsx(E,{items:a,selected:n.value,label:"Products country of origin",placeholder:"Select country...",hideFirstOption:!0,fullWidth:!0})})]})}function He({isLoading:i,isPhotoUploaderLoading:a,countryCodes:s,onAction:o}){const[l,n]=b.useState(null),[d,u]=b.useState(null),[t,r]=b.useState(null),[m,f]=b.useState(null),N=b.useRef(null);function H(c,h){n(h),G()}function O(c,h){u(h),G()}function J(){var D,U;const c=((D=N.current)==null?void 0:D.getSelectedFiles())||[],h=((U=N.current)==null?void 0:U.getUploadModels())||[],k={company:l.getValues(),address:d.getValues(),image:{images:c,uploadModels:h}};r(k),o("createCompany",k)}function Q(){var c;return i&&(t!=null&&t.images)?t.images:((c=N.current)==null?void 0:c.getSelectedFiles())||[]}function G(){if(!l||!d){f(!1);return}f(l.formState.isValid&&d.formState.isValid)}return e.jsxs(F,{className:L.createCompanyCard,title:"Create Company",showCloseButton:!0,isLoading:i,onSecondaryButtonClick:()=>o("closeCreateCompanyCard"),children:[e.jsxs("div",{className:L.createCompanyCardContent,children:[e.jsx(q,{countryCodes:S(s,{text:"countryName",value:"countryId",icon:"flagIcon"}),onChange:H}),a?e.jsx("div",{children:Q().map((c,h)=>{const k=c instanceof File?URL.createObjectURL(c):c.result||c.path;return e.jsx("div",{className:"overflow-hidden rounded-md bg-secondary p-0 shadow-sm",children:e.jsxs("div",{className:" flex relative items-center justify-between p-2 pl-4",children:[e.jsx("div",{children:e.jsx("img",{src:k,alt:`uploading-${c.name||`image-${h}`}`,onLoad:()=>{c instanceof File&&URL.revokeObjectURL(k)}})}),e.jsxs("div",{children:[e.jsx("p",{className:"truncate text-sm",children:c.name||`Image ${h+1}`}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((c.size||0)/(1024*1024)).toFixed(2)," MB"]})]}),e.jsx(Y,{})]})},c.name||h)})}):e.jsx(z,{isLoading:a,ref:N,contextName:"company",contextId:void 0,fullWidth:!0,hideUploadButton:!0}),e.jsx(ae,{countryList:S(s,{text:"countryName",value:"countryId",icon:"flagIcon"}),isCreate:!0,showFooter:!1,onChange:O,onSubmit:c=>o("createCompany",c),onCancel:()=>o("closeCreateCompanyCard")})]}),e.jsxs("div",{className:L.createCompanyCardButtonBlock,children:[e.jsx(v,{value:"Cancel",variant:"secondary",onClick:()=>o("closeCreateCompanyCard")}),e.jsx(v,{icon:T,value:"Create Company",variant:"info",disabled:!m,onClick:J})]})]})}const me="_companyConfigurationCard_1d57p_1",ue="_companyConfigurationCardContent_1d57p_1",pe="_imagesBlock_1d57p_6",he="_imagesBlockTitle_1d57p_11",xe="_imagesBlockGrid_1d57p_16",Ce="_imagesBlockGridItem_1d57p_21",ge="_locationsBlock_1d57p_36",ye="_locationsBlockTitle_1d57p_41",x={companyConfigurationCard:me,companyConfigurationCardContent:ue,imagesBlock:pe,imagesBlockTitle:he,imagesBlockGrid:xe,imagesBlockGridItem:Ce,locationsBlock:ge,locationsBlockTitle:ye};function ve({onAction:i}){return[{id:"name",header:"Locations",cell:({row:a})=>{var u,t;const s=(t=(u=a.original.photos)==null?void 0:u[0])==null?void 0:t.thumbnailUrl,o=a.original.name,l=a.original.addressLine1,n=a.original.addressLine2,d=a.original.countryName;return e.jsxs("div",{style:{display:"flex",alignItems:"center",flexGrow:1,gap:"6px",width:"100%"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",maxWidth:"50px",minWidth:"50px",maxHeight:"50px",borderRadius:"6px",overflow:"hidden"},children:s?e.jsx("img",{src:s,alt:o||"Supplier",style:{width:"100%"}}):e.jsx(P,{icon:M})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:[e.jsx(B,{delayDuration:200,text:o,className:"max-w-[190px] overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"she-text",children:o})}),l&&e.jsx(B,{delayDuration:200,text:l,className:"max-w-[190px] overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"she-subtext",children:l})}),n&&e.jsx(B,{delayDuration:200,text:n,className:"max-w-[190px] overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"she-subtext",children:n})}),d&&e.jsx(B,{delayDuration:200,text:d,className:"max-w-[190px] overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"she-subtext",children:d})})]})]})}},{id:"manage",header:"Actions",minSize:120,maxSize:120,cell:({row:a,table:s})=>{const o=s.options.meta,l=n=>{n.stopPropagation(),n.preventDefault(),i("openLocationConfigurationCard",a.original)};return e.jsx("div",{onClick:n=>n.stopPropagation(),children:e.jsx(v,{icon:Z,value:"Manage",variant:"secondary",onClick:l,disabled:o==null?void 0:o.isRowLoading(a.id)})})}}]}function Oe({isLoading:i,isGridLoading:a,countryCodes:s,company:o,onAction:l}){const n=Array.from({length:6},(t,r)=>{var m;return((m=o==null?void 0:o.photos)==null?void 0:m[r])||null});function d(t){const r=u(t),m=u(o);ee.isEqual(r,m)||l("updateCompany",t)}function u(t){return{companyName:(t==null?void 0:t.companyName)||"",countryId:(t==null?void 0:t.countryId)??null,customerCareEmail:(t==null?void 0:t.customerCareEmail)||null,nip:(t==null?void 0:t.nip)||null}}return e.jsx(F,{className:x.companyConfigurationCard,title:"Manage Company",showNotificationCard:!0,notificationCardProps:{title:"Delete Company",text:"The company will be deleted and it will no longer be available. The past purchases and labels will remain available.",onClick:()=>l("deleteCompany",o)},showCloseButton:!0,isLoading:i,onSecondaryButtonClick:()=>l("closeCompanyConfigurationCard"),children:e.jsxs("div",{className:x.companyConfigurationCardContent,children:[e.jsx(q,{data:o,countryCodes:S(s,{text:"countryName",value:"countryId",icon:"flagIcon"}),onChange:d}),e.jsxs("div",{className:x.imagesBlock,children:[e.jsxs("div",{className:x.imagesBlockTitle,children:[e.jsx("span",{className:"she-title",children:"Company Photos"}),e.jsx(v,{icon:V,variant:"secondary",value:"Manage Photos",onClick:()=>l("manageCompanyPhotos")})]}),e.jsx("div",{className:x.imagesBlock,children:e.jsx("div",{className:x.imagesBlockGrid,children:n.map((t,r)=>e.jsx("div",{className:x.imagesBlockGridItem,children:t?e.jsx("img",{src:t==null?void 0:t.thumbnailUrl,alt:`image-${r}`,className:"object-cover w-full h-full"}):e.jsx("div",{})},r))})}),e.jsxs("div",{className:x.locationsBlock,children:[e.jsxs("div",{className:x.locationsBlockTitle,children:[e.jsx("span",{className:"she-title",children:"Locations"}),e.jsx(v,{icon:T,variant:"secondary",value:"Add Location",onClick:()=>l("openLocationConfigurationCard")})]}),e.jsx("div",{children:e.jsx(A,{isLoading:a,showHeader:!1,columns:ve({onAction:l}),data:o==null?void 0:o.locations,customMessage:"No locations to display"})})]})]})]})})}const fe={},je="_locationForm_li62b_1",Ne="_locationFormImageBlock_li62b_8",_e="_imageBlockTitle_li62b_14",ke="_imagesBlockGrid_li62b_19",be="_imagesBlockGridItem_li62b_24",Ie="_image_li62b_14",Be="_cardFooter_li62b_59",j={locationForm:je,locationFormImageBlock:Ne,imageBlockTitle:_e,imagesBlockGrid:ke,imagesBlockGridItem:be,image:Ie,cardFooter:Be},I="field is required",Se=$({addressId:w().optional(),locationName:C().nonempty(I).min(2,"Min value length 2").max(50,"Max value length 50"),addressLine1:C().nonempty(I).min(5,"Min value length 5").max(100,"Max value length 100"),addressLine2:C().max(100,"Max value length 100").optional(),city:C().nonempty(I).min(2,"Min value length 2").max(50,"Max value length 50"),state:C().nonempty(I).min(2,"Min value length 2").max(50,"Max value length 50"),postCode:C().nonempty(I).min(3,"Min value length 3").max(10,"Max value length 10"),countryId:w().min(1,"Country is required")}),Fe={addressLine1:void 0,addressLine2:void 0,city:void 0,state:void 0,postCode:void 0,countryId:void 0,countryName:void 0,lat:void 0,locationId:void 0,locationName:void 0,long:void 0,address:void 0};function Le({isLoading:i,data:a,countryCodes:s,onChange:o,onSubmit:l,onCancel:n,onAction:d}){const{form:u}=W({values:a,defaultValues:Fe,scheme:Se}),t=Array.from({length:6},(r,m)=>{var f;return((f=a==null?void 0:a.photos)==null?void 0:f[m])||null});return e.jsxs(K,{isLoading:i,className:j.locationForm,form:u,hidePrimaryBtn:!!(a!=null&&a.locationId),hideSecondaryBtn:!!(a!=null&&a.locationId),footerClassName:j.cardFooter,primaryBtnTitle:"Create Location",primaryBtnProps:{icon:T,variant:"info"},onChange:o,onSubmit:l,onCancel:n,children:[e.jsx(p,{name:"locationName",render:({field:r})=>e.jsx(g,{value:r.value,label:"Location Name",placeholder:"enter location name...",fullWidth:!0})}),e.jsxs("div",{className:j.locationFormImageBlock,children:[e.jsxs("div",{className:j.imageBlockTitle,children:[e.jsx("span",{className:"she-title",children:"Location Photos"}),e.jsx(v,{value:"Manage Photos",icon:V,variant:"secondary",onClick:()=>d("manageLocationPhotos")})]}),e.jsx("div",{className:j.imagesBlockGrid,children:t.map((r,m)=>e.jsx("div",{className:j.imagesBlockGridItem,children:r?e.jsx("img",{src:r.thumbnailUrl,alt:`image-${m}`,className:j.image}):e.jsx("div",{})},m))})]}),e.jsx(p,{name:"addressLine1",render:({field:r})=>e.jsx(g,{value:r.value,label:"Address Line 1",labelTransKey:"AddressForm.Labels.AddressLine1",placeholder:"Enter address line 1...",placeholderTransKey:"AddressForm.Placeholders.AddressLine1",fullWidth:!0})}),e.jsx(p,{name:"addressLine2",render:({field:r})=>e.jsx(g,{value:r.value,label:"Address Line 2",labelTransKey:"AddressForm.Labels.AddressLine2",placeholder:"Enter address line 2...",placeholderTransKey:"AddressForm.Placeholders.AddressLine2",fullWidth:!0})}),e.jsx(p,{name:"city",render:({field:r})=>e.jsx(g,{value:r.value,label:"City",labelTransKey:"AddressForm.Labels.City",placeholder:"Enter city...",placeholderTransKey:"AddressForm.Placeholders.City",fullWidth:!0})}),e.jsx(p,{name:"state",render:({field:r})=>e.jsx(g,{value:r.value,label:"State",labelTransKey:"AddressForm.Labels.State",placeholder:"Enter state...",placeholderTransKey:"AddressForm.Placeholders.State",fullWidth:!0})}),e.jsx(p,{name:"postCode",render:({field:r})=>e.jsx(g,{value:r.value,label:"Postal Code",labelTransKey:"AddressForm.Labels.PostalCode",placeholder:"Enter postal code...",placeholderTransKey:"AddressForm.Placeholders.PostalCode",fullWidth:!0})}),e.jsx(p,{name:"countryId",render:({field:r})=>e.jsx(E,{selected:r.value,items:s,label:"Country",labelTransKey:"AddressForm.Labels.Country",placeholder:"Choose country...",placeholderTransKey:"AddressForm.Placeholders.Country",hideFirstOption:!0,fullWidth:!0})})]})}function Je({isLoading:i,countryCodes:a,location:s,onAction:o}){return e.jsx(F,{className:fe.locationConfigurationCard,title:s!=null&&s.locationId?"Manage Location":"Create Location",isLoading:i,showNotificationCard:!!(s!=null&&s.locationId),notificationCardProps:{title:"Delete Location",text:"The location will be deleted and will no longer appear on new labels. The current labels will require an update to replace deleted location.",onClick:()=>o("deleteLocation",s)},showCloseButton:!0,onHeaderCloseClick:()=>o("closeLocationConfigurationCard"),children:e.jsx(Le,{isLoading:i,data:s,countryCodes:S(a,{text:"countryName",value:"countryId",icon:"flagIcon"}),onChange:l=>o("updateLocation",l),onSubmit:l=>o("createLocation",l),onAction:o})})}const we="_photosCard_1f0z5_1",Pe="_photosCardContent_1f0z5_1",Te="_managePhotosBlock_1f0z5_6",_={photosCard:we,photosCardContent:Pe,managePhotosBlock:Te};function Qe({isLoading:i,isImageUploaderLoading:a,isGridLoading:s,data:o,contextId:l,contextName:n,columns:d,noDataText:u,skeletonQuantity:t,showCloseButton:r,onAction:m}){const{translate:f}=oe();return e.jsx(F,{className:_.photosCard,title:`${n} Photos`,isLoading:i,showCloseButton:r,onSecondaryButtonClick:()=>m("closePhotosCard",n),children:e.jsxs("div",{className:_.photosCardContent,children:[e.jsx(z,{isLoading:a,contextName:n,contextId:l,onUpload:N=>m("uploadPhoto",N)}),e.jsxs("div",{className:_.managePhotosBlock,children:[e.jsx("div",{className:`${_.managePhotosTitle} she-title`,children:f("CardTitles.ManagePhotos")}),e.jsx("div",{className:_.managePhotosGrid,children:e.jsx(A,{isLoading:s,className:_.photosGrid,enableDnd:!0,showHeader:!1,columns:d,data:o,skeletonQuantity:t,customMessage:u,onAction:m})})]})]})})}function Xe({onAction:i}){return[{accessorKey:"thumbnailUrl",header:"Preview",minSize:80,maxSize:80,cell:({row:a})=>{const s=a.getValue("thumbnailUrl");return e.jsx("div",{className:"relative w-12 h-12 cursor-pointer",onClick:()=>i("image",a),children:s?e.jsx("img",{src:s,alt:"Company",className:"object-cover rounded-md w-full h-full",style:{width:"48px",height:"48px"}}):e.jsx("div",{style:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(P,{icon:M,maxWidth:"30px"})})})}},{accessorKey:"format",header:"Format",minSize:190,cell:({row:a})=>e.jsx("span",{className:"she-subtext",children:`${a.original.height}px x ${a.original.width}px`})},{id:"rowActions",header:"Actions",minSize:80,maxSize:80,cell:({row:a})=>e.jsx(v,{icon:R,variant:"secondary",onClick:()=>i("deleteCompanyPhoto",a.original)})}]}function Ye({onAction:i}){return[{accessorKey:"thumbnailUrl",header:"Preview",minSize:80,maxSize:80,cell:({row:a})=>{const s=a.getValue("thumbnailUrl");return e.jsx("div",{className:"relative w-12 h-12 cursor-pointer",onClick:()=>i("image",a),children:s?e.jsx("img",{src:s,alt:"Company",className:"object-cover rounded-md w-full h-full",style:{width:"48px",height:"48px"}}):e.jsx("div",{style:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(P,{icon:M,maxWidth:"30px"})})})}},{accessorKey:"format",header:"Format",minSize:190,cell:({row:a})=>e.jsx("span",{className:"she-subtext",children:`${a.original.height}px x ${a.original.width}px`})},{id:"rowActions",header:"Actions",minSize:80,maxSize:80,cell:({row:a})=>e.jsx(v,{icon:R,variant:"secondary",onClick:()=>i("deleteLocationPhoto",a.original)})}]}export{He as C,Je as L,Xe as M,Qe as P,Oe as a,Ye as b};
