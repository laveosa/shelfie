import{j as s,y as oa,z as na,i as B,B as sa,E as J,r as A,n as E,m as W,D as ia,X as da,C as ca,u as le,S as _,b as ua,p as la,q as pa,o as Se,s as w,G as L,A as pe,H as $,I as k,c as X,J as a,_ as ma,v as Z,K as ee,N as me,L as he,Q as U,h as ha,d as te}from"./index-Cw1axte0.js";import{G as Ca,a as fa}from"./GridSortingEnum-Qa64oiYF.js";import{u as ga}from"./useCardActions-SfLCBXO2.js";import{G as Ce}from"./GridTraitsFilter-DziKiDuq.js";import{G as fe}from"./GridItemsFilter-Dwrr0F_A.js";import{S as xe}from"./SheCard-aSRRE8J-.js";import{S as Le}from"./SheGrid-En_vYHu8.js";import{E as ya,c as Pa,S as Ia}from"./SheContextSidebar-B80ytWA5.js";import{S as oe,R as Sa}from"./SheInput-CRh_9A_6.js";import{I as ve,u as ke}from"./useAppTranslation-C0plkqGJ.js";import{P as Ve}from"./settings-2-D0TSVohS.js";import{o as xa,b as ge,u as La,S as va,a as ae}from"./types-D_x_05Po.js";import{C as ka}from"./ComponentViewEnum-Ba6F4129.js";import{T as Va}from"./SheCardNotification-BO0xFGAj.js";import{c as re}from"./ProductsInOrderGridColumns.module-DQJajK5A.js";import{u as Ga}from"./useToast-C-IbJ-Pz.js";import{u as Ha}from"./useOrdersPageService-D0ApQjV1.js";import{u as ba}from"./chevron-up-B1noOLu8.js";import{V as Ma,A as ja,S as Oa,D as Na,a as Ta,M as Da,b as Ra}from"./VariantPhotosCard-BrJ71loE.js";import{S as Fa,C as Aa}from"./CompaniesListGridColumns-DBkn8i9a.js";import{S as _a}from"./SelectEntityCard-xAoyDKcz.js";import{C as qa,a as Ea,P as ye,M as Ba,L as za,b as wa}from"./ManageLocationPhotosGridColumns-1jU6bSlC.js";import"./trash-CCSUe94n.js";import"./SheSelect-p3B5lCDb.js";import"./select-C6XQeQRZ.js";import"./form-CC68foBk.js";import"./SheForm-mDaWkZNw.js";import"./she-select-convertors-CdG-Ygpu.js";import"./SheDatePicker-C7cDxQZl.js";import"./SheFileUploader-DROJL0Q-.js";import"./placeholder-image-BgG3Yd5d.js";import"./SheTextarea-BfGK35SK.js";import"./AddressForm-Jvn75SWk.js";const $a="_orderProductsPage_17jge_1",Ua="_findProductsCard_17jge_1",Pe={orderProductsPage:$a,findProductsCard:Ua},Wa="_findProductsCard_12xpd_1",Ie={findProductsCard:Wa},Qa="_productNameImageBlock_13d5h_1",Ka="_productNameImage_13d5h_1",Ya="_variantName_13d5h_8",Ja="_variantCode_13d5h_8",Xa="_productCategory_13d5h_17",F={productNameImageBlock:Qa,productNameImage:Ka,variantName:Ya,variantCode:Ja,productCategory:Xa};function Za({row:l,onAction:c}){return s.jsxs(oa,{children:[s.jsx(na,{asChild:!0,children:s.jsxs(B,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[s.jsx(ya,{}),s.jsx("span",{className:"sr-only",children:"Open menu"})]})}),s.jsxs(sa,{align:"start",className:"w-[160px]",children:[s.jsx(J,{onClick:()=>c("manageProduct",l.original),children:"Manage product"}),s.jsx(J,{onClick:()=>c("manageVariant",l.original),children:"Manage variant"}),s.jsx(J,{onClick:()=>c("openAddStockCard",l.original),children:"Add to stock"})]})]})}function er({row:l}){const[c,o]=A.useState(1);return l.original.amount=c,s.jsx(oe,{value:"1",onChange:d=>{o(Number(d)),l.original.amount=d}})}function tr({onAction:l}){return[{accessorKey:"variantCode",header:"Code",minSize:70,maxSize:70,cell:({row:c})=>s.jsx(E,{delayDuration:200,text:c.getValue("variantCode"),children:s.jsx("span",{className:F.variantCode,children:c.getValue("variantCode")})})},{accessorKey:"photo",header:"Image",minSize:80,maxSize:80,cell:({row:c})=>{const o=c.getValue("photo");return s.jsx("div",{className:F.productNameImageBlock,children:o?s.jsx("img",{src:o==null?void 0:o.thumbnailUrl,alt:c.getValue("variantName"),className:F.productNameImage}):s.jsx(W,{icon:ve,maxWidth:"30px"})})}},{accessorKey:"variantName",header:"Product Name",minSize:150,cell:({row:c})=>s.jsx(E,{delayDuration:200,text:c.getValue("variantName"),children:s.jsx("span",{className:F.variantName,children:c.getValue("variantName")})})},{accessorKey:"productCategory",header:"Category",minSize:100,cell:({row:c})=>{var d,C;const o=c.getValue("productCategory");return s.jsx(E,{delayDuration:200,text:(o==null?void 0:o.categoryName)||"N/A",children:s.jsxs("div",{className:F.productCategory,children:[((d=c.original.productCategory)==null?void 0:d.thumbnail)&&s.jsx("img",{src:(C=c.original.productCategory)==null?void 0:C.thumbnail,alt:c.original.productCategory.categoryName}),s.jsx("span",{children:(o==null?void 0:o.categoryName)||"N/A"})]})})}},{accessorKey:"brand",header:"Brand",minSize:100,cell:({row:c})=>{var d,C;const o=c.getValue("brand");return s.jsx(E,{delayDuration:200,text:(o==null?void 0:o.brandName)||"N/A",children:s.jsxs("div",{className:F.productCategory,children:[((d=c.original.brand)==null?void 0:d.thumbnail)&&s.jsx("img",{src:(C=c.original.brand)==null?void 0:C.thumbnail,alt:c.original.brand.brandName}),s.jsx("span",{children:(o==null?void 0:o.brandName)||"N/A"})]})})}},{accessorKey:"traitOptions",header:"Details",minSize:100,maxSize:100,cell:({row:c})=>{const o=c.original.traitOptions||[],d=o.filter(e=>e.traitTypeId===2&&e.optionColor),C=o.filter(e=>e.traitTypeId===1&&e.optionName);return s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",maxWidth:"50px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"middle"},children:[d.map((e,n)=>s.jsx("div",{style:{background:e.optionColor,minWidth:"20px",minHeight:"20px",borderRadius:"50%",border:"2px solid #ccc"}},`color-${n}`)),C.map((e,n)=>s.jsx("span",{style:{fontSize:"0.875rem"},children:e.optionName},`size-${n}`))]})}},{accessorKey:"stockAmount",header:"In Stock",minSize:100,maxSize:100,cell:({row:c})=>s.jsx("span",{children:`${c.getValue("stockAmount")} units`})},{accessorKey:"salePrice",header:"Price",minSize:120,maxSize:120,cell:({row:c})=>{const o=c.getValue("salePrice");return s.jsx("span",{children:o||"N/A"})}},{accessorKey:"quantity",header:"Quantity",size:100,minSize:100,maxSize:100,cell:({row:c})=>s.jsx(er,{row:c})},{id:"add",header:"",minSize:100,maxSize:100,cell:({row:c})=>s.jsx("div",{onClick:o=>o.stopPropagation(),children:s.jsx(B,{icon:Ve,value:"Add",variant:"secondary",onClick:()=>l("addVariantToOrder",c.original)})})},{id:"rowActions",header:"",minSize:70,maxSize:70,cell:({row:c,table:o})=>s.jsx(Za,{row:c,onAction:l,table:o})}]}function ar({isLoading:l,isGridLoading:c,variants:o,preferences:d,gridRequestModel:C,sortingOptions:e,colorsForFilter:n,sizesForFilter:P,categories:y,brands:f,onAction:g}){var v,G;const{translate:I}=ke();return s.jsx(xe,{className:Ie.findProductsCard,title:I("CardTitles.FindProducts"),isLoading:l,showCloseButton:!0,onSecondaryButtonClick:()=>g("closeFindProductsCard"),children:s.jsx("div",{className:Ie.findProductsCardContent,children:s.jsxs(Le,{isLoading:c,columns:tr({onAction:g}),data:o,gridRequestModel:C,sortingItems:e,columnsPreferences:d,preferenceContext:"variantReferences",skeletonQuantity:C.pageSize,onApplyColumns:()=>g("onApplyColumns"),onDefaultColumns:()=>g("onResetColumnsHandler"),onGridRequestChange:x=>g("variantsGridRequestChange",x),children:[s.jsx(fe,{items:f,columnName:I("SectionTitles.Brand"),getId:x=>x.brandId,getName:x=>x.brandName,selected:(v=C.filter)==null?void 0:v.brands}),s.jsx(fe,{items:y,columnName:I("SectionTitles.Category"),getId:x=>x.categoryId,getName:x=>x.categoryName,selected:(G=C.filter)==null?void 0:G.categories}),s.jsx(Ce,{traitOptions:n,traitType:"color"}),s.jsx(Ce,{traitOptions:P,traitType:"size"})]})})})}const rr="_productsInOrderCard_hp3sv_1",or="_productsInOrderCardContent_hp3sv_1",nr="_addProductBlock_hp3sv_6",sr="_productsSummaryBlock_hp3sv_15",ir="_productsSummary_hp3sv_15",dr="_productsSummaryTitle_hp3sv_24",cr="_productsSummaryTextBlock_hp3sv_28",ur="_productsSummaryText_hp3sv_28",j={productsInOrderCard:rr,productsInOrderCardContent:or,addProductBlock:nr,productsSummaryBlock:sr,productsSummary:ir,productsSummaryTitle:dr,productsSummaryTextBlock:cr,productsSummaryText:ur},lr="_productsInOrderForm_6tg5u_1",pr="_formItems_6tg5u_4",mr="_formItem_6tg5u_4",hr="_inputFormItem_6tg5u_14",Cr="_totalValue_6tg5u_17",fr="_formIcon_6tg5u_21",V={productsInOrderForm:lr,formItems:pr,formItem:mr,inputFormItem:hr,totalValue:Cr,formIcon:fr},gr=xa({priceBrutto:ge(),quantity:ge()});function yr({className:l,data:c,onSubmit:o,onDelete:d}){const{form:C}=La({values:n(c),defaultValues:{stockDocumentPrice:{brutto:0},unitsAmount:0,total:0},scheme:gr,mode:Sa.CHANGE});function e(P){o({brutto:Number(P.stockDocumentPrice.brutto),unitsAmount:Number(P.unitsAmount)})}function n(P){var I;const y=Number((I=P.stockDocumentPrice)==null?void 0:I.brutto)||0,f=Number(P.unitsAmount)||0,g=y*f;return{stockDocumentPrice:{brutto:y},unitsAmount:f,total:g}}return s.jsx("div",{className:`${V.productsInOrderForm} ${l}`,children:s.jsx(va,{form:C,formPosition:ia.CENTER,view:ka.STANDARD,fullWidth:!0,hidePrimaryBtn:!0,hideSecondaryBtn:!0,onSubmit:e,children:s.jsxs("div",{className:V.formItems,children:[s.jsxs("div",{className:V.formItem,children:[s.jsx("span",{children:"Price Brutto"}),s.jsx(ae,{name:"stockDocumentPrice.brutto",className:V.inputFormItem,render:({field:P})=>s.jsx(oe,{value:P.value,type:"number",step:2,maxWidth:"90px",minWidth:"90px",onDelay:()=>{e(C.getValues())}})})]}),s.jsx(W,{className:V.formIcon,icon:da,maxWidth:"30px"}),s.jsxs("div",{className:V.formItem,children:[s.jsx("span",{children:"Quantity"}),s.jsx(ae,{name:"unitsAmount",className:V.inputFormItem,render:({field:P})=>s.jsx(oe,{value:P.value,type:"number",maxWidth:"70px",minWidth:"70",onDelay:()=>{e(C.getValues())}})})]}),s.jsx(W,{className:V.formIcon,icon:Pa,maxWidth:"30px"}),s.jsxs("div",{className:V.formItem,children:[s.jsx("span",{children:"Total"}),s.jsx(ae,{name:"total",render:({field:P})=>{var y;return s.jsx("span",{className:`${V.totalValue} she-title`,children:`${P.value.toFixed(2)} ${((y=c==null?void 0:c.stockDocumentPrice)==null?void 0:y.currencyName)??""}`})}})]}),s.jsxs("div",{className:V.formItem,children:[s.jsx("span",{children:"Remove"}),s.jsx(B,{icon:Va,variant:"secondary",type:"button",onClick:()=>d()})]})]})})})}function Pr({onAction:l}){return[{id:"variantName",accessorFn:c=>c.variantName,header:"Product",minSize:100,cell:({row:c})=>{var d;const o=(d=c.original.photo)==null?void 0:d.thumbnailUrl;return s.jsxs("div",{className:re.productNameWrapper,children:[s.jsx("div",{className:re.productNameImageBlock,children:o?s.jsx("img",{src:o,alt:c.original.variantName||"Variant",className:re.productNameImage}):s.jsx(W,{icon:ve,maxWidth:"30px"})}),s.jsx("div",{children:s.jsx(E,{delayDuration:200,text:c.getValue("variantName"),className:"max-w-[100px] overflow-hidden text-ellipsis whitespace-nowrap",children:s.jsx("span",{children:c.getValue("variantName")})})})]})}},{accessorKey:"traitOptions",header:"Traits",minSize:100,cell:({row:c})=>{const o=c.original.traitOptions||[],d=o.filter(e=>e.traitTypeId===2&&e.optionColor),C=o.filter(e=>e.traitTypeId===1&&e.optionName);return s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",maxWidth:"50px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"middle"},children:[d.map((e,n)=>s.jsx("div",{style:{background:e.optionColor,minWidth:"20px",minHeight:"20px",borderRadius:"50%",border:"2px solid #ccc"}},`color-${n}`)),C.map((e,n)=>s.jsx("span",{style:{fontSize:"0.875rem"},children:e.optionName},`size-${n}`))]})}},{id:"actions",header:"Actions",minSize:160,maxSize:160,cell:({row:c})=>s.jsx("div",{onClick:o=>o.stopPropagation(),children:s.jsx(B,{icon:ca,value:"Manage Variant",variant:"secondary",onClick:()=>l("manageVariant",c.original)})})}]}function Ir({isLoading:l,isGridLoading:c,stockActions:o,onAction:d}){const[C,e]=A.useState(null),[n,P]=A.useState({total:0,currency:""}),{translate:y}=ke();A.useEffect(()=>{o&&e(o.map(g=>{var I;return{...g,id:g.variantId,expandableRows:((I=g.variantStockActions)==null?void 0:I.length)>0?g.variantStockActions:[{brutto:null,unitsAmount:null}]}}))},[o]),A.useEffect(()=>{if(!(C!=null&&C.length)){P({total:0,currency:""});return}const g=C.reduce((I,v)=>{var H,T;const G=Number((H=v.stockDocumentPrice)==null?void 0:H.brutto)||0,x=Number(v.unitsAmount)||0,O=((T=v.stockDocumentPrice)==null?void 0:T.currencyName)||I.currency;return{total:I.total+G*x,currency:O}},{total:0,currency:""});P(g)},[C]);function f(g){return s.jsx(yr,{data:g.original,onSubmit:I=>d("updateStockAction",{formData:I,row:g}),onDelete:()=>d("removeStockAction",g)})}return s.jsx(xe,{className:j.productsInOrderCard,title:"Products in order",titleTransKey:"CardTitles.ProductsInOrder",maxWidth:"485px",minWidth:"485px",isLoading:l,children:s.jsxs("div",{className:j.productsInOrderCardContent,children:[s.jsxs("div",{className:j.addProductBlock,children:[s.jsx("span",{className:"she-text",children:y("OrderMessages.NoOrderCompleteWithoutProduct")}),s.jsx(B,{value:"Add Product",valueTransKey:"OrderActions.AddProduct",icon:Ve,variant:"secondary",onClick:()=>d("addProduct")})]}),s.jsx(Le,{isLoading:c,showHeader:!1,columns:Pr({onAction:d}),data:C,skeletonQuantity:10,enableExpansion:!0,renderExpandedContent:f},C==null?void 0:C.length),s.jsx("div",{className:j.productsSummaryBlock,children:s.jsxs("div",{className:j.productsSummary,children:[s.jsx("span",{className:j.productsSummaryTitle,children:"Summary"}),s.jsxs("div",{className:j.productsSummaryTextBlock,children:[s.jsx("span",{className:`${j.productsSummaryText} she-text`,children:y("OrderForm.Labels.ProductsTotal")}),s.jsxs("span",{className:`${j.productsSummaryText} she-text`,children:[n.total.toFixed(2)||0,n.currency]})]})]})})]})})}function Sr(l,c){const o=le(t=>t[_.ORDER_PRODUCTS]),d=le(t=>t[_.ORDERS]),C=Ha(),e=ua(),{addToast:n}=Ga(),P=la(),{openConfirmationDialog:y}=pa(),{t:f}=ba(),{orderId:g}=Se(),[I]=w.useAddVariantsToOrderMutation(),[v]=w.useUpdateStockActionInOrderMutation(),[G]=w.useRemoveStockActionFromOrderMutation(),[x]=L.useLazyGenerateProductCodeQuery(),[O]=pe.useDeletePhotoMutation(),[H]=$.useGetListOfPurchasesForGridMutation(),[T]=$.useAddVariantToPurchaseProductsMutation(),[N]=$.useLazyGetPurchaseDetailsQuery(),[m]=$.useCreatePurchaseForSupplierMutation(),[b]=k.useGetListOfCompaniesForGridMutation(),[Ge]=k.useCreateCompanyMutation(),[Q]=pe.useUploadPhotoMutation(),[He]=k.useAddNewLocationToCompanyMutation(),[ne]=X.useLazyGetCountryCodeQuery(),[R]=k.useLazyGetCompanyDetailsQuery(),[be]=k.useDeleteCompanyMutation(),[Me]=k.useAddLocationToCompanyMutation(),[je]=L.useLazyGetVariantDetailsQuery(),[Oe]=L.useLazyGetListOfTraitsWithOptionsForProductQuery(),[Ne]=X.useLazyGetTaxesListQuery(),[Te]=L.useLazyGetProductPhotosForVariantQuery(),[De]=L.useUpdateVariantDetailsMutation(),[Re]=L.useUpdateVariantTraitOptionsMutation(),[Fe]=L.useDeleteVariantMutation(),[Ae]=L.useDisposeVariantFromStockMutation(),[_e]=L.useAttachProductPhotoToVariantMutation(),[qe]=L.useDetachVariantPhotoMutation(),[Ee]=L.useChangePhotoPositionForVariantMutation(),[Be]=X.useLazyGetCurrenciesListQuery(),[ze]=L.useLazyGetVariantStockHistoryQuery(),[we]=k.useUpdateCompanyDetailsMutation(),[$e]=k.useChangePositionOfCompanyPhotoMutation(),[Ue]=k.useChangePositionOfLocationPhotoMutation(),[We]=k.useUpdateLocationDetailsMutation(),[Qe]=k.useDeleteLocationMutation(),[Ke]=w.useGetListOfStockActionsForGridMutation();function q(t){e(a.setIsProductsInOrderGridLoading(!0)),Ke({orderId:t,model:o.stockActionsGridRequestModel}).then(r=>{var i;e(a.setIsProductsInOrderGridLoading(!1)),(i=r==null?void 0:r.data)!=null&&i.items&&e(a.refreshStockActionsGridRequestModel({...r.data,items:r.data.items.map(u=>{var p,h,S,M;return{...u,stockItemPrice:((p=u.stockDocumentPrice)==null?void 0:p.brutto)!==null&&((h=u.stockDocumentPrice)==null?void 0:h.brutto)!==void 0&&((S=u.stockDocumentPrice)!=null&&S.currencyName)?`${u.stockDocumentPrice.brutto}${u.stockDocumentPrice.currencyName}`:"0"+(((M=u.stockDocumentPrice)==null?void 0:M.currencyName)||"")}})}))})}function se(t){e(a.setIsFindProductsGridLoading(!0)),C.getVariantsForGridHandler(t).then(r=>{e(a.setIsFindProductsGridLoading(!1)),e(Z.refreshVariantsGridRequestModel(r.data))})}function Ye(t){d.brands.length===0&&C.getBrandsForFilterHandler(),d.categories.length===0&&C.getCategoriesForFilterHandler(),(d.sizesForFilter.length===0||d.colorsForFilter.length===0)&&C.getTraitsForFilterHandler(),se(t)}function Je(t,r){var p;const i=ma.cloneDeep(r),u=(p=o.stockActionsGridRequestModel.items)==null?void 0:p.find(h=>h.variantId===i.variantId&&h.stockItemPrice===(i==null?void 0:i.salePrice)?h:void 0);if(u)ie(u.stockActionId,{unitsAmount:u.unitsAmount+i.amount,brutto:u.stockDocumentPrice.brutto});else return I({orderId:t,model:{variantId:i.variantId,amount:i.amount}}).then(h=>(h.error?n({text:`${h.error.data.detail}`,type:"error"}):(e(Z.refreshVariantsGridRequestModel({...d.variantsGridRequestModel,items:d.variantsGridRequestModel.items.map(S=>{if(S.variantId==i.variantId){const M=Number(S.stockAmount)-Number(i.amount);return{...S,stockAmount:M}}return S})})),e(a.refreshStockActionsGridRequestModel({...o.stockActionsGridRequestModel,items:[h.data,...o.stockActionsGridRequestModel.items]})),n({text:"Stock action added successfully",type:"success"})),h.data))}function Xe(t){se(t)}function ie(t,r){return v({stockActionId:t,model:r}).then(i=>(i.error?(e(a.refreshStockActionsGridRequestModel({...o.stockActionsGridRequestModel,items:[...o.stockActionsGridRequestModel.items]})),n({text:`${i.error.data.detail}`,type:"error"})):(e(a.refreshStockActionsGridRequestModel({...o.stockActionsGridRequestModel,items:o.stockActionsGridRequestModel.items.map(u=>u.stockActionId===t?{...u,unitsAmount:r.unitsAmount,stockDocumentPrice:{...u.stockDocumentPrice,brutto:r.brutto}}:u)})),n({text:"Stock action updated successfully",type:"success"})),i.data))}function Ze(t){return G(t.stockActionId).then(r=>(r.error?n({text:`${r.error.data.detail}`,type:"error"}):(e(a.refreshStockActionsGridRequestModel({...o.stockActionsGridRequestModel,items:o.stockActionsGridRequestModel.items.filter(i=>i.stockActionId!==t.stockActionId)})),e(Z.refreshVariantsGridRequestModel({...d.variantsGridRequestModel,items:d.variantsGridRequestModel.items.map(i=>{if(i.variantId==t.variantId){const u=Number(i.stockAmount)+Number(t.unitsAmount);return{...i,stockAmount:u}}return i})})),n({text:"Stock action deleted successfully",type:"success"})),r.data))}function et(t){e(ee.refreshActiveTab("products")),P(`${me.PRODUCTS}${me.PRODUCT_BASIC_DATA}/${t.productId}`)}function tt(){return x(null).then(t=>t.data)}function at(t){return O(t).then(r=>r.data)}function D(t){return je(t).then(r=>(e(a.refreshProductId(r.data.productId)),{...r.data,traitOptions:he(r.data.traitOptions,"color",[{field:"isRemoved",value:!0,color:U.ERROR},{field:"isMissing",value:!0,color:U.ERROR}])}))}function de(t){return Oe(t).then(r=>(e(a.refreshListOfTraitsWithOptionsForProduct(r.data)),r.data))}function K(){o.taxesList.length||Ne(void 0).then(t=>{e(a.refreshTaxesList(t.data))})}function rt(t,r){return qe({id:t,photoId:r}).then(i=>i)}function ce(t,r){return Te({productId:t,variantId:r}).then(i=>i.data)}function ot(t,r){return Re({id:t,model:r}).then(i=>i)}function nt(t){c({findProductsCard:!1,variantConfigurationCard:!0}),e(a.setIsVariantConfigurationCardLoading(!0)),e(a.setIsVariantOptionsGridLoading(!0)),e(a.setIsVariantPhotoGridLoading(!0)),o.activeCards.includes("variantPhotosCard")&&(e(a.setIsProductPhotoGridLoading(!0)),ce(o.productId,t.variantId).then(r=>{e(a.setIsProductPhotoGridLoading(!1)),e(a.refreshProductPhotosForVariant(r))})),K(),D(t.variantId).then(r=>{e(a.setIsVariantConfigurationCardLoading(!1)),e(a.setIsVariantOptionsGridLoading(!1)),e(a.setIsVariantPhotoGridLoading(!1)),r?(e(a.refreshSelectedVariant(r)),e(a.refreshVariantPhotos(r==null?void 0:r.photos))):(n({text:"Variant not found",type:"error"}),l("variantConfigurationCard"))})}function st(t){De({id:t.variant.variantId,model:t.formattedData}).then(r=>{var i;if(r){const u={...r.data,traitOptions:he((i=r.data)==null?void 0:i.traitOptions,"color",[{field:"isRemoved",value:!0,color:U.ERROR},{field:"isMissing",value:!0,color:U.ERROR}])};e(a.refreshSelectedVariant(u)),n({text:"Variant updated successfully",type:"success"})}else n({text:"Variant not updated",description:r.error.message,type:"error"})})}function it(t){l("manageTraitsCard"),e(a.setIsManageTraitsCardLoading(!0)),ot(t.variant.variantId,t.submissionData).then(r=>{e(a.setIsManageTraitsCardLoading(!1)),r.error?n({text:"Variant trait options not updated",description:r.error.message,type:"error"}):(D(t.variant.variantId).then(i=>{e(a.refreshSelectedVariant(i))}),n({text:"Variant trait options updated successfully",type:"success"}))})}function dt(t,r){return Ae({id:t,model:r}).then(i=>i.data)}function ct(t,r){return _e({variantId:t,photoId:r}).then(i=>i)}function ue(t,r,i){return Ee({id:t,photoId:r,index:i}).then(u=>u.data)}async function ut(t){if(await y({headerTitle:"Delete Variant",text:`You are about to delete variant "${t.variantName}".`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"}))await Fe(t.variantId).then(i=>{i.error?n({text:i.error.data.detail,type:"error"}):(l("variantConfigurationCard"),n({text:"Variant deleted successfully",type:"success"}))});else return}function lt(t){e(a.setIsAddStockCardLoading(!0)),T({id:t.purchaseId,model:t.priceModel}).then(r=>{e(a.setIsAddStockCardLoading(!1)),D(t.priceModel.variantId).then(i=>{i&&e(a.refreshSelectedVariant(i))}),N(t.purchaseId).then(i=>{e(a.refreshSelectedPurchase(i.data))}),r?(l("addStockCard"),n({text:"Stock increased successfully",type:"success"})):n({text:"Stock not increased",description:r.error.message,type:"error"})})}function pt(t){e(a.setIsDisposeStockCardLoading(!0)),dt(t.variant.variantId,t.formattedData).then(()=>{e(a.setIsDisposeStockCardLoading(!1)),D(t.variant.variantId).then(r=>{e(a.refreshSelectedVariant(r))}),n({text:"Variant disposed successfully",type:"success"})})}function mt(t){e(a.setIsVariantPhotosCardLoading(!0)),Q(t).then(r=>{e(a.setIsVariantPhotosCardLoading(!1)),r.error?n({text:"Photo not uploaded",description:r.error.message,type:"error"}):(e(a.refreshVariantPhotos([...o.variantPhotos,r.data])),e(a.refreshSelectedVariant({...o.selectedVariant,photos:[...o.selectedVariant.photos,r.data]})),o.variantPhotos.length===0&&q(g),n({text:"Photo uploaded successfully",type:"success"}))})}function ht(t){ct(o.selectedVariant.variantId,t.photoId).then(r=>{if(e(a.setIsVariantPhotosCardLoading(!1)),r.error)n({text:"Can`t attach photo to variant",type:"error"});else{const i=o.productPhotosForVariant.find(u=>u.photoId===t.photoId);if(i){const u=o.variantPhotos??[],p=u.some(h=>h.photoId===i.photoId)?u:[...u,i];e(a.refreshVariantPhotos(p)),e(a.refreshProductPhotosForVariant(o.productPhotosForVariant.filter(h=>h.photoId!==t.photoId)))}o.variantPhotos.length===0&&q(g),n({text:"Photo added to variant successfully",type:"success"})}})}async function Ct(t){await y({headerTitle:"Detach photo from variant",text:`You are about to detach photo from variant  "${o.selectedVariant.variantName}".`,primaryButtonValue:"Detach",secondaryButtonValue:"Cancel"})&&await rt(o.selectedVariant.variantId,t.photoId).then(i=>{if(i.error)n({text:"Photo not added to variant",description:i.error.message,type:"error"});else{const u=o.variantPhotos??[],p=u.find(h=>h.photoId===t.photoId);if(p){const h=o.productPhotosForVariant??[],S=h.some(Y=>Y.photoId===p.photoId)?h:[...h,p];e(a.refreshProductPhotosForVariant(S));const M=u.filter(Y=>Y.photoId!==t.photoId);e(a.refreshVariantPhotos(M))}o.variantPhotos.length===1&&q(g),n({text:"Photo was detached successfully",type:"success"})}})}function ft(t){switch(t.contextName){case"Company":$e({companyId:o.managedCompany.companyId,photoId:t.activeItem.photoId,index:t.newIndex}).then(r=>{r.error||(R(o.managedCompany.companyId).then(i=>{e(a.refreshManagedCompany(i.data))}),(t.newIndex===0||t.oldIndex===0)&&(e(a.setIsSelectEntityCardLoading(!0)),e(a.setIsSuppliersGridLoading(!0)),b(o.companiesGridRequestModel).then(i=>{e(a.setIsSelectEntityCardLoading(!1)),e(a.setIsSuppliersGridLoading(!1));const u=i.data.items.map(p=>{var h;return{...p,isSelected:p.companyId===((h=o.selectedCompany)==null?void 0:h.companyId)}});e(a.refreshCompaniesGridRequestModel({...i.data,items:u}))})))});break;case"Location":Ue({locationId:o.managedLocation.locationId,photoId:t.activeItem.photoId,index:t.newIndex}).then(r=>{r.error||R(o.managedCompany.companyId).then(i=>{e(a.refreshManagedCompany(i.data))})});break;default:ue(o.selectedVariant.variantId,t.activeItem.photoId,t.newIndex),ue(o.selectedVariant.variantId,t.activeItem.photoId,t.newIndex).then(()=>{e(a.setIsVariantPhotoGridLoading(!0)),D(o.selectedVariant.variantId).then(r=>{e(a.setIsVariantPhotoGridLoading(!1)),e(a.refreshSelectedVariant(r)),e(a.refreshVariantPhotos(r==null?void 0:r.photos))}),(t.newIndex===0||t.activeItem.sortOrder===1)&&q(g)})}}function gt(){c({findProductsCard:!1,addStockCard:!0}),e(a.setIsAddStockCardLoading(!0)),Promise.all([Be(),K()]).then(([t])=>{e(a.setIsAddStockCardLoading(!1)),e(a.refreshCurrenciesList(t.data))})}function yt(){l("disposeStockCard",!0),D(o.selectedVariant.variantId).then(t=>{e(a.refreshSelectedVariant(t))})}function Pt(t){l("variantHistoryCard",!0),e(a.setIsVariantsHistoryGridLoading(!0)),ze(t).then(r=>{var i;if(e(a.setIsVariantsHistoryGridLoading(!1)),!r.error&&r){const u=(i=r.data)==null?void 0:i.map(p=>({...p,createdDate:ha(p.createdDate,"date")}));e(a.refreshVariantHistory(u))}})}function It(){l("manageTraitsCard",!0),de(o.productId)}function St(t){l("variantPhotosCard",!0),e(a.setIsProductPhotoGridLoading(!0)),ce(o.productId,t).then(r=>{e(a.setIsProductPhotoGridLoading(!1)),e(a.refreshProductPhotosForVariant(r))})}function xt(t){l("selectPurchaseCard",!0),e(a.setIsPurchaseGridLoading(!0)),H(t).then(r=>{if(e(a.setIsPurchaseGridLoading(!1)),r.error)return;const i=r.data.items.map(u=>{var p;return{...u,isSelected:u.purchaseId===((p=o.selectedPurchase)==null?void 0:p.purchaseId)}});e(a.refreshPurchaseGridRequestModel({...r.data,items:i}))})}function Lt(){l("productTraitConfigurationCard")}function vt(){l("variantPhotosCard")}function kt(){e(ee.resetSelectedVariant()),l("variantConfigurationCard")}function Vt(){l("variantHistoryCard")}function Gt(){l("selectPurchaseCard")}function Ht(t){l("selectPurchaseCard"),e(a.refreshSelectedPurchase(t))}function bt(){l("addStockCard"),e(a.resetSelectedPurchase())}function Mt(t){e(a.setIsPurchaseGridLoading(!0)),H({...o.purchaseGridRequestModel,searchQuery:t}).then(r=>{if(e(a.setIsPurchaseGridLoading(!1)),r.error)return;const i=r.data.items.map(u=>{var p;return{...u,isSelected:u.purchaseId===((p=o.selectedPurchase)==null?void 0:p.purchaseId)}});e(a.refreshPurchaseGridRequestModel({...r.data,items:i}))})}function jt(t){e(a.setIsPurchaseGridLoading(!0)),H({...o.purchaseGridRequestModel,filter:t}).then(r=>{if(e(a.setIsPurchaseGridLoading(!1)),r.error)return;const i=r.data.items.map(u=>{var p;return{...u,isSelected:u.purchaseId===((p=o.selectedPurchase)==null?void 0:p.purchaseId)}});e(a.refreshPurchaseGridRequestModel({...r.data,items:i}))})}function Ot(t){return e(a.setIsSupplierCardLoading(!0)),m({date:t.selectedDate,supplierId:o.selectedCompany.companyId,documentNotes:t.purchaseNotes}).then(r=>{e(a.refreshSelectedPurchase(r.data)),e(a.setIsSupplierCardLoading(!1)),r?(l("supplierCard"),n({text:f("SuccessMessages.PurchaseCreated"),type:"success"})):n({text:r.error.message,type:"error"})})}function Nt(){l("supplierCard",!0)}function Tt(){e(ee.resetSelectedSupplier()),l("selectEntityCard",!0),o.countryCodes||ne().then(()=>{}),e(a.setIsSelectEntityCardLoading(!0)),e(a.setIsSuppliersGridLoading(!0)),b(o.companiesGridRequestModel).then(t=>{e(a.setIsSelectEntityCardLoading(!1)),e(a.setIsSuppliersGridLoading(!1));const r=t.data.items.map(i=>{var u;return{...i,isSelected:i.companyId===((u=o.selectedCompany)==null?void 0:u.companyId)}});e(a.refreshCompaniesGridRequestModel({...t.data,items:r}))})}function Dt(t){e(a.setIsSuppliersGridLoading(!0)),b({...o.companiesGridRequestModel,searchQuery:t}).then(r=>{e(a.setIsSuppliersGridLoading(!1));const i=r.data.items.map(u=>{var p;return{...u,isSelected:u.companyId===((p=o.selectedCompany)==null?void 0:p.companyId)}});e(a.refreshCompaniesGridRequestModel({...r.data,items:i}))})}function Rt(){l("createCompanyCard",!0),z()}function Ft(t){l("selectEntityCard"),e(a.refreshSelectedCompany(t))}function At(t){e(a.setIsCreateCompanyCardLoading(!0)),Ge(t.company).then(r=>{r.error?n({text:r.error.details.message,type:"error"}):(t.image.uploadModels.map(i=>{i.contextId=r.data.companyId,e(a.setIsPhotoUploaderLoading(!0)),Q(i).then(u=>{e(a.setIsPhotoUploaderLoading(!1)),n(u?{text:f("SuccessMessages.ImageAdded"),type:"success"}:{text:u.error.details.message,type:"error"})})}),He({companyId:r.data.companyId,model:t.address}).then(()=>{e(a.setIsCreateCompanyCardLoading(!1)),l("createCompanyCard"),e(a.setIsSuppliersGridLoading(!0)),b(o.companiesGridRequestModel).then(i=>{e(a.setIsSuppliersGridLoading(!1));const u=i.data.items.map(p=>{var h;return{...p,isSelected:p.companyId===((h=o.selectedCompany)==null?void 0:h.companyId)}});e(a.refreshCompaniesGridRequestModel({...i.data,items:u}))})}),n({text:"Company created successfully",type:"success"}))})}function _t(){l("createCompanyCard")}function qt(t){l("companyConfigurationCard",!0),e(a.setIsCompanyConfigurationCardLoading(!0)),e(a.setIsLocationsGridLoading(!0)),z(),R(t.companyId).then(r=>{e(a.setIsCompanyConfigurationCardLoading(!1)),e(a.setIsLocationsGridLoading(!1)),e(a.refreshManagedCompany(r.data))})}async function Et(t){await y({headerTitle:"Deleting company",text:`You are about to delete company ${t.companyName}.`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&(e(a.setIsCompanyConfigurationCardLoading(!0)),be(t.companyId).then(i=>{if(i.error){n({text:"Failed to delete company",type:"error"});return}else n({text:"Company deleted successfully",type:"info"}),l("companyConfigurationCard"),e(a.setIsCompanyConfigurationCardLoading(!1)),e(a.setIsLocationsGridLoading(!1)),e(a.resetManagedCompany()),e(a.setIsSuppliersGridLoading(!0)),b(o.companiesGridRequestModel).then(u=>{e(a.setIsSuppliersGridLoading(!1));const p=u.data.items.map(h=>{var S;return{...h,isSelected:h.companyId===((S=o.selectedCompany)==null?void 0:S.companyId)}});e(a.refreshCompaniesGridRequestModel({...u.data,items:p}))}),o.selectedCompany.companyId===o.managedCompany.companyId&&e(a.resetSelectedCompany())}))}function Bt(){l("companyConfigurationCard"),e(a.resetManagedCompany())}function zt(){l("companyPhotosCard",!0)}function wt(t){e(a.setIsCompanyConfigurationCardLoading(!0)),we({companyId:o.managedCompany.companyId,model:t}).then(r=>{e(a.setIsCompanyConfigurationCardLoading(!1)),r.error?n({text:"Failed to update company",type:"error"}):(e(a.refreshManagedCompany(r.data)),e(a.setIsSuppliersGridLoading(!0)),b(o.companiesGridRequestModel).then(i=>{e(a.setIsSuppliersGridLoading(!1));const u=i.data.items.map(p=>{var h;return{...p,isSelected:p.companyId===((h=o.selectedCompany)==null?void 0:h.companyId)}});e(a.refreshCompaniesGridRequestModel({...i.data,items:u}))}),n({text:"Company updated successfully",type:"success"}))})}async function $t(t){await y({headerTitle:"Deleting company photo",text:"You are about to delete company photo.",primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&O(t.photoId).then(i=>{const u=o.managedCompany.photos.filter(p=>p.photoId!==t.photoId);e(a.refreshManagedCompany({...o.managedCompany,photos:u})),e(a.setIsSuppliersGridLoading(!0)),b(o.companiesGridRequestModel).then(p=>{e(a.setIsSuppliersGridLoading(!1));const h=p.data.items.map(S=>{var M;return{...S,isSelected:S.companyId===((M=o.selectedCompany)==null?void 0:M.companyId)}});e(a.refreshCompaniesGridRequestModel({...p.data,items:h}))}),i.error?n({text:"Photo not deleted",description:i.error.details.message,type:"error"}):n({text:"Photo deleted successfully",type:"success"})})}function Ut(t){return e(a.setIsPhotoUploaderLoading(!0)),Q(t).then(r=>{var i;return r.error?(n({text:((i=r.error.data)==null?void 0:i.detail)||"Upload failed",type:"error"}),r):(r.data.photoId&&(e(a.setIsPhotoUploaderLoading(!1)),t.contextName==="Company"?(e(a.setIsSuppliersGridLoading(!0)),b(o.companiesGridRequestModel).then(u=>{e(a.setIsSuppliersGridLoading(!1));const p=u.data.items.map(h=>{var S;return{...h,isSelected:h.companyId===((S=o.selectedCompany)==null?void 0:S.companyId)}});e(a.refreshCompaniesGridRequestModel({...u.data,items:p}))}),e(a.refreshManagedCompany({...o.managedCompany,photos:[...o.managedCompany.photos||[],r.data]}))):e(a.refreshManagedLocation({...o.managedLocation,photos:[...o.managedLocation.photos||[],r.data]})),n({text:"Photos added successfully",type:"success"})),r)})}function Wt(t){l(t==="Company"?"companyPhotosCard":"locationPhotosCard")}function Qt(t){l("locationConfigurationCard",!0),z(),e(t?a.refreshManagedLocation(t):a.resetManagedLocation())}function Kt(t){e(a.setIsLocationConfigurationCardLoading(!0)),Me({companyId:o.managedCompany.companyId,model:t}).then(r=>{var i;r.error?n({text:(i=r.error.data)==null?void 0:i.detail,type:"error"}):(l("locationConfigurationCard"),e(a.setIsCompanyConfigurationCardLoading(!0)),e(a.setIsLocationsGridLoading(!0)),R(o.managedCompany.companyId).then(u=>{e(a.setIsCompanyConfigurationCardLoading(!1)),e(a.setIsLocationsGridLoading(!1)),e(a.refreshManagedCompany(u.data))}),n({text:"Location added successfully",type:"success"}))})}function Yt(t){e(a.setIsLocationConfigurationCardLoading(!0)),Qe(t.locationId).then(r=>{var i;r.error?n({text:(i=r.error.data)==null?void 0:i.detail,type:"error"}):(l("locationConfigurationCard"),e(a.setIsCompanyConfigurationCardLoading(!0)),e(a.setIsLocationsGridLoading(!0)),R(o.managedCompany.companyId).then(u=>{e(a.setIsCompanyConfigurationCardLoading(!1)),e(a.setIsLocationsGridLoading(!1)),e(a.refreshManagedCompany(u.data))}),n({text:"Location deleted successfully",type:"success"}))})}function Jt(t){e(a.setIsLocationConfigurationCardLoading(!0)),We({locationId:o.managedLocation.locationId,model:t}).then(r=>{e(a.setIsLocationConfigurationCardLoading(!1)),r.error?n({text:"Failed to update location",type:"error"}):(e(a.setIsCompanyConfigurationCardLoading(!0)),R(o.managedCompany.companyId).then(i=>{e(a.setIsCompanyConfigurationCardLoading(!1)),e(a.refreshManagedCompany(i.data))}),n({text:"Location updated successfully",type:"success"}))})}function Xt(){l("locationConfigurationCard"),e(a.resetManagedLocation())}function Zt(){if(l("selectEntityCard",!0),o.companiesGridRequestModel===null)e(a.setIsSelectEntityCardLoading(!0)),e(a.setIsSuppliersGridLoading(!0)),b(o.companiesGridRequestModel).then(t=>{e(a.setIsSelectEntityCardLoading(!1)),e(a.setIsSuppliersGridLoading(!1));const r=t.data.items.map(i=>{var u;return{...i,isSelected:i.companyId===((u=o.selectedCompany)==null?void 0:u.companyId)}});e(a.refreshCompaniesGridRequestModel({...t.data,items:r}))});else{const t=o.companiesGridRequestModel.items.map(r=>{var i;return{...r,isSelected:r.companyId===((i=o.selectedCompany)==null?void 0:i.companyId)}});e(a.refreshCompaniesGridRequestModel({...o.companiesGridRequestModel,items:t}))}}function ea(){l("supplierCard")}function ta(){l("selectEntityCard")}function aa(){l("locationPhotosCard",!0)}async function ra(t){await y({headerTitle:"Deleting location photo",text:"You are about to delete location photo.",primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&O(t.photoId).then(i=>{const u=o.managedLocation.photos.filter(p=>p.photoId!==t.photoId);e(a.refreshManagedLocation({...o.managedLocation,photos:u})),i.error?n({text:"Photo not deleted",description:i.error.details.message,type:"error"}):n({text:"Photo deleted successfully",type:"success"})})}function z(){o.countryCodes.length===0&&ne(void 0).then(t=>{e(a.refreshCountryCodes(t.data))})}return{getOrderStockActionsListForGrid:q,addProductHandler:Ye,addVariantsToOrderHandler:Je,variantsGridRequestChange:Xe,updateStockActionInOrderHandler:ie,removeStockActionFromOrderHandler:Ze,manageProductHandler:et,generateProductCodeHandler:tt,deletePhotoHandler:at,getVariantDetailsHandler:D,getListOfTraitsWithOptionsForProductHandler:de,getTaxesListHandler:K,manageVariantHandler:nt,updateVariantDetailsHandler:st,updateVariantTraitOptions:it,deleteVariantHandler:ut,increaseStockAmountHandler:lt,disposeFromStockHandler:pt,uploadPhotoToVariantHandler:mt,addPhotoToVariantHandler:ht,detachPhotoFromVariantHandler:Ct,changePhotoPositionHandler:ft,openAddStockCardHandler:gt,openDisposeStockCardHandler:yt,openVariantHistoryCardHandler:Pt,openManageTraitsCardHandler:It,openVariantPhotosCardHandler:St,openSelectPurchaseCardHandler:xt,closeProductTraitConfigurationCardHandler:Lt,closeVariantPhotosCardHandler:vt,closeVariantConfigurationCardHandler:kt,closeVariantHistoryCardHandler:Vt,closeSelectPurchaseCardHandler:Gt,selectPurchaseHandler:Ht,closeAddStockCardHandler:bt,searchSupplierHandle:Mt,filterSuppliersByDateHandle:jt,createPurchaseForSupplierHandler:Ot,closeSupplierCardHandler:ea,closeSelectEntityCardHandler:ta,openSupplierCardHandler:Nt,openSelectEntityCardHandler:Tt,searchEntityHandle:Dt,openCreateEntityCardHandler:Rt,createCompanyHandler:At,closeCreateCompanyCardHandler:_t,selectCompanyHandle:Ft,manageCompanyHandler:qt,deleteCompanyHandler:Et,closeCompanyConfigurationCardHandler:Bt,manageCompanyPhotosHandler:zt,updateCompanyHandler:wt,deleteCompanyPhotoHandler:$t,uploadPhotoHandler:Ut,closePhotosCardHandler:Wt,openLocationConfigurationCardHandler:Qt,closeLocationConfigurationCardHandler:Xt,createLocationHandler:Kt,deleteLocationHandler:Yt,updateLocationHandler:Jt,detachSupplierHandler:Zt,manageLocationPhotosHandler:aa,deleteLocationPhotoHandler:ra,getCountryCodesHandler:z}}function to(){var g,I,v,G,x,O,H,T;const{handleCardAction:l,createRefCallback:c,handleMultipleCardActions:o}=ga({selectActiveCards:N=>N[_.ORDER_PRODUCTS].activeCards,refreshAction:a.refreshActiveCards}),d=te(_.ORDER_PRODUCTS),C=te(_.APP),e=te(_.ORDERS),n=Sr(l,o),P=Object.values(Ca).map(N=>({value:N,description:fa[N]})),{orderId:y}=Se();A.useEffect(()=>{n.getOrderStockActionsListForGrid(y)},[y]);async function f(N,m){switch(N){case"addProduct":l("findProductsCard",!0),n.addProductHandler(e.variantsGridRequestModel);break;case"addVariantToOrder":n.addVariantsToOrderHandler(y,m);break;case"variantsGridRequestChange":n.variantsGridRequestChange(m);break;case"closeFindProductsCard":l("findProductsCard");break;case"updateStockAction":n.updateStockActionInOrderHandler(m.row.original.stockActionId,m.formData);break;case"removeStockAction":n.removeStockActionFromOrderHandler(m.original);break;case"manageProduct":n.manageProductHandler(m);break;case"manageVariant":n.manageVariantHandler(m);break;case"updateVariantDetails":n.updateVariantDetailsHandler(m);break;case"updateVariantTraitOptions":n.updateVariantTraitOptions(m);break;case"deleteVariant":n.deleteVariantHandler(m);break;case"increaseStockAmount":n.increaseStockAmountHandler(m);break;case"disposeFromStock":n.disposeFromStockHandler(m);break;case"uploadPhotoToVariant":n.uploadPhotoToVariantHandler(m);break;case"deletePhoto":console.log("PHOTO DELETE",m);break;case"addPhotoToVariant":n.addPhotoToVariantHandler(m);break;case"detachPhotoFromVariant":n.detachPhotoFromVariantHandler(m);break;case"dndVariantPhoto":n.changePhotoPositionHandler(m);break;case"openAddStockCard":n.openAddStockCardHandler();break;case"selectPurchase":n.selectPurchaseHandler(m);break;case"searchSupplier":n.searchSupplierHandle(m);break;case"filterSuppliersByDate":n.filterSuppliersByDateHandle(m);break;case"openDisposeStockCard":n.openDisposeStockCardHandler();break;case"openVariantHistoryCard":n.openVariantHistoryCardHandler(m);break;case"openManageTraitsCard":n.openManageTraitsCardHandler();break;case"openVariantPhotosCard":n.openVariantPhotosCardHandler(m);break;case"openSelectPurchaseCard":n.openSelectPurchaseCardHandler(d.purchaseGridRequestModel);break;case"openSupplierCard":n.openSupplierCardHandler();break;case"openSelectEntityCard":n.openSelectEntityCardHandler();break;case"searchEntity":n.searchEntityHandle(m);break;case"openCreateEntityCard":n.openCreateEntityCardHandler();break;case"createCompany":n.createCompanyHandler(m);break;case"closeCreateCompanyCard":n.closeCreateCompanyCardHandler();break;case"manageCompany":n.manageCompanyHandler(m);break;case"updateCompany":n.updateCompanyHandler(m);break;case"deleteCompany":n.deleteCompanyHandler(m);break;case"closeCompanyConfigurationCard":n.closeCompanyConfigurationCardHandler();break;case"manageCompanyPhotos":n.manageCompanyPhotosHandler();break;case"uploadPhoto":n.uploadPhotoHandler(m);break;case"deleteCompanyPhoto":n.deleteCompanyPhotoHandler(m);break;case"changePhotoPosition":n.changePhotoPositionHandler(m);break;case"closePhotosCard":n.closePhotosCardHandler(m);break;case"openLocationConfigurationCard":n.openLocationConfigurationCardHandler(m);break;case"createLocation":n.createLocationHandler(m);break;case"updateLocation":n.updateLocationHandler(m);break;case"deleteLocation":n.deleteLocationHandler(m);break;case"closeLocationConfigurationCard":n.closeLocationConfigurationCardHandler();break;case"manageLocationPhotos":n.manageLocationPhotosHandler();break;case"deleteLocationPhoto":n.deleteLocationPhotoHandler(m);break;case"selectCompany":n.selectCompanyHandle(m);break;case"detachSupplier":n.detachSupplierHandler();break;case"createPurchase":n.createPurchaseForSupplierHandler(m);break;case"closeVariantPhotosCard":n.closeVariantPhotosCardHandler();break;case"closeVariantConfigurationCard":n.closeVariantConfigurationCardHandler();break;case"closeVariantHistoryCard":n.closeVariantHistoryCardHandler();break;case"closeSelectPurchaseCard":n.closeSelectPurchaseCardHandler();break;case"closeAddStockCard":n.closeAddStockCardHandler();break;case"closeSupplierCard":n.closeSupplierCardHandler();break;case"closeSelectEntityCard":n.closeSelectEntityCardHandler();break}}return s.jsx("div",{className:Pe.orderProductsPage,children:s.jsxs(Ia,{menuCollectionType:"order",menuTitle:"Order",itemId:Number(y),activeCards:d.activeCards,counter:e.productCounter,children:[s.jsx(Ir,{isLoading:d.isProductsInOrderCardLoading,isGridLoading:d.isProductsInOrderGridLoading,stockActions:d.stockActionsGridRequestModel.items,onAction:f}),((g=d.activeCards)==null?void 0:g.includes("findProductsCard"))&&s.jsx("div",{className:Pe.findProductsCard,ref:c("findProductsCard"),children:s.jsx(ar,{isLoading:d.isFindProductsCardLoading,isGridLoading:d.isFindProductsGridLoading,variants:e.variantsGridRequestModel.items,gridRequestModel:e.variantsGridRequestModel,preferences:C.preferences,sortingOptions:P,colorsForFilter:e.colorsForFilter,sizesForFilter:e.sizesForFilter,categories:e.categories,brands:e.brands,onAction:f})}),d.activeCards.includes("variantConfigurationCard")&&s.jsx("div",{ref:c("variantConfigurationCard"),children:s.jsx(Ma,{isLoading:d.isVariantConfigurationCardLoading,isVariantOptionsGridLoading:d.isVariantOptionsGridLoading,isVariantPhotoGridLoading:d.isVariantPhotoGridLoading,variant:d.selectedVariant,variantPhotos:d.variantPhotos,data:d.variantTraitsGridRequestModel,taxesList:d.taxesList,productCounter:d.productCounter,onAction:f,onGenerateProductCode:n.generateProductCodeHandler})}),d.activeCards.includes("addStockCard")&&s.jsx("div",{ref:c("addStockCard"),children:s.jsx(ja,{isLoading:d.isAddStockCardLoading,taxTypes:d.taxesList,currencyTypes:d.currenciesList,variant:d.selectedVariant,purchase:d.selectedPurchase,onAction:f})}),d.activeCards.includes("selectPurchaseCard")&&s.jsx("div",{ref:c("selectPurchaseCard"),children:s.jsx(Oa,{isLoading:d.isSelectPurchaseCardLoading,isGridLoading:d.isPurchaseGridLoading,purchases:d.purchaseGridRequestModel.items,onAction:f})}),d.activeCards.includes("supplierCard")&&s.jsx("div",{ref:c("supplierCard"),children:s.jsx(Fa,{isLoading:d.isSupplierCardLoading,selectedPurchase:d.selectedPurchase,selectedSupplier:d.selectedCompany,showCloseButton:!0,onAction:f})}),((I=d.activeCards)==null?void 0:I.includes("selectEntityCard"))&&s.jsx("div",{ref:c("selectEntityCard"),children:s.jsx(_a,{isLoading:d.isSelectEntityCardLoading,isGridLoading:d.isSuppliersGridLoading,entityName:"Company",entityCollection:(v=d.companiesGridRequestModel)==null?void 0:v.items,columns:Aa({onAction:f}),onAction:f})}),d.activeCards.includes("createCompanyCard")&&s.jsx("div",{ref:c("createCompanyCard"),children:s.jsx(qa,{isLoading:d.isCreateCompanyCardLoading,isPhotoUploaderLoading:d.isPhotoUploaderLoading,countryCodes:d.countryCodes,onAction:f})}),d.activeCards.includes("companyConfigurationCard")&&s.jsx("div",{ref:c("companyConfigurationCard"),children:s.jsx(Ea,{isLoading:d.isCompanyConfigurationCardLoading,isGridLoading:d.isLocationsGridLoading,company:d.managedCompany,countryCodes:d.countryCodes,onAction:f})}),d.activeCards.includes("companyPhotosCard")&&s.jsx("div",{ref:c("companyPhotosCard"),children:s.jsx(ye,{isImageUploaderLoading:d.isPhotoUploaderLoading,data:(G=d.managedCompany)==null?void 0:G.photos,contextName:"Company",contextId:(x=d.managedCompany)==null?void 0:x.companyId,noDataText:"COMPANY HAS NO PHOTOS",showCloseButton:!0,columns:Ba({onAction:f}),onAction:f})}),d.activeCards.includes("locationConfigurationCard")&&s.jsx("div",{ref:c("locationConfigurationCard"),children:s.jsx(za,{isLoading:d.isCustomerAddressDetailsLoading,location:d.managedLocation,countryCodes:d.countryCodes,onAction:f})}),d.activeCards.includes("locationPhotosCard")&&s.jsx("div",{ref:c("locationPhotosCard"),children:s.jsx(ye,{isImageUploaderLoading:d.isPhotoUploaderLoading,data:(O=d.managedLocation)==null?void 0:O.photos,contextName:"Location",contextId:(H=d.managedLocation)==null?void 0:H.locationId,noDataText:"LOCATION HAS NO PHOTOS",showCloseButton:!0,columns:wa({onAction:f}),onAction:f})}),d.activeCards.includes("disposeStockCard")&&s.jsx("div",{ref:c("disposeStockCard"),children:s.jsx(Na,{isLoading:d.isDisposeStockCardLoading,variant:d.selectedVariant,onAction:f,onSecondaryButtonClick:()=>l("disposeStockCard")})}),d.activeCards.includes("variantHistoryCard")&&s.jsx("div",{ref:c("variantHistoryCard"),children:s.jsx(Ta,{isLoading:d.isVariantHistoryCardLoading,isGridLoading:d.isVariantsHistoryGridLoading,variant:d.selectedVariant,data:d.variantHistory,onAction:f})}),d.activeCards.includes("manageTraitsCard")&&s.jsx("div",{ref:c("manageTraitsCard"),children:s.jsx(Da,{isLoading:d.isManageTraitsCardLoading,traits:d.listOfTraitsWithOptionsForProduct,variant:d.selectedVariant,onAction:f,onSecondaryButtonClick:()=>l("manageTraitsCard")})}),d.activeCards.includes("variantPhotosCard")&&s.jsx("div",{ref:c("variantPhotosCard"),children:s.jsx(Ra,{isLoading:d.isVariantPhotosCardLoading,isVariantPhotoGridLoading:d.isVariantPhotoGridLoading,isProductPhotoGridLoading:d.isProductPhotoGridLoading,variantPhotos:d.variantPhotos,productPhotos:d.productPhotosForVariant,contextId:(T=d.selectedVariant)==null?void 0:T.variantId,onAction:f})})]})})}export{to as OrderProductsPage};
