import{r as F,j as r,o as Qe,k as H,aw as J,t as $,m as Ye,z as E,B as Ze,a as K,S as q,c as Je,G as Xe,H as Ae,P as W,q as et,W as _,A as z,Z as f,ap as o,N as tt,bx as V}from"./index-CqLEDb0h.js";import{S as O}from"./SheCard-CX5qtFRW.js";import{o as ot,c as at,n as k,s as w,u as rt,S as nt,a as T}from"./types-TQ-jcydJ.js";import{R as st,S as M}from"./SheInput-DbpOA7IC.js";import{S as D,a as dt,b as it}from"./SheSelect-C_zn2LY0.js";import{C as ct}from"./SheCardNotification-BVOYMQJ2.js";import{W as lt,x as ut}from"./SheContextSidebar-CL4FXvtg.js";import{P as Q}from"./plus-Cg_Vlo1I.js";import{c as G}from"./she-select-convertors-CdG-Ygpu.js";import{u as X,I as mt}from"./useAppTranslation-CsMEigHw.js";import{S as A}from"./SheFileUploader-DanH7GSt.js";import{u as pt}from"./useProductsPageService-TLcc9QQg.js";import{u as gt}from"./useToast-BWT7QgMZ.js";import{u as Ct}from"./chevron-up-DLJ1s3UP.js";const ft="_productConfigurationFormCard_czqqu_1",yt="_productConfigurationForm_czqqu_1",Y={productConfigurationFormCard:ft,productConfigurationForm:yt},ht="_productConfigurationForm_15j2h_1",It="_componentWithButton_15j2h_9",Pt="_formButton_15j2h_16",xt="_formFooter_15j2h_19",S={productConfigurationForm:ht,componentWithButton:It,formButton:Pt,formFooter:xt},Lt="field is required",Bt=ot({productName:w().nonempty(Lt).min(2,"Min value length 2").max(50,"Max value length 50"),productCode:w().optional(),barcode:w().optional(),brandId:k().optional(),productCategoryId:k().optional(),countryOfOriginId:k().optional(),isActive:at().optional()}),Z={productId:null,productAppId:void 0,image:void 0,productCode:void 0,productName:void 0,productCategory:void 0,productCategoryId:void 0,brand:void 0,brandId:void 0,barcode:void 0,status:void 0,salePrice:void 0,variantsCount:void 0,stockAmount:void 0,countryId:void 0,isActive:!1,countryOfOriginId:void 0};function Nt({data:c,categories:d,brands:s,countryCodes:e,productCode:l,selectedCategory:n,showSecondaryButton:P,onSubmit:L,onCancel:B,onAction:I}){const{form:N,isDisabled:C,setValue:u}=rt({values:c,defaultValues:Z,scheme:Bt,mode:st.CHANGE});return F.useEffect(()=>{c!=null&&c.productId?N.reset(c):N.reset(Z)},[c]),F.useEffect(()=>{n&&u("productCategoryId",n)},[n]),F.useEffect(()=>{u("productCode",l)},[l]),r.jsxs(nt,{form:N,className:S.productConfigurationForm,footerClassName:S.formFooter,footerPosition:Qe.RIGHT,primaryBtnProps:{value:c!=null&&c.productId?"Save":"Add Product",valueTransKey:c!=null&&c.productId?"CommonButtons.Save":"ProductActions.AddProduct",icon:ct,disabled:C},hideSecondaryBtn:!c||!c.productId||!P,onCancel:B,onSubmit:L,children:[r.jsx(T,{name:"productName",required:!0,render:({field:p})=>r.jsx(M,{value:p.value,label:"Product Name",labelTransKey:"ProductForm.Labels.ProductName",placeholder:"enter product name...",placeholderTransKey:"ProductForm.Placeholders.ProductName",autoFocus:!0,fullWidth:!0})}),r.jsxs("div",{className:S.componentWithButton,children:[r.jsx(T,{name:"productCode",render:({field:p})=>r.jsx(M,{value:p.value||"",label:"Product Code",labelTransKey:"ProductForm.Labels.ProductCode",placeholder:"enter product code...",placeholderTransKey:"ProductForm.Placeholders.ProductCode",fullWidth:!0,onDelay:x=>I("checkProductCode",x)})}),r.jsx(H,{className:S.formButton,icon:lt,type:"button",variant:"outline",onClick:()=>I("generateProductCode")})]}),r.jsx(T,{name:"barcode",render:({field:p})=>r.jsx(M,{value:p.value||"",label:"Product Barcode",labelTransKey:"ProductForm.Labels.ProductBarcode",placeholder:"enter product barcode...",placeholderTransKey:"ProductForm.Placeholders.ProductBarcode",fullWidth:!0})}),r.jsxs("div",{className:S.componentWithButton,children:[r.jsx(T,{name:"productCategoryId",render:({field:p})=>r.jsx(D,{items:d,selected:p.value,label:"Category Name",labelTransKey:"ProductForm.Labels.CategoryName",placeholder:"enter category name...",placeholderTransKey:"ProductForm.Placeholders.SelectCategory",hideFirstOption:!0,fullWidth:!0})}),r.jsx(H,{className:S.formButton,icon:Q,variant:"outline",type:"button",onClick:()=>I("openCreateProductCategoryCard")})]}),r.jsxs("div",{className:S.componentWithButton,children:[r.jsx(T,{name:"brandId",render:({field:p})=>r.jsx(D,{items:s,selected:p.value,label:"Brand Name",labelTransKey:"ProductForm.Labels.BrandName",placeholder:"enter brand name...",placeholderTransKey:"ProductForm.Placeholders.SelectBrand",hideFirstOption:!0,fullWidth:!0})}),r.jsx(H,{className:S.formButton,icon:Q,variant:"outline",type:"button",onClick:()=>I("openCreateProductBrandCard")})]}),r.jsx(T,{name:"countryOfOriginId",render:({field:p})=>r.jsx(D,{items:e,selected:p.value||n,label:"Country of origin",labelTransKey:"ProductForm.Labels.CountryOfOrigin",placeholder:"select country of origin...",placeholderTransKey:"ProductForm.Placeholders.CountryOfOrigin",hideFirstOption:!0,fullWidth:!0})}),r.jsx(T,{name:"isActive",render:({field:p})=>r.jsx(dt,{checked:p.value,text:"Is Active",textTransKey:"ProductForm.Labels.IsActive",type:it.SWITCH})})]})}function mo({isLoading:c,product:d,productId:s,categoriesList:e,brandsList:l,countryCodesList:n,selectedCategory:P,productCode:L,showSecondaryButton:B,onAction:I}){return r.jsx(O,{className:Y.productConfigurationFormCard,title:s?"Basic Product Data":"Create Product",titleTransKey:s?"CardTitles.BasicProductData":"CardTitles.CreateProduct",isLoading:c,showCloseButton:B,children:r.jsx("div",{className:Y.productConfigurationForm,children:r.jsx(Nt,{data:d,categories:G(e,{text:"categoryName",value:"categoryId",icon:"thumbnail"}),brands:G(l,{text:"brandName",value:"brandId",icon:"thumbnail"}),countryCodes:G(n,{text:"countryName",value:"countryId",icon:"flagIcon"}),selectedCategory:P,productCode:L,onAction:I,onSubmit:N=>I("submitProductData",N),onCancel:()=>I("gotoProductsPage")})})})}const _t="_createProductCategoryCard_6pz0n_1",vt="_cardContent_6pz0n_1",St="_uploadingBlockContainer_6pz0n_8",jt="_uploadingItem_6pz0n_15",bt="_uploadingImageContainer_6pz0n_15",Tt="_uploadingItemImage_6pz0n_20",Ft="_uploadingItemTextBlock_6pz0n_26",Ht="_loadingBlock_6pz0n_38",j={createProductCategoryCard:_t,cardContent:vt,uploadingBlockContainer:St,uploadingItem:jt,uploadingImageContainer:bt,uploadingItemImage:Tt,uploadingItemTextBlock:Ft,loadingBlock:Ht};function po({isLoading:c,isPhotoUploaderLoading:d,category:s,onAction:e}){const[l,n]=F.useState({}),P=F.useRef(null),{translate:L}=X();function B(){var x,b;const C=((x=P.current)==null?void 0:x.getSelectedFiles())||[],u=((b=P.current)==null?void 0:b.getUploadModels())||[],p={categoryName:s.categoryName,images:C,uploadModels:u};n(p),e==null||e("createProductCategory",p)}function I(){e==null||e("closeCreateProductCategoryCard")}const N=()=>{var C;return c&&(l!=null&&l.images)?l.images:((C=P.current)==null?void 0:C.getSelectedFiles())||[]};return r.jsx(O,{className:j.createProductCategoryCard,title:"Create Product Category",titleTransKey:"CardTitles.CreateProductCategory",isLoading:c,showCloseButton:!0,onSecondaryButtonClick:I,children:r.jsxs("div",{className:j.cardContent,children:[r.jsx(M,{label:"Category Name",labelTransKey:"ProductForm.Labels.CategoryName",placeholder:"enter category name...",placeholderTransKey:"ProductForm.Placeholders.CategoryName",errorMessage:s==null?void 0:s.error,fullWidth:!0,onDelay:C=>e("checkCategoryName",C)}),d?r.jsx("div",{className:j.uploadingBlockContainer,children:N().map((C,u)=>{const p=C instanceof File?URL.createObjectURL(C):C.result||C.path;return r.jsx("div",{className:"overflow-hidden rounded-md bg-secondary p-0 shadow-sm",children:r.jsxs("div",{className:`${j.uploadingItem} flex relative items-center justify-between p-2 pl-4`,children:[r.jsx("div",{className:j.uploadingImageContainer,children:r.jsx("img",{src:p,alt:`uploading-${C.name||`image-${u}`}`,className:j.uploadingItemImage,onLoad:()=>{C instanceof File&&URL.revokeObjectURL(p)}})}),r.jsxs("div",{className:j.uploadingItemTextBlock,children:[r.jsx("p",{className:"truncate text-sm",children:C.name||`${L("ProductForm.Labels.Image")} ${u+1}`}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[((C.size||0)/(1024*1024)).toFixed(2)," MB"]})]}),r.jsx(J,{className:j.loadingBlock})]})},C.name||u)})}):r.jsx(A,{isLoading:d,ref:P,contextName:"category",contextId:s==null?void 0:s.categoryId,fullWidth:!0,hideUploadButton:!0}),r.jsx(H,{value:"Add Category",valueTransKey:"ProductActions.AddCategory",disabled:!(s!=null&&s.categoryName)||!!(s!=null&&s.error),onClick:B})]})})}const Mt="_createProductBrandCard_ii7aw_1",kt="_cardContent_ii7aw_1",wt="_uploadingBlockContainer_ii7aw_8",Dt="_uploadingItem_ii7aw_15",Gt="_uploadingImageContainer_ii7aw_15",Ot="_uploadingItemImage_ii7aw_20",Ut="_uploadingItemTextBlock_ii7aw_26",Rt="_loadingBlock_ii7aw_38",$t="_brandOwnerBlock_ii7aw_42",Et="_brandOwnerSelect_ii7aw_47",Kt="_brandOwnerSelectTitle_ii7aw_52",qt="_selectedCompany_ii7aw_56",Wt="_selectedCompanyDetails_ii7aw_61",zt="_companyPhoto_ii7aw_67",Vt="_companyDesc_ii7aw_79",Qt="_companyNameTooltip_ii7aw_85",Yt="_companyName_ii7aw_85",Zt="_twoLineEllipsis_ii7aw_94",y={createProductBrandCard:Mt,cardContent:kt,uploadingBlockContainer:wt,uploadingItem:Dt,uploadingImageContainer:Gt,uploadingItemImage:Ot,uploadingItemTextBlock:Ut,loadingBlock:Rt,brandOwnerBlock:$t,brandOwnerSelect:Et,brandOwnerSelectTitle:Kt,selectedCompany:qt,selectedCompanyDetails:Wt,companyPhoto:zt,companyDesc:Vt,companyNameTooltip:Qt,companyName:Yt,twoLineEllipsis:Zt};function go({isLoading:c,isPhotoUploaderLoading:d,brand:s,selectedCompany:e,onAction:l}){const[n,P]=F.useState({}),L=F.useRef(null),{translate:B}=X();function I(){var b,v;const u=((b=L.current)==null?void 0:b.getSelectedFiles())||[],p=((v=L.current)==null?void 0:v.getUploadModels())||[],x={brandName:s.brandName,images:u,uploadModels:p};P(x),l==null||l("createProductBrand",x)}function N(){l==null||l("closeCreateProductBrandCard")}const C=()=>{var u;return c&&(n!=null&&n.images)?n.images:((u=L.current)==null?void 0:u.getSelectedFiles())||[]};return r.jsx(O,{className:y.createProductBrandCard,title:"Create Product Brand",titleTransKey:"CardTitles.CreateProductBrand",isLoading:c,showCloseButton:!0,onSecondaryButtonClick:N,children:r.jsxs("div",{className:y.cardContent,children:[r.jsx(M,{label:"Brand Name",labelTransKey:"ProductForm.Labels.BrandName",placeholder:"enter brand name...",placeholderTransKey:"ProductForm.Placeholders.BrandName",errorMessage:s==null?void 0:s.error,fullWidth:!0,onDelay:u=>l("checkBrandName",u)}),d?r.jsx("div",{className:y.uploadingBlockContainer,children:C().map((u,p)=>{const x=u instanceof File?URL.createObjectURL(u):u.result||u.path;return r.jsx("div",{className:"overflow-hidden rounded-md bg-secondary p-0 shadow-sm",children:r.jsxs("div",{className:`${y.uploadingItem} flex relative items-center justify-between p-2 pl-4`,children:[r.jsx("div",{className:y.uploadingImageContainer,children:r.jsx("img",{src:x,alt:`uploading-${u.name||`image-${p}`}`,className:y.uploadingItemImage,onLoad:()=>{u instanceof File&&URL.revokeObjectURL(x)}})}),r.jsxs("div",{className:y.uploadingItemTextBlock,children:[r.jsx("p",{className:"truncate text-sm",children:u.name||`${B("ProductForm.Labels.Image")} ${p+1}`}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[((u.size||0)/(1024*1024)).toFixed(2)," MB"]})]}),r.jsx(J,{className:y.loadingBlock})]})},u.name||p)})}):r.jsx(A,{isLoading:d,ref:L,contextName:"brand",contextId:s==null?void 0:s.brandId,fullWidth:!0,hideUploadButton:!0}),r.jsx($,{}),r.jsxs("div",{className:y.brandOwnerBlock,children:[r.jsxs("div",{className:y.brandOwnerSelect,children:[r.jsx("span",{className:`${y.brandOwnerSelectTitle} she-title`,children:"Brand owner"}),r.jsx(H,{variant:"secondary",icon:ut,value:"Select Company",onClick:()=>l("openSelectEntityCard")})]}),e&&r.jsx("div",{className:y.selectedCompany,children:r.jsxs("div",{className:y.selectedCompanyDetails,children:[r.jsx("div",{className:y.companyPhoto,children:e.thumbnailUrl?r.jsx("img",{src:e==null?void 0:e.thumbnailUrl,alt:e==null?void 0:e.companyName}):r.jsx(Ye,{icon:mt})}),r.jsxs("div",{className:y.companyDesc,children:[r.jsx(E,{delayDuration:200,text:e==null?void 0:e.companyName,className:y.companyNameTooltip,children:r.jsx("span",{className:`${y.companyName} she-text`,children:e==null?void 0:e.companyName})}),(e==null?void 0:e.address)&&r.jsx(E,{delayDuration:200,text:e==null?void 0:e.address,className:"max-w-[150px]",children:r.jsx("span",{className:`${y.twoLineEllipsis} she-text`,children:e==null?void 0:e.address})})]}),r.jsx(H,{icon:Ze,value:"Manage",valueTransKey:"CommonButtons.Manage",variant:"secondary",onClick:()=>l("manageCompany",e)})]})})]}),r.jsx($,{}),r.jsx(H,{value:"Add Brand",valueTransKey:"ProductActions.AddBrand",disabled:!(s!=null&&s.brandName)||!!(s!=null&&s.error),onClick:I})]})})}function Co(c){const d=K(q.PRODUCT_BASIC_DATA),s=K(q.PRODUCTS),e=Je(),l=pt(),{addToast:n}=gt(),P=Xe(),{t:L}=Ct(),{openConfirmationDialog:B}=Ae(),[I]=W.useLazyGenerateProductCodeQuery(),[N]=W.useCheckProductCodeMutation(),[C]=et.useLazyGetCountryCodeQuery(),[u]=_.useGetListOfCompaniesForGridMutation(),[p]=_.useCreateCompanyMutation(),[x]=z.useUploadPhotoMutation(),[b]=_.useAddNewLocationToCompanyMutation(),[v]=_.useLazyGetCompanyDetailsQuery(),[ee]=_.useDeleteCompanyMutation(),[U]=z.useDeletePhotoMutation(),[te]=_.useAddLocationToCompanyMutation(),[oe]=_.useUpdateCompanyDetailsMutation(),[ae]=_.useChangePositionOfCompanyPhotoMutation(),[re]=_.useChangePositionOfLocationPhotoMutation(),[ne]=_.useUpdateLocationDetailsMutation(),[se]=_.useDeleteLocationMutation();function de(t){s.products||(e(f.setIsItemsCardLoading(!0)),l.getTheProductsForGridHandler(t).then(()=>{e(f.setIsItemsCardLoading(!1))}))}function ie(){d.countryCodes.length===0&&C(void 0).then(t=>{e(o.refreshCountryCodes(t.data))})}function ce(){s.brands.length===0&&l.getSimpleListOfAllBrandsHandler()}function le(){s.categories.length===0&&l.getAllCategoriesByOrganizationHandler()}function ue(t){var a;t?(!s.productCounter||((a=s.product)==null?void 0:a.productId)!==t)&&(e(f.setIsProductMenuCardLoading(!0)),l.getCountersForProductsHandler(t).then(()=>{e(f.setIsProductMenuCardLoading(!1))})):e(f.refreshProductCounter({}))}function me(t){var a;t?(!s.product||((a=s.product)==null?void 0:a.productId)!==t)&&(e(o.setIsProductConfigurationCardLoading(!0)),l.getProductDetailsHandler(t).then(()=>{e(o.setIsProductConfigurationCardLoading(!1))})):e(f.refreshProduct({}))}function pe(t){l.itemCardHandler(t)}function ge(t,a){e(o.setIsProductConfigurationCardLoading(!0)),l.updateProductHandler(t,a).then(i=>{e(o.setIsProductConfigurationCardLoading(!1)),i.data?(e(f.refreshProduct(i.data)),s.product.productName!==a.productName&&l.getTheProductsForGridHandler(s.productsGridRequestModel,!0),n({text:"Product updated successfully",type:"success"})):n({text:"Product not updated",description:i.error.message,type:"error"})})}function Ce(t){e(o.setIsProductConfigurationCardLoading(!0)),l.createNewProductHandler(t).then(a=>{e(o.setIsProductConfigurationCardLoading(!1)),a.data?(e(f.refreshSelectedProduct(a.data)),l.getTheProductsForGridHandler(s.productsGridRequestModel),P(`${V.PRODUCTS}${V.PRODUCT_BASIC_DATA}/${a.data.productId}`),l.getTheProductsForGridHandler(s.productsGridRequestModel,!0),n({text:"Product created successfully",type:"success"})):n({text:`${a.error.data.detail}`,type:"error"})})}function fe(t,a){t?ge(t,a):Ce(a)}function ye(){P(tt.PRODUCTS)}function he(t){t&&l.checkCategoryNameHandler({categoryName:t}).then(a=>{a.error?e(f.refreshCategory({...d.category,error:a.error.data.detail})):e(f.refreshCategory({...d.category,categoryName:t}))})}function Ie(t){e(o.setIsCreateProductCategoryCardLoading(!0)),l.createNewCategoryHandler({categoryName:t.categoryName}).then(a=>{if(e(o.setIsCreateProductCategoryCardLoading(!1)),a.data){e(f.refreshCategories([...s.categories,a.data])),e(o.refreshSelectedCategory(a.data.categoryId)),e(f.setIsPhotoUploaderLoading(!0));const i=t.uploadModels.map(m=>(m.contextId=a.data.categoryId,l.uploadPhotoHandler(m)));Promise.all(i).then(m=>{m.forEach(g=>{var h;e(f.setIsPhotoUploaderLoading(!1)),g&&!g.error?(e(f.refreshCategory(null)),n({text:"Category created successfully",type:"success"})):n({text:(h=g==null?void 0:g.error)==null?void 0:h.data.detail,type:"error"})})}),c("createCategoryCard")}else n({text:`${a.error.data.detail}`,type:"error"})})}function Pe(t){t&&l.checkBrandNameHandler({brandName:t}).then(a=>{a.error?e(f.refreshBrand({...d.brand,error:a.error.data.detail})):e(f.refreshBrand({...d.brand,brandName:t,error:null}))})}function xe(t){e(o.setIsCreateProductBrandCardLoading(!0)),l.createBrandHandler({brandName:t.brandName,companyId:1289182989}).then(a=>{if(e(o.setIsCreateProductBrandCardLoading(!1)),a.data){if(e(f.refreshBrands([...s.brands,a.data])),t.uploadModels.length>0){e(f.setIsPhotoUploaderLoading(!0));const i=t.uploadModels.map(m=>(m.contextId=a.data.brandId,l.uploadPhotoHandler(m)));Promise.all(i).then(m=>{m.forEach(g=>{var h;e(f.setIsPhotoUploaderLoading(!1)),g&&!g.error?e(f.refreshBrand(null)):n({text:(h=g==null?void 0:g.error)==null?void 0:h.data.detail,type:"error"})})})}c("createBrandCard"),n({text:"Brand created successfully",type:"success"}),e(o.resetSelectedCompany())}else n({text:`${a.error.data.detail}`,type:"error"})})}function Le(t){l.uploadPhotoHandler(t).then(a=>{t.contextId?a.data.photoId?n({text:"Photos added successfully",type:"success"}):n({text:`${a.error.data.detail}`,type:"error"}):n({text:t.contextName==="brand"?"Create brand first":"Create category first",type:"error"})})}function Be(t){return I(null).then(a=>(e(t?f.refreshProduct({...s.product,productCode:a.data.code}):f.refreshProductCode(a.data.code)),a.data))}function Ne(t){return N(t).then(a=>(a.error?n({text:`${a.error.data.detail}`,type:"error"}):n({text:"Product code is available",type:"success"}),a.data))}function _e(){c("selectEntityCard",!0),e(o.setIsCompaniesGridLoading(!0)),u(d.companiesGridRequestModel).then(t=>{e(o.setIsCompaniesGridLoading(!1));const a=t.data.items.map(i=>{var m;return{...i,isSelected:i.companyId===((m=d.selectedCompany)==null?void 0:m.companyId)}});e(o.refreshCompaniesGridRequestModel({...t.data,items:a}))})}function ve(t){e(o.setIsCompaniesGridLoading(!0)),u({searchQuery:t}).then(a=>{e(o.setIsCompaniesGridLoading(!1)),e(o.refreshCompaniesGridRequestModel(a.data))})}function Se(t){c("selectEntityCard"),e(o.refreshSelectedCompany(t))}function je(){c("createCompanyCard",!0)}function be(){c("selectEntityCard")}function Te(t){e(o.setIsCreateCompanyCardLoading(!0)),p(t.company).then(a=>{a.error?n({text:a.error.details.message,type:"error"}):(t.image.uploadModels.map(i=>{i.contextId=a.data.companyId,e(o.setIsPhotoUploaderLoading(!0)),x(i).then(m=>{e(o.setIsPhotoUploaderLoading(!1)),n(m?{text:L("SuccessMessages.ImageAdded"),type:"success"}:{text:m.error.details.message,type:"error"})})}),b({companyId:a.data.companyId,model:t.address}).then(()=>{e(o.setIsCreateCompanyCardLoading(!1)),c("createCompanyCard"),e(o.setIsCompaniesGridLoading(!0)),u(d.companiesGridRequestModel).then(i=>{e(o.setIsCompaniesGridLoading(!1));const m=i.data.items.map(g=>{var h;return{...g,isSelected:g.companyId===((h=d.selectedCompany)==null?void 0:h.companyId)}});e(o.refreshCompaniesGridRequestModel({...i.data,items:m}))})}),n({text:"Company created successfully",type:"success"}))})}function Fe(){c("createCompanyCard")}function He(t){c("companyConfigurationCard",!0),e(o.setIsCompanyConfigurationCardLoading(!0)),e(o.setIsLocationsGridLoading(!0)),v(t.companyId).then(a=>{e(o.setIsCompanyConfigurationCardLoading(!1)),e(o.setIsLocationsGridLoading(!1)),e(o.refreshManagedCompany(a.data))})}async function Me(t){await B({headerTitle:"Deleting company",text:`You are about to delete company ${t.companyName}.`,primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&(e(o.setIsCompanyConfigurationCardLoading(!0)),ee(t.companyId).then(i=>{if(i.error){n({text:"Failed to delete company",type:"error"});return}else n({text:"Company deleted successfully",type:"info"}),c("companyConfigurationCard"),e(o.setIsCompanyConfigurationCardLoading(!1)),e(o.setIsLocationsGridLoading(!1)),e(o.resetManagedCompany()),e(o.setIsCompaniesGridLoading(!0)),u(d.companiesGridRequestModel).then(m=>{e(o.setIsCompaniesGridLoading(!1));const g=m.data.items.map(h=>{var R;return{...h,isSelected:h.companyId===((R=d.selectedCompany)==null?void 0:R.companyId)}});e(o.refreshCompaniesGridRequestModel({...m.data,items:g}))}),d.selectedCompany.companyId===d.managedCompany.companyId&&e(o.resetSelectedCompany())}))}function ke(){c("companyConfigurationCard"),e(o.resetManagedCompany())}function we(){c("companyPhotosCard",!0)}function De(t){e(o.setIsCompanyConfigurationCardLoading(!0)),oe({companyId:d.managedCompany.companyId,model:t}).then(a=>{e(o.setIsCompanyConfigurationCardLoading(!1)),a.error?n({text:"Failed to update company",type:"error"}):(e(o.refreshManagedCompany(a.data)),e(o.setIsCompaniesGridLoading(!0)),u(d.companiesGridRequestModel).then(i=>{e(o.setIsCompaniesGridLoading(!1));const m=i.data.items.map(g=>{var h;return{...g,isSelected:g.companyId===((h=d.selectedCompany)==null?void 0:h.companyId)}});e(o.refreshCompaniesGridRequestModel({...i.data,items:m}))}),n({text:"Company updated successfully",type:"success"}))})}async function Ge(t){await B({headerTitle:"Deleting company photo",text:"You are about to delete company photo.",primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&(e(o.setIsCompaniesGridLoading(!0)),U(t.photoId).then(i=>{e(o.setIsCompaniesGridLoading(!1));const m=d.managedCompany.photos.filter(g=>g.photoId!==t.photoId);e(o.refreshManagedCompany({...d.managedCompany,photos:m})),i.error?n({text:"Photo not deleted",description:i.error.details.message,type:"error"}):n({text:"Photo deleted successfully",type:"success"})}))}function Oe(t){return e(o.setIsPhotoUploaderLoading(!0)),x(t).then(a=>{var i;return e(o.setIsPhotoUploaderLoading(!1)),a.error?(n({text:((i=a.error.data)==null?void 0:i.detail)||"Upload failed",type:"error"}),a):(a.data.photoId&&(t.contextName==="Company"?e(o.refreshManagedCompany({...d.managedCompany,photos:[...d.managedCompany.photos||[],a.data]})):e(o.refreshManagedLocation({...d.managedLocation,photos:[...d.managedLocation.photos||[],a.data]}))),n({text:"Photos added successfully",type:"success"}),a)})}function Ue(t){switch(t.contextName){case"Company":ae({companyId:d.managedCompany.companyId,photoId:t.activeItem.photoId,index:t.newIndex}).then(a=>{a.error||(v(d.managedCompany.companyId).then(i=>{e(o.refreshManagedCompany(i.data))}),(t.newIndex===0||t.oldIndex===0)&&(e(o.setIsSelectEntityCardLoading(!0)),e(o.setIsCompaniesGridLoading(!0)),u(d.companiesGridRequestModel).then(i=>{e(o.setIsSelectEntityCardLoading(!1)),e(o.setIsCompaniesGridLoading(!1));const m=i.data.items.map(g=>{var h;return{...g,isSelected:g.companyId===((h=d.selectedCompany)==null?void 0:h.companyId)}});e(o.refreshCompaniesGridRequestModel({...i.data,items:m}))})))});break;case"Location":re({locationId:d.managedLocation.locationId,photoId:t.activeItem.photoId,index:t.newIndex}).then(a=>{a.error||v(d.managedCompany.companyId).then(i=>{e(o.refreshManagedCompany(i.data))})});break}}function Re(t){console.log("NAME",t),c(t==="Company"?"companyPhotosCard":"locationPhotosCard")}function $e(t){c("locationConfigurationCard",!0),e(t?o.refreshManagedLocation(t):o.resetManagedLocation())}function Ee(t){e(o.setIsLocationConfigurationCardLoading(!0)),te({companyId:d.managedCompany.companyId,model:t}).then(a=>{var i;a.error?n({text:(i=a.error.data)==null?void 0:i.detail,type:"error"}):(c("locationConfigurationCard"),e(o.setIsCompanyConfigurationCardLoading(!0)),e(o.setIsLocationsGridLoading(!0)),v(d.managedCompany.companyId).then(m=>{e(o.setIsCompanyConfigurationCardLoading(!1)),e(o.setIsLocationsGridLoading(!1)),e(o.refreshManagedCompany(m.data))}),n({text:"Location added successfully",type:"success"}))})}function Ke(t){e(o.setIsLocationConfigurationCardLoading(!0)),se(t.locationId).then(a=>{var i;a.error?n({text:(i=a.error.data)==null?void 0:i.detail,type:"error"}):(c("locationConfigurationCard"),e(o.setIsCompanyConfigurationCardLoading(!0)),e(o.setIsLocationsGridLoading(!0)),v(d.managedCompany.companyId).then(m=>{e(o.setIsCompanyConfigurationCardLoading(!1)),e(o.setIsLocationsGridLoading(!1)),e(o.refreshManagedCompany(m.data))}),n({text:"Location deleted successfully",type:"success"}))})}function qe(t){e(o.setIsLocationConfigurationCardLoading(!0)),ne({locationId:d.managedLocation.locationId,model:t}).then(a=>{e(o.setIsLocationConfigurationCardLoading(!1)),a.error?n({text:"Failed to update location",type:"error"}):(e(o.setIsCompanyConfigurationCardLoading(!0)),v(d.managedCompany.companyId).then(i=>{e(o.setIsCompanyConfigurationCardLoading(!1)),e(o.refreshManagedCompany(i.data))}),n({text:"Location updated successfully",type:"success"}))})}function We(){c("locationConfigurationCard"),e(o.resetManagedLocation())}async function ze(t){await B({headerTitle:"Deleting location photo",text:"You are about to delete location photo.",primaryButtonValue:"Delete",secondaryButtonValue:"Cancel"})&&U(t.photoId).then(i=>{const m=d.managedLocation.photos.filter(g=>g.photoId!==t.photoId);e(o.refreshManagedLocation({...d.managedLocation,photos:m})),i.error?n({text:"Photo not deleted",description:i.error.details.message,type:"error"}):n({text:"Photo deleted successfully",type:"success"})})}function Ve(){c("locationPhotosCard",!0)}return{state:d,productsState:s,productsService:l,getProductsHandler:de,getCategoriesHandler:ce,getCountryCodesHandler:ie,getBrandsHandler:le,getCountersForProductsHandler:ue,getProductDetailsHandler:me,itemCardClickHandler:pe,gotoProductsPageHandler:ye,onSubmitProductDataHandler:fe,checkCategoryNameHandler:he,createNewCategoryHandler:Ie,checkBrandNameHandler:Pe,createBrandHandler:xe,uploadCategoryOrBrandPhotoHandler:Le,generateProductCodeHandler:Be,checkProductCodeHandler:Ne,openSelectEntityCardHandler:_e,searchEntityHandler:ve,selectCompanyHandler:Se,openCreateEntityCardHandler:je,closeSelectEntityCardHandler:be,createCompanyHandler:Te,closeCreateCompanyCardHandler:Fe,manageCompanyHandler:He,deleteCompanyHandler:Me,closeCompanyConfigurationCardHandler:ke,manageCompanyPhotosHandler:we,updateCompanyHandler:De,deleteCompanyPhotoHandler:Ge,uploadPhotoHandler:Oe,changePhotoPositionHandler:Ue,closePhotosCardHandler:Re,openLocationConfigurationCardHandler:$e,createLocationHandler:Ee,deleteLocationHandler:Ke,updateLocationHandler:qe,closeLocationConfigurationCardHandler:We,deleteLocationPhotoHandler:ze,manageLocationPhotosHandler:Ve}}export{po as C,mo as P,go as a,Co as u};
