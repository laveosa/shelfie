import{j as s,m as E,a4 as D,n as h,a5 as C,i as A,d as f,S as g,b as G,p as H,a0 as O,U as x,a6 as t,N as u,Z as S,$ as N,a7 as T,r as _}from"./index-INVZ2mfS.js";import{S as w}from"./SheGrid-CoCGh6o9.js";import{u as j,I as z}from"./useAppTranslation-C--sAUS3.js";import{G as I,a as V}from"./GridSortingEnum-Qa64oiYF.js";import{P as b}from"./settings-2-DGAFnTaZ.js";import"./SheSelect-BRn8vwzs.js";import"./select-B-GdMVMV.js";import"./chevron-up-dtAOjP7D.js";import"./SheInput-cl4k9nFE.js";const k="_CustomersPage_1hy8j_1",F="_pageHeader_1hy8j_1",L="_customersPageContent_1hy8j_9",p={CustomersPage:k,pageHeader:F,customersPageContent:L};function $(o){const{translate:a}=j();return[{accessorKey:"customerId",header:"ID",minSize:40,maxSize:40,cell:({row:e})=>s.jsx("span",{className:"she-text",children:e.getValue("customerId")})},{id:"customerName",accessorFn:e=>e.customerName,header:"Customer",minSize:150,cell:({row:e})=>{const r=e.original.thumbnailUrl;return s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(E,{icon:r||z,className:"m-auto",style:{...!r&&{padding:"10px"}},minWidth:"40px",maxWidth:"40px",color:"#64748b",iconView:D.BUTTON}),s.jsx(h,{delayDuration:200,text:e.getValue("customerName"),className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:s.jsx("span",{className:"she-text",children:e.getValue("customerName")})})]})}},{accessorKey:"email",header:"Email",minSize:100,cell:({row:e})=>s.jsx(h,{delayDuration:200,text:e.original.email,className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:s.jsx("span",{className:"she-text",children:e.original.email})})},{accessorKey:"phoneNumber",header:"Phone",minSize:100,cell:({row:e})=>s.jsx(h,{delayDuration:200,text:e.getValue("phoneNumber"),className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:s.jsx("span",{className:"she-text",children:e.getValue("phoneNumber")})})},{accessorKey:"rank",header:"Rank",minSize:100,cell:({row:e})=>s.jsx("span",{className:"she-text",children:e.getValue("rank")})},{accessorKey:"createdAt",header:"Created At",minSize:150,maxSize:150,cell:({row:e})=>{const r=e.getValue("createdAt"),i=C(r,"dd-mm-yyyy hh:mm","No Date");return s.jsx("span",{className:"she-text",children:i})}},{accessorKey:"lastOrderDate",header:"Last Order Date",minSize:150,maxSize:150,cell:({row:e})=>{const r=e.getValue("lastOrderDate"),i=C(r,"dd-mm-yyyy hh:mm","No Orders");return s.jsx("span",{className:"she-text",children:i})}},{id:"manage",header:"",minSize:100,maxSize:100,cell:({row:e})=>s.jsx(A,{value:a("CommonButtons.Manage"),onClick:()=>o("manageCustomer",e.original)})}]}const q={addressesAmount:void 0,openCartsAmount:void 0,ordersAmount:void 0};function P(o){return{...q,...o}}function K(){const o=f(g.CUSTOMERS),a=f(g.APP),e=G(),r=H(),[i]=O.useGetCustomersForGridMutation(),[l]=x.useUpdateUserPreferencesMutation(),[m]=x.useResetUserPreferencesMutation();function d(n){return e(t.setIsCustomersLoading(!0)),i(n).then(c=>{e(t.setIsCustomersLoading(!1)),c.error||(e(t.refreshCustomersGridRequestModel(c.data)),e(t.refreshCustomers(c.data.items)))})}function v(n){e(t.refreshSelectedCustomer(n)),e(t.refreshCustomerCounter(P())),e(t.refreshCustomerAddresses(null)),e(t.refreshCustomerAddressesGridRequestModel({})),r(`${u.CUSTOMERS}${u.CUSTOMER_BASIC_DATA}/${n.id}`)}function y(){e(t.refreshCustomerCounter(P())),e(t.resetSelectedCustomer()),r(`${u.CUSTOMERS}${u.CUSTOMER_BASIC_DATA}`)}function U(n){const c=S.merge({},a.preferences,n);return e(N.refreshPreferences(c)),l(n)}function R(n){const c=S.merge({},a.preferences,{viewsReferences:{customerReferences:T.viewsReferences.customerReferences}});return e(N.refreshPreferences(c)),m(n).catch(M=>{console.error("Failed to reset preferences on server:",M)})}return{state:o,appState:a,getCustomersForGridHandler:d,onManageCustomerHandler:v,onCreateCustomerHandler:y,updateUserPreferencesHandler:U,resetUserPreferencesHandler:R}}function re(){const{translate:o}=j(),{state:a,appState:e,...r}=K(),i=Object.values(I).map(m=>({value:m,description:V[m]}));_.useEffect(()=>{r.getCustomersForGridHandler(a.customersGridRequestModel)},[]);function l(m,d){switch(m){case"manageCustomer":r.onManageCustomerHandler(d);break}}return s.jsxs("div",{className:p.CustomersPage,children:[s.jsxs("div",{className:p.pageHeader,children:[s.jsx("span",{className:"she-title",children:o("PageTitles.Customers")}),s.jsx("div",{children:s.jsx(A,{value:o("CustomerActions.CreateCustomer"),icon:b,variant:"info",onClick:r.onCreateCustomerHandler})})]}),s.jsx("div",{className:p.customersPageContent,children:s.jsx(w,{gridRequestModel:a.customersGridRequestModel,columns:$(l),sortingItems:i,columnsPreferences:e.preferences,preferenceContext:"customerReferences",isLoading:a.isCustomersLoading,skeletonQuantity:10,onApplyColumns:r.updateUserPreferencesHandler,onDefaultColumns:()=>r.resetUserPreferencesHandler("Customers"),onGridRequestChange:r.getCustomersForGridHandler})})]})}export{re as CustomersPage};
