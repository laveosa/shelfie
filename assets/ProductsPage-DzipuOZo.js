import{j as a,m as j,a4 as y,n as m,h as O,i as p,r as $,K as w,aa as L,ab as H}from"./index-BgQa47gg.js";import{u as E,S}from"./SheGrid-uzkyOZng.js";import{S as U,T as W,a as C,b as v}from"./SheTabs-CmJ18ghj.js";import{u as b,I as f}from"./useAppTranslation-WsuOvhO_.js";import{T as P,L as Q,R as J,B as R}from"./trash-hroypMYd.js";import{a as X,b as Y}from"./SheSelect-Bemnzgzd.js";import{G as Z}from"./GridDateRangeFilter-CNnfi_uO.js";import{S as ee}from"./SheInput-DR7d3r4D.js";import{G as N}from"./GridItemsFilter-0hHhSWEH.js";import{G as D}from"./GridShowItemsFilter-Drwb8gi3.js";import{G as F}from"./GridTraitsFilter-DpkiGv98.js";import{u as ae}from"./useProductsPageService-DGJ-kwCH.js";import{G as te,a as se}from"./GridSortingEnum-Qa64oiYF.js";import{P as q}from"./settings-2-BTVyb-Qp.js";import"./chevron-up-BnFDI10H.js";import"./select-54-gfLzT.js";import"./SheDatePicker-CydyV-z_.js";import"./useToast-Ddu7z5Z2.js";const re="_ProductsPage_wombk_1",ie="_pageHeader_wombk_1",ce="_productsPageContent_wombk_9",ne="_tabItemsWrapper_wombk_9",oe="_tabItems_wombk_9",le="_tabItemTrigger_wombk_19",de="_tabBlock_wombk_26",ue="_productsPageTabContext_wombk_33",l={ProductsPage:re,pageHeader:ie,productsPageContent:ce,tabItemsWrapper:ne,tabItems:oe,tabItemTrigger:le,tabBlock:de,productsPageTabContext:ue};function me(n){const{translate:r}=b();return[{accessorKey:"purchaseId",header:"ID",minSize:40,maxSize:40,cell:({row:i})=>a.jsx("span",{className:"she-text",children:i.getValue("purchaseId")})},{id:"supplier",accessorFn:i=>i.supplier,header:"Supplier",minSize:150,maxSize:200,cell:({row:i})=>{const t=i.getValue("supplier");return a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(j,{icon:t.thumbnailUrl||f,className:"m-auto",style:{...!t.thumbnailUrl&&{padding:"10px"}},minWidth:"40px",maxWidth:"40px",color:"#64748b",iconView:y.BUTTON}),a.jsx(m,{delayDuration:200,text:t.supplierName,className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:a.jsx("span",{className:"she-text",children:t.supplierName})})]})}},{accessorKey:"location",header:"Location",minSize:50,maxSize:200,cell:({row:i})=>{var t,e;return a.jsx(m,{delayDuration:200,text:(t=i.original.location)==null?void 0:t.address,className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:a.jsx("span",{className:"she-text",children:(e=i.original.location)==null?void 0:e.address})})}},{accessorKey:"documentNotes",header:"Notes",minSize:100,cell:({row:i})=>a.jsx(m,{delayDuration:200,text:i.getValue("documentNotes"),className:"max-w-[100%] overflow-hidden text-ellipsis whitespace-nowrap",children:a.jsx("span",{className:"she-text",children:i.getValue("documentNotes")})})},{accessorKey:"date",header:"Date",minSize:100,maxSize:100,cell:({row:i})=>a.jsx("span",{className:"she-text",children:O(i.getValue("date"),"date")})},{accessorKey:"unitsAmount",header:"Units",minSize:70,maxSize:100,cell:({row:i})=>a.jsx("span",{className:"she-text",children:`${i.getValue("unitsAmount")} ${i.getValue("unitsAmount")===1?"unit":"units"}`})},{accessorKey:"expense",header:"Expense",minSize:70,maxSize:100,cell:({row:i})=>a.jsx("span",{className:"she-text",children:`${i.getValue("expense")} ${i.original.currencyBrief}`})},{accessorKey:"soldAmount",header:"Sold",minSize:70,maxSize:100,cell:({row:i})=>a.jsx("span",{className:"she-text",children:`${i.getValue("soldAmount")} ${i.original.currencyBrief}`})},{accessorKey:"valueAmount",header:"Order Value",minSize:80,maxSize:100,cell:({row:i})=>a.jsx("span",{className:"she-text",children:`${i.getValue("valueAmount")} ${i.original.currencyBrief}`})},{id:"manage",header:"",minSize:100,maxSize:100,cell:({row:i})=>a.jsx(p,{value:r("CommonButtons.Manage"),onClick:()=>n("managePurchase",i.original)})},{id:"rowActions",header:"",minSize:56,maxSize:56,cell:({row:i,table:t})=>a.jsx(p,{icon:P,variant:"secondary",onClick:()=>n("deletePurchase",{table:t,row:i})})}]}const pe="_productName_10cd0_1",he="_productCode_10cd0_10",ge="_productCategory_10cd0_19",xe="_productBrand_10cd0_20",Ne="_productStatus_10cd0_40",be="_productStatusAvailable_10cd0_49",Se="_productStatusNotAvailable_10cd0_55",h={productName:pe,productCode:he,productCategory:ge,productBrand:xe,productStatus:Ne,productStatusAvailable:be,productStatusNotAvailable:Se};function Ce(n){const{translate:r}=b(),i=t=>t==="Available"?h.productStatusAvailable:t==="Not Available"?h.productStatusNotAvailable:"";return[{accessorKey:"productId",header:"ID",minSize:40,maxSize:40,cell:({row:t})=>a.jsx("span",{className:"she-text",children:t.getValue("productId")})},{accessorKey:"image",header:"Image",minSize:56,maxSize:56,cell:({row:t})=>{const e=t.getValue("image");return a.jsx(j,{icon:(e==null?void 0:e.thumbnailUrl)||f,className:"m-auto",style:{...!(e!=null&&e.thumbnailUrl)&&{padding:"10px"}},color:"#64748b",iconView:y.BUTTON})}},{accessorKey:"productCode",header:"Code",minSize:60,cell:({row:t})=>a.jsx(m,{delayDuration:200,text:t.getValue("productCode"),children:a.jsx("span",{className:`${h.productCode} she-text`,children:t.getValue("productCode")})})},{accessorKey:"productName",header:"Product Name",minSize:150,cell:({row:t})=>a.jsx(m,{delayDuration:200,text:t.getValue("productName"),children:a.jsx("span",{className:`${h.productName} she-text`,children:t.getValue("productName")})})},{accessorKey:"productCategory",header:"Category",minSize:100,cell:({row:t})=>{var d,c;const e=t.getValue("productCategory");return a.jsx(m,{delayDuration:200,text:(e==null?void 0:e.categoryName)||"N/A",children:a.jsxs("div",{className:h.productCategory,children:[((d=t.original.productCategory)==null?void 0:d.thumbnail)&&a.jsx("img",{src:(c=t.original.productCategory)==null?void 0:c.thumbnail,alt:t.original.productCategory.categoryName}),a.jsx("span",{className:"she-text",children:(e==null?void 0:e.categoryName)||"N/A"})]})})}},{accessorKey:"brand",header:"Brand",minSize:100,cell:({row:t})=>{const e=t.original.brand;return a.jsx(m,{delayDuration:200,text:(e==null?void 0:e.brandName)||"N/A",children:a.jsxs("div",{className:h.productBrand,children:[(e==null?void 0:e.thumbnail)&&a.jsx("img",{src:e==null?void 0:e.thumbnail,alt:e==null?void 0:e.brandName}),a.jsx("span",{className:"she-text",children:(e==null?void 0:e.brandName)||"N/A"})]})})}},{accessorKey:"barcode",header:"Barcode",minSize:40,cell:({row:t})=>a.jsx("span",{className:"she-text",children:t.getValue("barcode")})},{accessorKey:"status",header:"Status",minSize:120,cell:({row:t})=>a.jsx("div",{className:`${h.productStatus} ${i(t.getValue("status"))}`,children:a.jsx("span",{children:t.getValue("status")})})},{accessorKey:"salePrice",header:"Sale Price",minSize:80,cell:({row:t})=>{const e=t.getValue("salePrice");return a.jsx("span",{className:"she-text",children:e||"N/A"})}},{accessorKey:"variantsCount",header:"Variants",minSize:80,cell:({row:t})=>a.jsx("span",{className:"she-text",children:t.getValue("variantsCount")})},{accessorKey:"stockAmount",header:"Stock",minSize:60,cell:({row:t})=>a.jsx("span",{className:"she-text",children:`${t.getValue("stockAmount")} ${t.getValue("stockAmount")===1?"unit":"units"}`})},{accessorKey:"isActive",header:"Active",minSize:80,maxSize:160,cell:({row:t})=>a.jsx(X,{checked:t.original.isActive,type:Y.SWITCH,onChecked:()=>n("activateProduct",t.original)})},{id:"manage",header:"",minSize:100,maxSize:100,cell:({row:t})=>a.jsx(p,{value:r("CommonButtons.Manage"),onClick:()=>n("manageProduct",t.original.productId)})},{id:"rowActions",header:"",minSize:56,maxSize:56,cell:({row:t,table:e})=>a.jsx(p,{icon:P,variant:"secondary",onClick:()=>n("deleteProduct",{table:e,row:t})})}]}const ve="_variantName_m9a9h_1",je="_variantCode_m9a9h_1",ye="_productCategory_m9a9h_10",fe="_productStatus_m9a9h_28",Pe="_productStatusAvailable_m9a9h_36",Ae="_productStatusNotAvailable_m9a9h_42",g={variantName:ve,variantCode:je,productCategory:ye,productStatus:fe,productStatusAvailable:Pe,productStatusNotAvailable:Ae};function ze(n){const{translate:r}=b(),i=t=>t==="Available"?g.productStatusAvailable:t==="Not Available"?g.productStatusNotAvailable:"";return[{accessorKey:"variantId",header:"ID",minSize:40,maxSize:40,cell:({row:t})=>a.jsx("span",{className:"she-text",children:t.getValue("variantId")})},{accessorKey:"photo",header:"Image",minSize:56,maxSize:56,cell:({row:t})=>{const e=t.getValue("photo");return a.jsx(j,{icon:(e==null?void 0:e.thumbnailUrl)||f,className:"m-auto",style:{...!(e!=null&&e.thumbnailUrl)&&{padding:"10px"}},color:"#64748b",iconView:y.BUTTON})}},{accessorKey:"variantCode",header:"Code",minSize:60,cell:({row:t})=>a.jsx(m,{delayDuration:200,text:t.getValue("variantCode"),children:a.jsx("span",{className:`${g.variantCode} she-text`,children:t.getValue("variantCode")})})},{accessorKey:"variantName",header:"Variant Name",minSize:150,cell:({row:t})=>a.jsx(m,{delayDuration:200,text:t.getValue("variantName"),children:a.jsx("span",{className:`${g.variantName} she-text`,children:t.getValue("variantName")})})},{accessorKey:"productCategory",header:"Category",minSize:100,cell:({row:t})=>{var d,c;const e=t.getValue("productCategory");return a.jsx(m,{delayDuration:200,text:(e==null?void 0:e.categoryName)||"N/A",children:a.jsxs("div",{className:g.productCategory,children:[((d=t.original.productCategory)==null?void 0:d.thumbnail)&&a.jsx("img",{src:(c=t.original.productCategory)==null?void 0:c.thumbnail,alt:t.original.productCategory.categoryName}),a.jsx("span",{className:"she-text",children:(e==null?void 0:e.categoryName)||"N/A"})]})})}},{accessorKey:"brand",header:"Brand",minSize:100,cell:({row:t})=>{const e=t.original.brand;return a.jsx(m,{delayDuration:200,text:(e==null?void 0:e.brandName)||"N/A",children:a.jsxs("div",{className:g.productCategory,children:[(e==null?void 0:e.thumbnail)&&a.jsx("img",{src:e==null?void 0:e.thumbnail,alt:e==null?void 0:e.brandName}),a.jsx("span",{className:"she-text",children:(e==null?void 0:e.brandName)||"N/A"})]})})}},{accessorKey:"traitOptions",header:"Details",minSize:80,maxSize:80,cell:({row:t})=>{const e=t.original.traitOptions||[],d=e.filter(u=>u.traitTypeId===2&&u.optionColor),c=e.filter(u=>u.traitTypeId===1&&u.optionName);return a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",maxWidth:"50px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"middle"},children:[d.map((u,x)=>a.jsx("div",{style:{background:u.optionColor,minWidth:"20px",minHeight:"20px",borderRadius:"50%",border:"2px solid #ccc"}},`color-${x}`)),c.map((u,x)=>a.jsx("span",{style:{fontSize:"0.875rem"},className:"she-text",children:u.optionName},`size-${x}`))]})}},{accessorKey:"status",header:"Status",minSize:120,cell:({row:t})=>a.jsx("div",{className:`${g.productStatus} ${i(t.getValue("status"))}`,children:a.jsx("span",{children:t.getValue("status")})})},{accessorKey:"salePrice",header:"Price",minSize:80,cell:({row:t})=>{const e=t.getValue("salePrice");return a.jsx("span",{className:"she-text",children:e||"N/A"})}},{accessorKey:"stockAmount",header:"In Stock",minSize:60,cell:({row:t})=>a.jsx("span",{className:"she-text",children:`${t.getValue("stockAmount")} ${t.getValue("stockAmount")===1?"unit":"units"}`})},{id:"manage",header:"",minSize:100,maxSize:100,cell:({row:t})=>a.jsx(p,{value:r("CommonButtons.Manage"),onClick:()=>n("manageVariant",t.original)})},{id:"rowActions",header:"",minSize:56,maxSize:56,cell:({row:t,table:e})=>a.jsx(p,{icon:P,variant:"secondary",onClick:()=>n("deleteVariant",{table:e,row:t})})}]}function M({fieldKey:n,icon:r,placeholder:i}){const{gridRequestModel:t,onGridRequestChange:e}=E();return a.jsx(ee,{icon:r,placeholder:i,maxWidth:"200px",showClearBtn:!0,onDelay:d=>{e==null||e({...t,currentPage:0,filter:{...t==null?void 0:t.filter,[n]:d}})},onClear:()=>{e==null||e({...t,currentPage:0,filter:{...t==null?void 0:t.filter,[n]:null}})}})}function Ee(){var u,x,A,z,_,V,I,k,T,G,K,B;const{translate:n}=b(),{state:r,appState:i,dispatch:t,...e}=ae(),d=Object.values(te).map(s=>({value:s,description:se[s]}));$.useEffect(()=>{r.activeTab==="products"?e.getTheProductsForGridHandler(r.productsGridRequestModel):r.activeTab==="variants"?e.getVariantsForGridHandler(r.variantsGridRequestModel):r.activeTab==="purchases"&&e.getListOfPurchasesForGridHandler(r.purchasesGridRequestModel),t(w.resetSelectedVariant())},[r.activeTab,t]),$.useEffect(()=>{r.brands.length===0&&e.getBrandsForFilterHandler(),r.categories.length===0&&e.getCategoriesForFilterHandler(),(r.sizesForFilter.length===0||r.colorsForFilter.length===0)&&e.getTraitsForFilterHandler(),e.getCompaniesListHandler()},[]);function c(s,o){switch(s){case"activateProduct":e.activateProductHandler(o);break;case"activateVariant":e.activateVariantActionHandler(o);break;case"manageProduct":e.manageProductActionHandler(o);break;case"manageVariant":e.manageVariantActionHandler(o.variantId,o.productId);break;case"managePurchase":e.managePurchaseActionHandler(o==null?void 0:o.purchaseId);break;case"deleteProduct":e.deleteProductActionHandler(o);break;case"deleteVariant":e.deleteVariantActionHandler(o);break;case"deletePurchase":e.deletePurchaseActionHandler(o);break;case"addProduct":e.addProductActionHandler();break;case"reportPurchase":e.reportPurchaseActionHandler();break;case"gridRequestChange":e.gridRequestChangeHandler(o);break;case"applyColumns":e.applyColumnsActionHandler(o);break;case"resetColumns":e.resetColumnsActionHandler();break;case"tabChange":e.tabChangeActionHandler(o);break}}return a.jsxs("div",{className:l.ProductsPage,children:[a.jsxs("div",{className:l.pageHeader,children:[a.jsx("span",{className:"she-title",children:n("PageTitles.Products")}),r.activeTab==="purchases"?a.jsx("div",{children:a.jsx(p,{value:n("SupplierActions.ReportPurchase"),icon:q,variant:"info",onClick:()=>c("reportPurchase")})}):a.jsx("div",{children:a.jsx(p,{icon:q,variant:"info",onClick:()=>c("addProduct"),value:n("ProductActions.AddProduct")})})]}),a.jsx("div",{className:l.productsPageContent,children:a.jsxs(U,{defaultValue:r.activeTab,onValueChange:s=>c("tabChange",s),children:[a.jsx("div",{className:l.tabItemsWrapper,children:a.jsxs(W,{className:l.tabItems,children:[a.jsx(C,{className:l.tabItemTrigger,value:"products",children:a.jsxs("div",{className:l.tabBlock,children:[a.jsx(L,{size:"16"})," ",n("TabContent.Products")]})}),a.jsx(C,{className:l.tabItemTrigger,value:"variants",children:a.jsxs("div",{className:l.tabBlock,children:[a.jsx(Q,{size:"16"})," ",n("TabContent.Variants")]})}),a.jsx(C,{className:l.tabItemTrigger,value:"purchases",children:a.jsxs("div",{className:l.tabBlock,children:[a.jsx(J,{size:"16"})," ",n("TabContent.Purchases")]})})]})}),a.jsx(v,{value:"products",className:l.productsPageTabContext,children:a.jsxs(S,{gridRequestModel:r.productsGridRequestModel,columns:Ce(c),sortingItems:d,columnsPreferences:i.preferences,preferenceContext:"productReferences",isLoading:r.isLoading,skeletonQuantity:10,onApplyColumns:s=>c("applyColumns",s),onDefaultColumns:()=>c("resetColumns"),onGridRequestChange:s=>c("gridRequestChange",s),children:[a.jsx(N,{items:r.brands,columnName:"Brands",getId:s=>s.brandId,getName:s=>s.brandName,selected:(x=(u=r.productsGridRequestModel)==null?void 0:u.filter)==null?void 0:x.brands}),a.jsx(N,{items:r.categories,columnName:"Categories",getId:s=>s.categoryId,getName:s=>s.categoryName,selected:(z=(A=r.productsGridRequestModel)==null?void 0:A.filter)==null?void 0:z.categories}),a.jsx(D,{context:"Deleted"})]})}),a.jsx(v,{value:"variants",className:l.productsPageTabContext,children:a.jsxs(S,{gridRequestModel:r.variantsGridRequestModel,columns:ze(c),sortingItems:d,columnsPreferences:i.preferences,preferenceContext:"variantReferences",isLoading:r.isLoading,skeletonQuantity:10,onApplyColumns:s=>c("applyColumns",s),onDefaultColumns:()=>c("resetColumns"),onGridRequestChange:s=>c("gridRequestChange",s),children:[a.jsx(N,{items:r.brands,columnName:"Brands",getId:s=>s.brandId,getName:s=>s.brandName,selected:(V=(_=r.variantsGridRequestModel)==null?void 0:_.filter)==null?void 0:V.brands}),a.jsx(N,{items:r.categories,columnName:"Categories",getId:s=>s.categoryId,getName:s=>s.categoryName,selected:(k=(I=r.variantsGridRequestModel)==null?void 0:I.filter)==null?void 0:k.categories}),a.jsx(F,{traitOptions:r.colorsForFilter,traitType:"color"}),a.jsx(F,{traitOptions:r.sizesForFilter,traitType:"size"}),a.jsx(D,{context:"Deleted"})]})}),a.jsx(v,{value:"purchases",className:l.productsPageTabContext,children:a.jsxs(S,{gridRequestModel:r.purchasesGridRequestModel,columns:me(c),sortingItems:d,columnsPreferences:i.preferences,preferenceContext:"purchaseReferences",isLoading:r.isLoading,skeletonQuantity:10,onApplyColumns:s=>c("applyColumns",s),onDefaultColumns:()=>c("resetColumns"),onGridRequestChange:s=>c("gridRequestChange",s),children:[a.jsx(N,{items:r.companies,columnName:"Suppliers",icon:R,getId:s=>s.companyId,getName:s=>s.companyName,selected:(G=(T=r.purchasesGridRequestModel)==null?void 0:T.filter)==null?void 0:G.suppliers}),a.jsx(Z,{}),a.jsx(N,{items:r.brands,columnName:"Brands",icon:R,getId:s=>s.brandId,getName:s=>s.brandName,selected:(B=(K=r.purchasesGridRequestModel)==null?void 0:K.filter)==null?void 0:B.brands}),a.jsx(M,{icon:H,placeholder:"Value from",fieldKey:"valueFrom"}),a.jsx(M,{icon:H,placeholder:"Value to",fieldKey:"valueTo"})]})})]})})]})}export{Ee as ProductsPage};
