import{j as e,D as X,r as b,as as Y,i as f,m as M,n as B,C as Z,_ as ee}from"./index-B43MI0p9.js";import{S as $}from"./SheFileUploader-C080oLwN.js";import{a as ae}from"./AddressForm-Ppz6MO7i.js";import{S as F}from"./SheCard-BEJVnwk7.js";import{c as S}from"./she-select-convertors-CdG-Ygpu.js";import{P as G}from"./settings-2-Cyizket8.js";import{S as W}from"./SheSelect-BQXq79sv.js";import{o as K,n as T,s as x,u as A,S as V,a as p}from"./types-jncQClrw.js";import{S as g}from"./SheInput-DOBGJMzP.js";import{S as R}from"./SheGrid-Bf16CGS9.js";import{I as D,u as oe}from"./useAppTranslation-DzTOekUh.js";import{I as q}from"./SheContextSidebar-wP16Oj66.js";import{T as H}from"./SheCardNotification-B85G_ouj.js";const te="_createCompanyCard_3cw4c_1",se="_createCompanyCardContent_3cw4c_1",ne="_createCompanyCardButtonBlock_3cw4c_6",w={createCompanyCard:te,createCompanyCardContent:se,createCompanyCardButtonBlock:ne},re="_createSupplierForm_1g0f1_1",le="_createSupplierFormItem_1g0f1_7",v={createSupplierForm:re,createSupplierFormItem:le},ie="field is required",ce=K({companyName:x().nonempty(ie).min(2,"min value length 2").max(16,"max value length 16"),nip:x().optional(),customerCareEmail:x().email().optional(),countryId:T().optional()}),de={id:void 0,title:void 0,description:void 0,isActive:void 0,image:void 0,companyId:void 0,appId:void 0,companyName:void 0,isDeleted:void 0,locationId:void 0,thumbnailUrl:void 0,address:void 0,isSelected:void 0,nip:void 0,customerCareEmail:void 0,photos:void 0,locations:void 0,countryId:void 0};function O({data:i,countryCodes:a,onChange:s}){const{form:o}=A({values:i,defaultValues:de,scheme:ce});function l(n,m){s==null||s({companyName:n.companyName||"",nip:n.nip||"",customerCareEmail:n.customerCareEmail||"",countryId:n.countryId||null},m)}return e.jsxs(V,{className:v.createSupplierForm,form:o,formPosition:X.CENTER,fullWidth:!0,hideFooter:!0,onChange:l,children:[e.jsx(p,{className:v.createSupplierFormItem,name:"companyName",render:({field:n})=>e.jsx(g,{value:n.value,minLength:2,maxLength:16,className:v.formItem,label:"Company Name",placeholder:"enter company name...",required:!0,fullWidth:!0})}),e.jsx(p,{className:v.createSupplierFormItem,name:"nip",render:({field:n})=>e.jsx(g,{value:n.value,className:v.formItem,label:"NIP",placeholder:"enter NIP...",fullWidth:!0})}),e.jsx(p,{className:v.createSupplierFormItem,name:"customerCareEmail",render:({field:n})=>e.jsx(g,{value:n.value,className:v.formItem,label:"Customer Care Email",placeholder:"enter customer car email...",fullWidth:!0})}),e.jsx(p,{className:v.createSupplierFormItem,name:"countryId",render:({field:n})=>e.jsx(W,{items:a,selected:n.value,label:"Products country of origin",placeholder:"Select country...",hideFirstOption:!0,fullWidth:!0})})]})}function He({isLoading:i,isPhotoUploaderLoading:a,countryCodes:s,onAction:o}){const[l,n]=b.useState(null),[m,u]=b.useState(null),[t,r]=b.useState(null),[d,j]=b.useState(null),y=b.useRef(null);function L(c,h){n(h),U()}function P(c,h){u(h),U()}function J(){var z,E;const c=((z=y.current)==null?void 0:z.getSelectedFiles())||[],h=((E=y.current)==null?void 0:E.getUploadModels())||[],k={company:l.getValues(),address:m.getValues(),image:{images:c,uploadModels:h}};r(k),o("createCompany",k)}function Q(){var c;return i&&(t!=null&&t.images)?t.images:((c=y.current)==null?void 0:c.getSelectedFiles())||[]}function U(){if(!l||!m){j(!1);return}j(l.formState.isValid&&m.formState.isValid)}return e.jsxs(F,{className:w.createCompanyCard,title:"Create Company",showCloseButton:!0,isLoading:i,onSecondaryButtonClick:()=>o("closeCreateCompanyCard"),children:[e.jsxs("div",{className:w.createCompanyCardContent,children:[e.jsx(O,{countryCodes:S(s,{text:"countryName",value:"countryId",icon:"flagIcon"}),onChange:L}),a?e.jsx("div",{children:Q().map((c,h)=>{const k=c instanceof File?URL.createObjectURL(c):c.result||c.path;return e.jsx("div",{className:"overflow-hidden rounded-md bg-secondary p-0 shadow-sm",children:e.jsxs("div",{className:" flex relative items-center justify-between p-2 pl-4",children:[e.jsx("div",{children:e.jsx("img",{src:k,alt:`uploading-${c.name||`image-${h}`}`,onLoad:()=>{c instanceof File&&URL.revokeObjectURL(k)}})}),e.jsxs("div",{children:[e.jsx("p",{className:"truncate text-sm",children:c.name||`Image ${h+1}`}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((c.size||0)/(1024*1024)).toFixed(2)," MB"]})]}),e.jsx(Y,{})]})},c.name||h)})}):e.jsx($,{isLoading:a,ref:y,contextName:"company",contextId:void 0,fullWidth:!0,hideUploadButton:!0}),e.jsx(ae,{countryList:S(s,{text:"countryName",value:"countryId"}),isCreate:!0,showFooter:!1,onChange:P,onSubmit:c=>o("createCompany",c),onCancel:()=>o("closeCreateCompanyCard")})]}),e.jsxs("div",{className:w.createCompanyCardButtonBlock,children:[e.jsx(f,{value:"Cancel",variant:"secondary",onClick:()=>o("closeCreateCompanyCard")}),e.jsx(f,{icon:G,value:"Create Company",variant:"info",disabled:!d,onClick:J})]})]})}const me="_companyConfigurationCard_1d57p_1",ue="_companyConfigurationCardContent_1d57p_1",pe="_imagesBlock_1d57p_6",he="_imagesBlockTitle_1d57p_11",Ce="_imagesBlockGrid_1d57p_16",xe="_imagesBlockGridItem_1d57p_21",ge="_locationsBlock_1d57p_36",ye="_locationsBlockTitle_1d57p_41",C={companyConfigurationCard:me,companyConfigurationCardContent:ue,imagesBlock:pe,imagesBlockTitle:he,imagesBlockGrid:Ce,imagesBlockGridItem:xe,locationsBlock:ge,locationsBlockTitle:ye};function ve({onAction:i}){return[{id:"name",header:"Locations",cell:({row:a})=>{var u,t;const s=(t=(u=a.original.photos)==null?void 0:u[0])==null?void 0:t.thumbnailUrl,o=a.original.name,l=a.original.addressLine1,n=a.original.addressLine2,m=a.original.countryName;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginLeft:"-8px"},children:[e.jsx("div",{children:s?e.jsx("img",{src:s,alt:o||"Supplier",className:"object-cover rounded-md w-full h-full",style:{minWidth:"48px",height:"48px"}}):e.jsx("div",{style:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(M,{icon:D,maxWidth:"30px"})})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx(B,{delayDuration:200,text:o,className:"max-w-[190px] overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"she-text",children:o})}),l&&e.jsx(B,{delayDuration:200,text:l,className:"max-w-[190px] overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"she-subtext",children:l})}),n&&e.jsx(B,{delayDuration:200,text:n,className:"max-w-[190px] overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"she-subtext",children:n})}),m&&e.jsx(B,{delayDuration:200,text:m,className:"max-w-[190px] overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx("span",{className:"she-subtext",children:m})})]})]})}},{id:"manage",header:"Actions",minSize:120,maxSize:120,cell:({row:a,table:s})=>{const o=s.options.meta,l=n=>{n.stopPropagation(),n.preventDefault(),i("openLocationConfigurationCard",a.original)};return e.jsx("div",{onClick:n=>n.stopPropagation(),children:e.jsx(f,{icon:Z,value:"Manage",variant:"secondary",onClick:l,disabled:o==null?void 0:o.isRowLoading(a.id)})})}}]}function Oe({isLoading:i,isGridLoading:a,countryCodes:s,company:o,onAction:l}){const n=Array.from({length:6},(t,r)=>{var d;return((d=o==null?void 0:o.photos)==null?void 0:d[r])||null});function m(t){const r=u(t),d=u(o);ee.isEqual(r,d)||l("updateCompany",t)}function u(t){return{companyName:(t==null?void 0:t.companyName)||"",countryId:(t==null?void 0:t.countryId)??null,customerCareEmail:(t==null?void 0:t.customerCareEmail)||null,nip:(t==null?void 0:t.nip)||null}}return e.jsx(F,{className:C.companyConfigurationCard,title:"Manage Company",showNotificationCard:!0,notificationCardProps:{title:"Delete Company",text:"The company will be deleted and it will no longer be available. The past purchases and labels will remain available.",onClick:()=>l("deleteCompany",o)},showCloseButton:!0,isLoading:i,onSecondaryButtonClick:()=>l("closeCompanyConfigurationCard"),children:e.jsxs("div",{className:C.companyConfigurationCardContent,children:[e.jsx(O,{data:o,countryCodes:S(s,{text:"countryName",value:"countryId",icon:"flagIcon"}),onChange:m}),e.jsxs("div",{className:C.imagesBlock,children:[e.jsxs("div",{className:C.imagesBlockTitle,children:[e.jsx("span",{className:"she-title",children:"Company Photos"}),e.jsx(f,{icon:q,variant:"secondary",value:"Manage Photos",onClick:()=>l("manageCompanyPhotos")})]}),e.jsx("div",{className:C.imagesBlock,children:e.jsx("div",{className:C.imagesBlockGrid,children:n.map((t,r)=>e.jsx("div",{className:C.imagesBlockGridItem,children:t?e.jsx("img",{src:t==null?void 0:t.thumbnailUrl,alt:`image-${r}`,className:"object-cover w-full h-full"}):e.jsx("div",{})},r))})}),e.jsxs("div",{className:C.locationsBlock,children:[e.jsxs("div",{className:C.locationsBlockTitle,children:[e.jsx("span",{className:"she-title",children:"Locations"}),e.jsx(f,{icon:G,variant:"secondary",value:"Add Location",onClick:()=>l("openLocationConfigurationCard")})]}),e.jsx("div",{children:e.jsx(R,{isLoading:a,showHeader:!1,columns:ve({onAction:l}),data:o==null?void 0:o.locations,customMessage:"No locations to display"})})]})]})]})})}const fe={},je="_locationForm_li62b_1",Ne="_locationFormImageBlock_li62b_8",_e="_imageBlockTitle_li62b_14",ke="_imagesBlockGrid_li62b_19",be="_imagesBlockGridItem_li62b_24",Ie="_image_li62b_14",Be="_cardFooter_li62b_59",N={locationForm:je,locationFormImageBlock:Ne,imageBlockTitle:_e,imagesBlockGrid:ke,imagesBlockGridItem:be,image:Ie,cardFooter:Be},I="field is required",Se=K({addressId:T().optional(),locationName:x().nonempty(I).min(2,"Min value length 2").max(50,"Max value length 50"),addressLine1:x().nonempty(I).min(5,"Min value length 5").max(100,"Max value length 100"),addressLine2:x().max(100,"Max value length 100").optional(),city:x().nonempty(I).min(2,"Min value length 2").max(50,"Max value length 50"),state:x().nonempty(I).min(2,"Min value length 2").max(50,"Max value length 50"),postCode:x().nonempty(I).min(3,"Min value length 3").max(10,"Max value length 10"),countryId:T().min(1,"Country is required")}),Fe={addressLine1:void 0,addressLine2:void 0,city:void 0,state:void 0,postCode:void 0,countryId:void 0,countryName:void 0,lat:void 0,locationId:void 0,locationName:void 0,long:void 0,address:void 0};function Le({isLoading:i,data:a,countryCodes:s,onChange:o,onSubmit:l,onCancel:n,onAction:m}){const{form:u}=A({values:a,defaultValues:Fe,scheme:Se}),t=Array.from({length:6},(r,d)=>{var j;return((j=a==null?void 0:a.photos)==null?void 0:j[d])||null});return e.jsxs(V,{isLoading:i,className:N.locationForm,form:u,hidePrimaryBtn:!!(a!=null&&a.locationId),hideSecondaryBtn:!!(a!=null&&a.locationId),footerClassName:N.cardFooter,primaryBtnTitle:"Create Location",primaryBtnProps:{icon:G,variant:"info"},onChange:o,onSubmit:l,onCancel:n,children:[e.jsx(p,{name:"locationName",render:({field:r})=>e.jsx(g,{value:r.value,label:"Location Name",placeholder:"enter location name...",fullWidth:!0})}),e.jsxs("div",{className:N.locationFormImageBlock,children:[e.jsxs("div",{className:N.imageBlockTitle,children:[e.jsx("span",{className:"she-title",children:"Location Photos"}),e.jsx(f,{value:"Manage Photos",icon:q,variant:"secondary",onClick:()=>m("manageLocationPhotos")})]}),e.jsx("div",{className:N.imagesBlockGrid,children:t.map((r,d)=>e.jsx("div",{className:N.imagesBlockGridItem,children:r?e.jsx("img",{src:r.thumbnailUrl,alt:`image-${d}`,className:N.image}):e.jsx("div",{})},d))})]}),e.jsx(p,{name:"addressLine1",render:({field:r})=>e.jsx(g,{value:r.value,label:"Address Line 1",labelTransKey:"AddressForm.Labels.AddressLine1",placeholder:"Enter address line 1...",placeholderTransKey:"AddressForm.Placeholders.AddressLine1",fullWidth:!0})}),e.jsx(p,{name:"addressLine2",render:({field:r})=>e.jsx(g,{value:r.value,label:"Address Line 2",labelTransKey:"AddressForm.Labels.AddressLine2",placeholder:"Enter address line 2...",placeholderTransKey:"AddressForm.Placeholders.AddressLine2",fullWidth:!0})}),e.jsx(p,{name:"city",render:({field:r})=>e.jsx(g,{value:r.value,label:"City",labelTransKey:"AddressForm.Labels.City",placeholder:"Enter city...",placeholderTransKey:"AddressForm.Placeholders.City",fullWidth:!0})}),e.jsx(p,{name:"state",render:({field:r})=>e.jsx(g,{value:r.value,label:"State",labelTransKey:"AddressForm.Labels.State",placeholder:"Enter state...",placeholderTransKey:"AddressForm.Placeholders.State",fullWidth:!0})}),e.jsx(p,{name:"postCode",render:({field:r})=>e.jsx(g,{value:r.value,label:"Postal Code",labelTransKey:"AddressForm.Labels.PostalCode",placeholder:"Enter postal code...",placeholderTransKey:"AddressForm.Placeholders.PostalCode",fullWidth:!0})}),e.jsx(p,{name:"countryId",render:({field:r})=>e.jsx(W,{selected:r.value,items:s,label:"Country",labelTransKey:"AddressForm.Labels.Country",placeholder:"Choose country...",placeholderTransKey:"AddressForm.Placeholders.Country",hideFirstOption:!0,fullWidth:!0})})]})}function Je({isLoading:i,countryCodes:a,location:s,onAction:o}){return e.jsx(F,{className:fe.locationConfigurationCard,title:s!=null&&s.locationId?"Manage Location":"Create Location",isLoading:i,showNotificationCard:!!(s!=null&&s.locationId),notificationCardProps:{title:"Delete Location",text:"The location will be deleted and will no longer appear on new labels. The current labels will require an update to replace deleted location.",onClick:()=>o("deleteLocation",s)},showCloseButton:!0,onHeaderCloseClick:()=>o("closeLocationConfigurationCard"),children:e.jsx(Le,{isLoading:i,data:s,countryCodes:S(a,{text:"countryName",value:"countryId",icon:"flagIcon"}),onChange:l=>o("updateLocation",l),onSubmit:l=>o("createLocation",l),onAction:o})})}const Pe="_photosCard_1f0z5_1",we="_photosCardContent_1f0z5_1",Te="_managePhotosBlock_1f0z5_6",_={photosCard:Pe,photosCardContent:we,managePhotosBlock:Te};function Qe({isLoading:i,isImageUploaderLoading:a,isGridLoading:s,data:o,contextId:l,contextName:n,columns:m,noDataText:u,skeletonQuantity:t,showCloseButton:r,onAction:d}){const{translate:j}=oe();return e.jsx(F,{className:_.photosCard,title:`${n} Photos`,isLoading:i,showCloseButton:r,onSecondaryButtonClick:()=>d("closePhotosCard",n),children:e.jsxs("div",{className:_.photosCardContent,children:[e.jsx($,{isLoading:a,contextName:n,contextId:l,onUpload:y=>d("uploadPhoto",y)}),e.jsxs("div",{className:_.managePhotosBlock,children:[e.jsx("div",{className:`${_.managePhotosTitle} she-title`,children:j("CardTitles.ManagePhotos")}),e.jsx("div",{className:_.managePhotosGrid,children:e.jsx(R,{isLoading:s,className:_.photosGrid,enableDnd:!0,showHeader:!1,columns:m,data:o,skeletonQuantity:t,customMessage:u,onNewItemPosition:(y,L,P)=>d("changePhotoPosition",{newIndex:y,activeItem:L,oldIndex:P,contextName:n}),onAction:d})})]})]})})}function Xe({onAction:i}){return[{accessorKey:"thumbnailUrl",header:"Preview",minSize:80,maxSize:80,cell:({row:a})=>{const s=a.getValue("thumbnailUrl");return e.jsx("div",{className:"relative w-12 h-12 cursor-pointer",onClick:()=>i("image",a),children:s?e.jsx("img",{src:s,alt:"Company",className:"object-cover rounded-md w-full h-full",style:{width:"48px",height:"48px"}}):e.jsx("div",{style:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(M,{icon:D,maxWidth:"30px"})})})}},{accessorKey:"format",header:"Format",minSize:190,cell:({row:a})=>e.jsx("span",{className:"she-subtext",children:`${a.original.height}px x ${a.original.width}px`})},{id:"rowActions",header:"Actions",minSize:80,maxSize:80,cell:({row:a})=>e.jsx(f,{icon:H,variant:"secondary",onClick:()=>i("deleteCompanyPhoto",a.original)})}]}function Ye({onAction:i}){return[{accessorKey:"thumbnailUrl",header:"Preview",minSize:80,maxSize:80,cell:({row:a})=>{const s=a.getValue("thumbnailUrl");return e.jsx("div",{className:"relative w-12 h-12 cursor-pointer",onClick:()=>i("image",a),children:s?e.jsx("img",{src:s,alt:"Company",className:"object-cover rounded-md w-full h-full",style:{width:"48px",height:"48px"}}):e.jsx("div",{style:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(M,{icon:D,maxWidth:"30px"})})})}},{accessorKey:"format",header:"Format",minSize:190,cell:({row:a})=>e.jsx("span",{className:"she-subtext",children:`${a.original.height}px x ${a.original.width}px`})},{id:"rowActions",header:"Actions",minSize:80,maxSize:80,cell:({row:a})=>e.jsx(f,{icon:H,variant:"secondary",onClick:()=>i("deleteLocationPhoto",a.original)})}]}export{He as C,Je as L,Xe as M,Qe as P,Oe as a,Ye as b};
